---
title: "arun_simulations"
description: "Async implementation for running multiple AI agent simulations with full control over execution"
---

## arun_simulations

Async implementation for running multiple AI agent simulations. Provides the same functionality as `run_simulations()` but runs asynchronously for better performance in async applications.

### Function Signature

```python
async def arun_simulations(
    *,
    target_agent: Callable[[], Callable[[str], Awaitable[str] | str]],
    api_key: str,
    num_simulations: int = 10,
    max_turns: int = 10,
    base_url: Optional[str] = None,
    context: Optional[str] = None,
    goal: Optional[str] = None,
    rules: Optional[Sequence[str]] = None,
    persona_kwargs: Optional[Dict[str, str]] = None,
) -> List[dict]
```



### Basic Usage

```python
import asyncio
import janus_sdk as janus

class MyAgent:
    async def chat(self, prompt: str) -> str:
        # Your agent logic here
        return "Hello! I'm your AI assistant."

async def main():
    results = await janus.arun_simulations(
        num_simulations=10,
        max_turns=5,
        target_agent=lambda: MyAgent().chat,
        api_key="your_janus_api_key"  # Contact team@withjanus.com to get your API key
    )
    
    print(f"Completed {len(results)} simulations")

asyncio.run(main())
```

### Advanced Usage with Rules

```python
# Define evaluation rules
rules = [
    "The agent should be helpful and informative",
    "The agent should not provide medical advice",
    "The agent should stay within the conversation context"
]

results = await janus.arun_simulations(
    num_simulations=20,
    max_turns=8,
    target_agent=lambda: MyAgent().chat,
    api_key="your_janus_api_key",  # Contact team@withjanus.com to get your API key
    context="You are a customer service representative testing a new AI assistant.",
    goal="Test the AI assistant's ability to handle customer inquiries professionally.",
    rules=rules
)
```

### Performance Benefits

<Tip>
- Runs simulations concurrently for faster execution
- Automatically manages concurrency with configurable limits
- Built-in progress tracking for long-running simulations
- Memory efficient with batch processing
</Tip>

### Error Handling

The function handles various error scenarios:

<AccordionGroup>
<Accordion title="Network Errors">
  If the Janus API is unavailable, simulations will fail gracefully with error details in the response.
</Accordion>

<Accordion title="Agent Errors">
  If your agent throws an exception, the simulation will be marked as failed with error information.
</Accordion>

<Accordion title="Timeout Errors">
  If simulations take too long, they will be automatically terminated and marked as timeout.
</Accordion>
</AccordionGroup>

### When to Use

<CardGroup cols={2}>
<Card title="Use arun_simulations when:" icon="check">
  - You're already in an async context
  - You need maximum performance
  - You want full control over execution
  - You're building async applications
</Card>

<Card title="Use run_simulations when:" icon="play">
  - You're in a sync context
  - You want simpler API
  - You don't need async performance
  - You're building sync applications
</Card>
</CardGroup>

### Related Functions

<CardGroup cols={2}>
<Card title="run_simulations" icon="play" href="/api-reference/run-simulations">
  Synchronous wrapper for this async function
</Card>

<Card title="track decorator" icon="route" href="/api-reference/track-decorator">
  Automatically trace function calls in your agent
</Card>
</CardGroup>
