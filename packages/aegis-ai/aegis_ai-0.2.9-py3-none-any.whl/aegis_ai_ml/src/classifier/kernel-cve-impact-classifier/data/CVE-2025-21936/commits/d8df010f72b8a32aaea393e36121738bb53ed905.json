{
  "commit_hash": "d8df010f72b8a32aaea393e36121738bb53ed905",
  "commit_url": "https://git.kernel.org/stable/c/d8df010f72b8a32aaea393e36121738bb53ed905",
  "commit_details": "commit d8df010f72b8a32aaea393e36121738bb53ed905\nAuthor:     Haoxiang Li <haoxiang_li2024@163.com>\nAuthorDate: Fri Feb 21 16:58:01 2025 +0800\nCommit:     Luiz Augusto von Dentz <luiz.von.dentz@intel.com>\nCommitDate: Thu Feb 27 16:50:30 2025 -0500\n\n    Bluetooth: Add check for mgmt_alloc_skb() in mgmt_device_connected()\n    \n    Add check for the return value of mgmt_alloc_skb() in\n    mgmt_device_connected() to prevent null pointer dereference.\n    \n    Fixes: e96741437ef0 (\"Bluetooth: mgmt: Make use of mgmt_send_event_skb in MGMT_EV_DEVICE_CONNECTED\")\n    Cc: stable@vger.kernel.org\n    Signed-off-by: Haoxiang Li <haoxiang_li2024@163.com>\n    Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>\n",
  "patch_content": "commit d8df010f72b8a32aaea393e36121738bb53ed905\nAuthor: Haoxiang Li <haoxiang_li2024@163.com>\nDate:   Fri Feb 21 16:58:01 2025 +0800\n\n    Bluetooth: Add check for mgmt_alloc_skb() in mgmt_device_connected()\n    \n    Add check for the return value of mgmt_alloc_skb() in\n    mgmt_device_connected() to prevent null pointer dereference.\n    \n    Fixes: e96741437ef0 (\"Bluetooth: mgmt: Make use of mgmt_send_event_skb in MGMT_EV_DEVICE_CONNECTED\")\n    Cc: stable@vger.kernel.org\n    Signed-off-by: Haoxiang Li <haoxiang_li2024@163.com>\n    Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>\n\ndiff --git a/net/bluetooth/mgmt.c b/net/bluetooth/mgmt.c\nindex 3e0f88cd975c..621c555f639b 100644\n--- a/net/bluetooth/mgmt.c\n+++ b/net/bluetooth/mgmt.c\n@@ -9660,6 +9660,9 @@ void mgmt_device_connected(struct hci_dev *hdev, struct hci_conn *conn,\n \t\t\t\t     sizeof(*ev) + (name ? eir_precalc_len(name_len) : 0) +\n \t\t\t\t     eir_precalc_len(sizeof(conn->dev_class)));\n \n+\tif (!skb)\n+\t\treturn;\n+\n \tev = skb_put(skb, sizeof(*ev));\n \tbacpy(&ev->addr.bdaddr, &conn->dst);\n \tev->addr.type = link_to_bdaddr(conn->type, conn->dst_type);\n",
  "changed_files": [
    "net/bluetooth/mgmt.c"
  ],
  "diff_stats": " net/bluetooth/mgmt.c | 3 +++\n 1 file changed, 3 insertions(+)\n"
}