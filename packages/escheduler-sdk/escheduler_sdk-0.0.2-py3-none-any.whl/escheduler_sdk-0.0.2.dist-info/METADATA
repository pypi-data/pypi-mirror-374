Metadata-Version: 2.4
Name: escheduler-sdk
Version: 0.0.2
Summary: Python SDK for EScheduler API
Author-email: EScheduler Team <gangtingfan0207@gmail.com>
Project-URL: Homepage, https://github.com/fan9704/EScheduler-Python-SDK
Project-URL: Repository, https://github.com/fan9704/EScheduler-Python-SDK
Project-URL: Documentation, https://github.com/fan9704/EScheduler-Python-SDK
Project-URL: Bug Tracker, https://github.com/fan9704/EScheduler-Python-SDK/issues
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: httpx>=0.24.0
Requires-Dist: pydantic>=2.0.0
Requires-Dist: pytest>=8.4.2
Requires-Dist: python-dateutil>=2.8.0
Requires-Dist: typing-extensions>=4.0.0
Provides-Extra: dev
Requires-Dist: build>=1.3.0; extra == "dev"
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: isort>=5.12.0; extra == "dev"
Requires-Dist: flake8>=6.0.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Requires-Dist: pre-commit>=4.3.0; extra == "dev"
Requires-Dist: twine>=6.2.0; extra == "dev"
Dynamic: license-file

# EScheduler Python SDK

ä¸€å€‹ç”¨æ–¼èˆ‡ EScheduler API äº’å‹•çš„ Python SDKï¼Œæä¾›ç°¡æ½”æ˜“ç”¨çš„ä»‹é¢ä¾†ç®¡ç†æ’ç¨‹ä»»å‹™å’Œåœ˜éšŠèªè­‰ã€‚

## ç‰¹æ€§

- ğŸš€ **ç°¡æ½”çš„ API**: æä¾›ç›´è§€æ˜“ç”¨çš„æ–¹æ³•ä¾†æ“ä½œæ’ç¨‹ä»»å‹™
- ğŸ” **å®Œæ•´çš„èªè­‰æ”¯æŒ**: æ”¯æ´åœ˜éšŠ token å’Œ JWT èªè­‰
- ğŸ“ **é¡å‹æç¤º**: å®Œæ•´çš„ TypeScript é¢¨æ ¼é¡å‹æç¤º
- ğŸ›¡ï¸ **éŒ¯èª¤è™•ç†**: è©³ç´°çš„ç•°å¸¸é¡å‹å’ŒéŒ¯èª¤ä¿¡æ¯
- âš¡ **ç•°æ­¥æ”¯æŒ**: åŸºæ–¼ asyncio çš„ç•°æ­¥ API
- ğŸ”„ **è‡ªå‹•é‡è©¦**: å…§å»ºè«‹æ±‚é‡è©¦æ©Ÿåˆ¶
- ğŸ“Š **çµ±è¨ˆä¿¡æ¯**: æ”¯æ´ç²å–æ’ç¨‹å™¨çµ±è¨ˆæ•¸æ“š

## å®‰è£

### å¾æºç¢¼å®‰è£

```bash
git clone https://github.com/escheduler/escheduler-python-sdk.git
cd escheduler-python-sdk
pip install -e .
```

### é–‹ç™¼ç’°å¢ƒå®‰è£

```bash
uv sync # å®‰è£ä¾è³´
pip install -e ".[dev]"
uv run python -m build # å»ºç«‹ç™¼è¡ŒåŒ…
twine upload --repository escheduler_sdk dist/*
```

## å¿«é€Ÿé–‹å§‹

### åŸºæœ¬ä½¿ç”¨

```python
import asyncio
from escheduler_sdk import ESchedulerSDK, ScheduledTaskCreate, TargetType

async def main():
    async with ESchedulerSDK(base_url="http://localhost:8000") as sdk:
        # åœ˜éšŠèªè­‰
        await sdk.authenticate("ABCD")  # ä½ çš„åœ˜éšŠ token
        
        # å‰µå»ºæ’ç¨‹ä»»å‹™
        task_data = ScheduledTaskCreate(
            name="æˆ‘çš„ä»»å‹™",
            description="æ¯5åˆ†é˜åŸ·è¡Œä¸€æ¬¡çš„æ¸¬è©¦ä»»å‹™",
            schedule_expression="rate(5 minutes)",
            target_type=TargetType.HTTP,
            target_arn="https://httpbin.org/post",
            target_input={"message": "Hello World!"}
        )
        
        task = await sdk.scheduler.create_task(task_data)
        print(f"ä»»å‹™å‰µå»ºæˆåŠŸï¼ŒID: {task.id}")
        
        # ç²å–æ‰€æœ‰ä»»å‹™
        tasks = await sdk.scheduler.get_all_tasks()
        print(f"å…±æœ‰ {len(tasks)} å€‹ä»»å‹™")

asyncio.run(main())
```

### åœ˜éšŠèªè­‰

```python
import asyncio
from escheduler_sdk import ESchedulerSDK

async def auth_example():
    async with ESchedulerSDK(base_url="http://localhost:8000") as sdk:
        # æ–¹æ³• 1: ä½¿ç”¨ä¾¿åˆ©æ–¹æ³•
        success = await sdk.authenticate("ABCD")
        if success:
            print("èªè­‰æˆåŠŸ")
        
        # æ–¹æ³• 2: ç²å–è©³ç´°èªè­‰ä¿¡æ¯
        auth_response = await sdk.team.auth_and_set_token("ABCD")
        if auth_response.status:
            print(f"åœ˜éšŠ: {auth_response.team.name}")
            print(f"JWT Token: {auth_response.access_token}")

asyncio.run(auth_example())
```

## API åƒè€ƒ

### ESchedulerSDK

ä¸»è¦çš„ SDK é¡ï¼Œæä¾›çµ±ä¸€çš„ API ä»‹é¢ã€‚

```python
sdk = ESchedulerSDK(
    base_url="http://localhost:8000",
    timeout=30.0,
    max_retries=3
)
```

#### åƒæ•¸

- `base_url` (str): EScheduler API çš„åŸºç¤ URL
- `token` (str, optional): åœ˜éšŠèªè­‰ token
- `jwt_token` (str, optional): JWT èªè­‰ token
- `timeout` (float): è«‹æ±‚è¶…æ™‚æ™‚é–“ï¼Œé è¨­ 30 ç§’
- `max_retries` (int): æœ€å¤§é‡è©¦æ¬¡æ•¸ï¼Œé è¨­ 3 æ¬¡

#### æ–¹æ³•

- `authenticate(token: str) -> bool`: ä½¿ç”¨åœ˜éšŠ token é€²è¡Œèªè­‰
- `is_authenticated() -> bool`: æª¢æŸ¥æ˜¯å¦å·²èªè­‰
- `logout()`: ç™»å‡ºä¸¦æ¸…é™¤èªè­‰ä¿¡æ¯

### æ’ç¨‹ä»»å‹™ API (sdk.scheduler)

#### ä»»å‹™ç®¡ç†

```python
# å‰µå»ºä»»å‹™
task = await sdk.scheduler.create_task(task_data)

# ç²å–æ‰€æœ‰ä»»å‹™
tasks = await sdk.scheduler.get_all_tasks(state=TaskState.ENABLED)

# ç²å–å–®å€‹ä»»å‹™
task = await sdk.scheduler.get_task(task_id)

# æ›´æ–°ä»»å‹™
task = await sdk.scheduler.update_task(task_id, update_data)

# åˆªé™¤ä»»å‹™
result = await sdk.scheduler.delete_task(task_id)
```

#### ä»»å‹™ç‹€æ…‹ç®¡ç†

```python
# å•Ÿç”¨ä»»å‹™
task = await sdk.scheduler.enable_task(task_id)

# ç¦ç”¨ä»»å‹™
task = await sdk.scheduler.disable_task(task_id)

# æš«åœä»»å‹™
task = await sdk.scheduler.pause_task(task_id)

# æ‰‹å‹•è§¸ç™¼ä»»å‹™
result = await sdk.scheduler.trigger_task(task_id)
```

#### å…¶ä»–åŠŸèƒ½

```python
# æœç´¢ä»»å‹™
tasks = await sdk.scheduler.search_tasks("é—œéµå­—")

# ç²å–çµ±è¨ˆä¿¡æ¯
stats = await sdk.scheduler.get_scheduler_stats()
```

### åœ˜éšŠ API (sdk.team)

```python
# ç²å–æ‰€æœ‰åœ˜éšŠ
teams = await sdk.team.get_all_teams()

# é€é token ç²å–åœ˜éšŠ
team = await sdk.team.get_team_by_token("ABCD")

# åœ˜éšŠèªè­‰
auth_response = await sdk.team.auth_team("ABCD")

# èªè­‰ä¸¦è‡ªå‹•è¨­ç½® token
auth_response = await sdk.team.auth_and_set_token("ABCD")
```

## æ•¸æ“šæ¨¡å‹

### æ’ç¨‹ä»»å‹™

```python
from escheduler_sdk import ScheduledTaskCreate, TargetType

task_data = ScheduledTaskCreate(
    name="ä»»å‹™åç¨±",
    description="ä»»å‹™æè¿°",
    schedule_expression="rate(5 minutes)",  # æˆ– "cron(0 */5 * * * *)"
    timezone="Asia/Taipei",
    target_type=TargetType.HTTP,
    target_arn="https://example.com/webhook",
    target_input={"key": "value"},
    max_retry_attempts=3
)
```

### æ’ç¨‹è¡¨é”å¼

æ”¯æ´å…©ç¨®æ ¼å¼ï¼š

1. **Rate è¡¨é”å¼**: `rate(value unit)`
   - `rate(5 minutes)` - æ¯5åˆ†é˜
   - `rate(1 hour)` - æ¯å°æ™‚
   - `rate(1 day)` - æ¯å¤©

2. **Cron è¡¨é”å¼**: `cron(minute hour day month day-of-week year)`
   - `cron(0 12 * * ? *)` - æ¯å¤©ä¸­åˆ12é»
   - `cron(0 */2 * * ? *)` - æ¯2å°æ™‚
   - `cron(0 9 ? * MON-FRI *)` - å·¥ä½œæ—¥ä¸Šåˆ9é»

### ç›®æ¨™é¡å‹

```python
from escheduler_sdk import TargetType

# æ”¯æ´çš„ç›®æ¨™é¡å‹
TargetType.HTTP      # HTTP è«‹æ±‚
TargetType.WEBHOOK   # Webhook
TargetType.RABBITMQ  # RabbitMQ æ¶ˆæ¯
TargetType.EMAIL     # é›»å­éƒµä»¶
```

### ä»»å‹™ç‹€æ…‹

```python
from escheduler_sdk import TaskState

TaskState.ENABLED   # å•Ÿç”¨
TaskState.DISABLED  # ç¦ç”¨
TaskState.PAUSED    # æš«åœ
```

## éŒ¯èª¤è™•ç†

SDK æä¾›äº†è©³ç´°çš„ç•°å¸¸é¡å‹ï¼š

```python
from escheduler_sdk import (
    ESchedulerError,
    AuthenticationError,
    ValidationError,
    NotFoundError,
    ServerError,
    RateLimitError,
    TimeoutError,
    NetworkError
)

try:
    await sdk.scheduler.get_task(999)
except NotFoundError as e:
    print(f"ä»»å‹™ä¸å­˜åœ¨: {e}")
except AuthenticationError as e:
    print(f"èªè­‰å¤±æ•—: {e}")
except ESchedulerError as e:
    print(f"API éŒ¯èª¤: {e}")
    print(f"ç‹€æ…‹ç¢¼: {e.status_code}")
    print(f"å›æ‡‰æ•¸æ“š: {e.response_data}")
```

## ç¯„ä¾‹

æŸ¥çœ‹ `examples/` ç›®éŒ„ä¸­çš„å®Œæ•´ç¯„ä¾‹ï¼š

- `basic_usage.py` - åŸºæœ¬ä½¿ç”¨ç¯„ä¾‹
- `team_auth_example.py` - åœ˜éšŠèªè­‰ç¯„ä¾‹

## é–‹ç™¼

### å®‰è£é–‹ç™¼ä¾è³´

```bash
pip install -e ".[dev]"
```

### é‹è¡Œæ¸¬è©¦

```bash
pytest
```

### ä»£ç¢¼æ ¼å¼åŒ–

```bash
black src/
isort src/
```

### é¡å‹æª¢æŸ¥

```bash
mypy src/
```

## æˆæ¬Š

MIT License

## è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

## æ›´æ–°æ—¥èªŒ

### v0.1.0

- åˆå§‹ç‰ˆæœ¬
- æ”¯æ´æ’ç¨‹ä»»å‹™ CRUD æ“ä½œ
- æ”¯æ´åœ˜éšŠèªè­‰
- å®Œæ•´çš„éŒ¯èª¤è™•ç†
- ç•°æ­¥ API æ”¯æ´
