[project]
name = "unico_device_setuper"
version = "1.16.10"
description = ""
readme = "README.md"
authors = [{ name = "Florian Daude", email = "florian.daude@unicofrance.com" }]
requires-python = ">=3.12,<3.13"
dependencies = [
    "httpx>=0.27.0",
    "slcfg>=0.3.1",
    "pydantic>=2.7.1",
    "tqdm>=4.66.4",
    "platformdirs>=4.2.1",
    "typer>=0.12.3",
    "attrs>=23.2.0",
    "python-slugify>=8.0.4",
    "keyring>=24.0.0",
    "fastapi>=0.111.0",
    "oci-client>=0.2.5",
    "python-jose>=3.3.0",
    "uvicorn>=0.29.0",
    "gunicorn>=22.0.0",
    "beautifulsoup4>=4.12.3",
    "openpyxl>=3.1.3",
    "cyclopts>=2.9.9",
    "email-validator>=2.2.0",
]

[dependency-groups]
dev = ["ruff>=0.7", "pyright[nodejs]==v1.1.401", "watchfiles>=1.0.5"]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[project.scripts]
device-setup = "unico_device_setuper.cli.main:APP"
device-setuper-backend = "unico_device_setuper.backend.app:local_app"
unico-scripts = "unico_device_setuper.scripts.main:APP"


[tool.pyright]
include = ["src/", 'tools/']
exclude = [
    "src/unico_device_setuper/lib/unitech",
    "src/unico_device_setuper/lib/api",
]

typeCheckingMode = "strict"
venvPath = "."
venv = ".venv"
stubPath = "stubs/"

[tool.ruff]
target-version = "py312"
line-length = 100
include = ['src/*.py', 'tools/*.py']
namespace-packages = ["tools/"]
exclude = [
    "src/unico_device_setuper/lib/unitech",
    "src/unico_device_setuper/lib/api",
]

[tool.ruff.format]
exclude = []
indent-style = "space"
line-ending = "lf"
quote-style = "single"
skip-magic-trailing-comma = true

[tool.ruff.lint]
flake8-pytest-style = { fixture-parentheses = false }
flake8-quotes = { inline-quotes = "single" }
isort = { split-on-trailing-comma = false }
select = ["ALL"]
ignore = [
    "D203", # one-blank-line-before-clas
    # "D211", # no-blank-line-before-class

    "D212", # multi-line-summary-first-line
    # "D213", # multi-line-summary-second-line

    # "S602", # subprocess-popen-with-shell-equals-true
    "S603", # subprocess-without-shell-equals-true 

    # https://docs.astral.sh/ruff/formatter/#conflicting-lint-rules
    "W191",   # tab-indentation
    "E111",   # indentation-with-invalid-multiple
    "E114",   # indentation-with-invalid-multiple-comment
    "E117",   # over-indented
    "D206",   # indent-with-spaces
    "D300",   # triple-single-quotes
    "Q000",   # bad-quotes-inline-string
    "Q001",   # bad-quotes-multiline-string
    "Q002",   # bad-quotes-docstring
    "Q003",   # avoidable-escaped-quote
    "COM812", # missing-trailing-comma
    "COM819", # prohibited-trailing-comma
    "ISC001", # single-line-implicit-string-concatenation
    "ISC002", # multi-line-implicit-string-concatenation

    "D100", # missing docstring in module
    "D101", # missing docstring in class
    "D102", # missing docstring in method
    "D103", # missing docstring in function
    "D104", # missing docstring in package
    "D105", # missing docstring in method
    "D106", # missing docstring in nested class
    "D107", # missing docstring in __init__

    "ANN201", # missing return type annotation public function
    "ANN202", # missing return type annotation private function
    "ANN204", # missing return type annotation method
    "ANN205", # missing return type annotation static method
    "ANN206", # missing return type annotation class method

    "T201",     # print
    "UP040",    # non-pep695-type-alias
    "PLR0913",  # too-many-arguments
    "TRY301",   # raise-within-try
    "A002",     # builtin-argument-shadowing
    "TRY003",   # raise-vanilla-args
    "EM102",    # f-string-in-exception
    "EM101",    # raw-string-in-exception
    "PLR2004",  # magic-value-comparison
    "PERF401",  # manual-list-comprehension
    "S101",     # assert
    "S324",     # hashlib-insecure-hash-function
    "PD011",    # pandas-use-of-dot-values
    "A001",     # builtin-variable-shadowing
    "S311",     # suspicious-non-cryptographic-random-usage (S311)
    'UP007',    # non-pep604-annotation-union
    'ASYNC109', # async-function-with-timeout 
]


[tool.ruff.lint.per-file-ignores]
"tools/*" = ["T201"]
"test.py" = ["T201"]
"unico_device_setuper/cli/main.py" = ["UP007"]
"unico_device_setuper/scripts/main.py" = ["UP007"]
