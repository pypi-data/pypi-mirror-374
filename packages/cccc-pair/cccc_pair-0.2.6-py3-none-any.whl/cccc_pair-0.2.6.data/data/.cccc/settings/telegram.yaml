# Telegram Bridge Settings (MVP)

token_env: "TELEGRAM_BOT_TOKEN"   # Bot token from env var; do not hardcode
autostart: true                    # Autostart bridge when running cccc.py in non-interactive mode
allow_chats: []                    # List of allowed chat_id (integers); empty = deny all
discover_allowlist: true           # If true and allow_chats empty, run to log incoming chat_id for onboarding
autoregister: open                 # open | off — open allows /subscribe to add current chat automatically
max_auto_subs: 3                   # Max chats that can auto-subscribe when autoregister=open
dry_run: false                      # If true, do not connect network; use file-based mock

# Inbound routing (when a message arrives)
default_route: "both"              # both | a | b
prefix_routes: true                # allow a:/b:/both: at message start to override

# Outbound
debounce_seconds: 30               # Combine multiple events into one summary
max_msg_chars: 4096                 # Truncate messages (IM safe defaults)
max_msg_lines: 32                   # Keep at most this many lines (preserve newlines)
include_patch_snippets: false      # Never send large diffs; point to repo paths instead
show_peer_messages: true          # Also forward PeerA↔PeerB to_peer.md summaries to Telegram
peer_message_max_chars: 2048        # Max chars for peer-to-peer message previews
peer_message_max_lines: 16          # Max lines for peer-to-peer previews
peer_debounce_seconds: 30          # Debounce for peer-to-peer summaries

# Routing policy
routing:
  require_explicit: true           # Group chats must include explicit route; otherwise drop with hint
  allow_prefix: true               # Accept a:/b:/both: syntax when privacy mode allows
  require_mention: false           # If true, must @BotName in group for messages to be accepted
dm:
  route_default: both              # In DM when no route, default route (still recommend explicit)
hints:
  cooldown_seconds: 300            # Drop/hint messages at most once per user per chat within cooldown

# File exchange (P0/P1)
files:
  enabled: true
  max_mb: 16
  allowed_mime: ["text/*","image/png","image/jpeg","application/pdf","application/zip"]
  inbound_dir: ".cccc/work/upload/inbound"
  outbound_dir: ".cccc/work/upload/outbound"
  inbound_retention_days: 14
  outbound_retention_days: 14
  strip_exif: true
  route_default: both
  autowrap_from_user: true
  run_clamav: false

# Redaction & safety
redact_patterns:
  - "(?i)api[_-]?key\s*[:=]\s*\S+"
  - "(?i)secret\s*[:=]\s*\S+"
  - "(?i)password\s*[:=]\s*\S+"

# Mock files used in dry_run mode
mock:
  inbox_dir: ".cccc/work/telegram_inbox"     # files dropped here become inbound messages
  outbox_log: ".cccc/state/bridge-telegram.log"

# Outbound watcher options
outbound:
  reset_on_start: baseline   # baseline | archive | clear
  watch_to_user_peers: ["peerA"]
