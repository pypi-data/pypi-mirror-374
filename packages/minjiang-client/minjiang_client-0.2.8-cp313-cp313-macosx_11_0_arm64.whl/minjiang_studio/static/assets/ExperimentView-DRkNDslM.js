import{d as A,c as V,e as f,f as r,aE as Tt,aa as qe,$ as he,r as D,x as B,w as i,h as s,n as we,M as Nt,j as e,H as oe,F as ye,V as It,i as Se,Z as kt,aJ as jt,v as Me,b as Ve,W as Ct,b2 as Ut,a as Ee,C as Bt,p as L,k as qt,B as zt,m as $,t as u,o as St,aY as Mt,aW as pe,X as At,D as Vt,a1 as xt,y as ue,z as Ft,a4 as Ht,aZ as Qt,S as Jt,Y as Wt,b4 as vt,a5 as gt,a9 as me,a_ as Gt,a$ as Kt,A as Yt,b0 as ge,b1 as ht,aH as Zt,I as d}from"./index-Bl6WO0OO.js";import{b as Xt,c as ea,e as ta,f as aa,h as sa,s as oa,i as na,d as la,j as ia,k as ra,g as ca}from"./exp-DJrUe6dM.js";import{A as wt,d as yt,f as pa,F as bt}from"./FileSaver.min-4vSDDpjd.js";import{u as ua}from"./useInterval-Dhzkz295.js";import{u as xe,n as da}from"./exp-ioZ7oJr7.js";import{u as _a}from"./groupDetail-CzfcrXL1.js";import{o as Ce,P as fa}from"./index-Df-8PMAV.js";import{D as ma,R as xa,E as va}from"./ExpsTpl-C0vpEZ7s.js";import{i as ga}from"./json-editor-vue-CKoGeIXr.js";import{_ as ha}from"./DynamicFormItem.vue_vue_type_script_setup_true_lang-BSqr0Yh9.js";import{_ as wa,a as ya}from"./FormItem-m3CyvpHh.js";import{A as ba}from"./Add-BgTSZRmz.js";import{_ as Ia}from"./Alert-CutWUBSD.js";import{_ as ka}from"./Badge-Bq-uL4sQ.js";import{_ as Ca,a as qa}from"./Tabs-D-7ozXuv.js";import"./index-pKv46H1p.js";import"./Copy16Filled-CZvuolke.js";import"./HandRight24Filled-cI_nPa8V.js";import"./Popconfirm-BgCAFv_q.js";import"./task-6IoNe2py.js";import"./DynamicForm.vue_vue_type_script_setup_true_lang-x2eWx84d.js";import"./InputNumber-XRP-0-eU.js";import"./Add-y13jjKgY.js";import"./debounce-Bqv2dJIe.js";const za={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Sa=A({name:"AttachArrowRight20Filled",render:function(l,c){return f(),V("svg",za,c[0]||(c[0]=[r("g",{fill:"none"},[r("path",{d:"M5.28 10.609l5.304-5.304a2.75 2.75 0 0 1 4.064 3.697a5.487 5.487 0 0 1 1.611.285a4.252 4.252 0 0 0-6.736-5.042L4.22 9.548a.75.75 0 0 0 1.06 1.06zm2.829 4.95l.893-.894a5.48 5.48 0 0 0 .349 1.773l-.182.181A2.75 2.75 0 0 1 5.28 12.73l5.657-5.657a.75.75 0 1 1 1.06 1.06l-5.656 5.658a1.25 1.25 0 0 0 1.768 1.768zM19 14.5a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0zm-2.147.354l.003-.003a.499.499 0 0 0 .144-.348v-.006a.5.5 0 0 0-.146-.35l-2-2a.5.5 0 0 0-.708.707L15.293 14H12.5a.5.5 0 0 0 0 1h2.793l-1.147 1.146a.5.5 0 0 0 .708.708l2-2z",fill:"currentColor"})],-1)]))}}),Ma={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Va=A({name:"BookDatabase20Regular",render:function(l,c){return f(),V("svg",Ma,c[0]||(c[0]=[r("g",{fill:"none"},[r("path",{d:"M4 4v12a2 2 0 0 0 2 2h9.5a.5.5 0 0 0 0-1H6a1 1 0 0 1-1-1h10a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2zm10-1a1 1 0 0 1 1 1v11H5V4a1 1 0 0 1 1-1h8zM8.483 6.345C8.126 6.552 8 6.787 8 7c0 .213.126.448.483.655C8.841 7.863 9.374 8 10 8c.626 0 1.159-.137 1.517-.345c.357-.207.483-.442.483-.655c0-.213-.126-.448-.483-.655C11.159 6.137 10.626 6 10 6c-.626 0-1.159.137-1.517.345zM12 8.531c-.544.31-1.254.469-2 .469c-.747 0-1.456-.16-2-.47V11c0 .123.107.365.496.607c.367.228.9.393 1.504.393s1.137-.165 1.504-.393c.389-.242.496-.484.496-.607V8.53zM7 7c0-.687.434-1.202.981-1.52C8.528 5.163 9.245 5 10 5c.755 0 1.472.163 2.019.48c.547.318.981.833.981 1.52v4c0 .627-.452 1.135-.968 1.456c-.538.334-1.256.544-2.032.544s-1.494-.21-2.032-.544C7.452 12.136 7 11.627 7 11V7z",fill:"currentColor"})],-1)]))}}),Ea={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Et=A({name:"Play24Regular",render:function(l,c){return f(),V("svg",Ea,c[0]||(c[0]=[r("g",{fill:"none"},[r("path",{d:"M7.608 4.615a.75.75 0 0 0-1.108.659v13.452a.75.75 0 0 0 1.108.659l12.362-6.726a.75.75 0 0 0 0-1.318L7.608 4.615zM5 5.274c0-1.707 1.826-2.792 3.325-1.977l12.362 6.726c1.566.853 1.566 3.101 0 3.953L8.325 20.702C6.826 21.518 5 20.432 5 18.726V5.274z",fill:"currentColor"})],-1)]))}}),Ra={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},$a=A({name:"BellOutlined",render:function(l,c){return f(),V("svg",Ra,c[0]||(c[0]=[r("path",{d:"M816 768h-24V428c0-141.1-104.3-257.7-240-277.1V112c0-22.1-17.9-40-40-40s-40 17.9-40 40v38.9c-135.7 19.4-240 136-240 277.1v340h-24c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h216c0 61.8 50.2 112 112 112s112-50.2 112-112h216c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM512 888c-26.5 0-48-21.5-48-48h96c0 26.5-21.5 48-48 48zM304 768V428c0-55.6 21.6-107.8 60.9-147.1S456.4 220 512 220c55.6 0 107.8 21.6 147.1 60.9S720 372.4 720 428v340H304z",fill:"currentColor"},null,-1)]))}}),La={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Da=A({name:"QuadrantPlot",render:function(l,c){return f(),V("svg",La,c[0]||(c[0]=[Tt('<path d="M30 15H17V2h-2v13H2v2h13v13h2V17h13v-2z" fill="currentColor"></path><path d="M5 30a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><path d="M8 8a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><path d="M22 13a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><circle cx="11" cy="11" r="2" fill="currentColor"></circle><circle cx="11" cy="21" r="2" fill="currentColor"></circle><circle cx="21" cy="21" r="2" fill="currentColor"></circle><circle cx="22" cy="28" r="2" fill="currentColor"></circle><circle cx="28" cy="24" r="2" fill="currentColor"></circle><circle cx="4" cy="11" r="2" fill="currentColor"></circle><circle cx="28" cy="4" r="2" fill="currentColor"></circle>',11)]))}}),Oa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Pa=A({name:"ScriptReference",render:function(l,c){return f(),V("svg",Oa,c[0]||(c[0]=[r("path",{d:"M4 20v2h4.586L2 28.586L3.414 30L10 23.414V28h2v-8H4z",fill:"currentColor"},null,-1),r("path",{d:"M27.17 26l-2.58 2.58L26 30l4-4l-4-4l-1.42 1.41L27.17 26z",fill:"currentColor"},null,-1),r("path",{d:"M18.83 26l2.58-2.58L20 22l-4 4l4 4l1.42-1.41L18.83 26z",fill:"currentColor"},null,-1),r("path",{d:"M25.7 9.3l-7-7A.909.909 0 0 0 18 2H8a2.006 2.006 0 0 0-2 2v12h2V4h8v6a2.006 2.006 0 0 0 2 2h6v6h2v-8a.91.91 0 0 0-.3-.7zM18 10V4.4l5.6 5.6z",fill:"currentColor"},null,-1)]))}});function ze(v){var n,m,t,_,z,y,b,O,g,E,H,re,ce,P,S,Q,J,k,Z,j,W,G,K,N,F;const l=xe();l.expInfo=v.data,l.program={waveform_script:(m=(n=v.data)==null?void 0:n.exp)==null?void 0:m.waveform_script,space_parameter_script:(_=(t=v.data)==null?void 0:t.exp)==null?void 0:_.space_parameter_script},l.running={formValue:{title:(y=(z=v.data)==null?void 0:z.exp)==null?void 0:y.title,desc:(O=(b=v.data)==null?void 0:b.exp)==null?void 0:O.desc,...(E=(g=v.data)==null?void 0:g.exp)==null?void 0:E.options},paramsList:[]};const c=JSON.parse(JSON.stringify(l.allQubits));let w=[];qe((ce=(re=(H=v.data)==null?void 0:H.exp)==null?void 0:re.wave_circuit)==null?void 0:ce.gates,T=>{w=w.concat(T.entity)}),w.length>0&&c.forEach(T=>{w.includes(T.value)?T.visible=!0:T.visible=!1}),l.allQubits=c,he((Q=(S=(P=v.data)==null?void 0:P.exp)==null?void 0:S.wave_circuit)==null?void 0:Q.gates)||(l.gates=(Z=(k=(J=v.data)==null?void 0:J.exp)==null?void 0:k.wave_circuit)==null?void 0:Z.gates),he((G=(W=(j=v.data)==null?void 0:j.exp)==null?void 0:W.wave_circuit)==null?void 0:G.layers)||(l.layers=Object.values((F=(N=(K=v.data)==null?void 0:K.exp)==null?void 0:N.wave_circuit)==null?void 0:F.layers))}const Ta=A({__name:"MsgView",setup(v,{expose:l}){const c=xe(),w=D(!1),n=[{title:"Message Id",key:"message_id",width:100},{title:"Sub Process Id",key:"sub_process_id",width:130},{title:"Message Level",key:"message_level",width:130},{title:"Message",key:"message"},{title:"Timestamp",key:"timestamp",width:180,render:_=>_.timestamp?new Date(_.timestamp).toLocaleString():""}],m=_=>{_||t()},t=()=>{w.value=!1};return l({open:()=>w.value=!0,close:t}),(_,z)=>{const y=Nt,b=we,O=ye;return f(),B(O,{show:e(w),"onUpdate:show":z[0]||(z[0]=g=>oe(w)?w.value=g:null),"on-update:show":m},{default:i(()=>[s(b,{style:{width:"80vw"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true",class:"!pt-0"},{default:i(()=>{var g,E;return[s(y,{columns:n,data:(E=(g=e(c))==null?void 0:g.expInfo)==null?void 0:E.exp_msg,pagination:!1,"scroll-x":1e3,"max-height":"500px"},null,8,["data"])]}),_:1})]),_:1},8,["show"])}}}),Na=A({__name:"TemplateData",props:{templateData:{}},setup(v,{expose:l}){const c=D(),w=It(),n=D(!1);return l({open:()=>{n.value=!0}}),(t,_)=>{const z=Se,y=kt,b=we,O=ye;return f(),B(O,{show:e(n),"onUpdate:show":_[0]||(_[0]=g=>oe(n)?n.value=g:null)},{default:i(()=>[s(b,{style:{width:"700px"},"aria-hidden":""},{default:i(()=>[_[1]||(_[1]=r("div",{class:"text-xl text-center"},"Template Data",-1)),s(z,{class:"!my-2"}),s(y,{style:{"max-height":"600px","min-height":"200px"}},{default:i(()=>[s(e(ga),{class:jt(["w-full",[e(w).baseColor==="#000"?"jse-theme-dark":""]]),"model-value":t.templateData,mode:"text",ref_key:"jsonEditorRef",ref:c},null,8,["class","model-value"])]),_:1})]),_:1})]),_:1},8,["show"])}}}),ja={key:1,class:"pr-3"},Ua={class:"mt-7 w-full flex"},Ba=A({__name:"ExpSubmit",setup(v){const l=xe(),c=Me(),w=Ve(),n=Ct(),{expInfo:m,layers:t,gates:_,program:z,expOptions:y,running:b}=Ut(l),O=D(),{t:g}=Ee(),E=D(!1),H=Bt(()=>{const P={title:{required:!0,message:g("common.required")},desc:{required:!0,message:g("common.required")},options:{required:!0,message:g("common.required")}};return Object.keys(y.value||[]).forEach(S=>{P[S]={required:!0,message:g("common.required")}}),P}),re=async()=>{var W,G,K,N,F,T,U,ne,Y,R,ve,de,X;if(E.value)return;E.value=!0;const P={};t.value.forEach((be,le)=>{P[String(le)]=be});const{title:S,desc:Q,...J}=(W=b.value)==null?void 0:W.formValue,k={template_name:(K=(G=m==null?void 0:m.value)==null?void 0:G.exp)==null?void 0:K.template.split("/")[1],device_group_name:c.query.device_group_name,space_id:c.query.space_id,task_id:(N=m.value)==null?void 0:N.task_id,experiment_json:{...m.value||{},title:S,desc:Q,template:(T=(F=m==null?void 0:m.value)==null?void 0:F.exp)==null?void 0:T.template,template_data:(ne=(U=m==null?void 0:m.value)==null?void 0:U.exp)==null?void 0:ne.template_data,wave_circuit:{gates:_.value||{},layers:P},waveform_script:((Y=z.value)==null?void 0:Y.waveform_script)||[],space_parameter_script:((R=z.value)==null?void 0:R.space_parameter_script)||[],options:J}};(ve=k==null?void 0:k.experiment_json)!=null&&ve.exp&&((de=k==null?void 0:k.experiment_json)==null||delete de.exp),(X=k==null?void 0:k.experiment_json)==null||delete X.nr;const[Z,j]=await Xt(k);E.value=!1,!Z&&(j==null?void 0:j.status)===0&&(n.success("Experiment Running"),l.showPlotParamsModal=!1,w.replace({name:"finalSetting",query:{...c.query,exp_id:j.data.exp_id}}).then(()=>{window.location.reload()}))},ce=P=>{P||(l.showPlotParamsModal=!1)};return(P,S)=>{const Q=qt,J=ya,k=kt,Z=Se,j=zt,W=wa,G=we,K=ye;return f(),B(K,{show:e(l).showPlotParamsModal,"onUpdate:show":S[2]||(S[2]=N=>e(l).showPlotParamsModal=N),onChange:ce},{default:i(()=>[s(G,{style:{width:"800px",position:"fixed",right:"50px",top:"50px"}},{default:i(()=>{var N,F;return[s(W,{model:e(b).formValue,rules:e(H),ref_key:"formRef",ref:O,class:"min-w-[340px]",disabled:!!((F=(N=e(l))==null?void 0:N.expInfo)!=null&&F.exp_id)},{default:i(()=>{var T,U,ne,Y;return[s(k,{style:{"max-height":"calc(100vh - 370px)","padding-right":"12px"}},{default:i(()=>[r("div",null,[s(J,{label:"Exp Title",path:"title"},{default:i(()=>[s(Q,{value:e(b).formValue.title,"onUpdate:value":S[0]||(S[0]=R=>e(b).formValue.title=R)},null,8,["value"])]),_:1}),s(J,{label:"Exp Desc",path:"desc"},{default:i(()=>[s(Q,{type:"textarea",value:e(b).formValue.desc,"onUpdate:value":S[1]||(S[1]=R=>e(b).formValue.desc=R)},null,8,["value"])]),_:1})]),e(y)?(f(),B(ha,{key:0,paramsCfg:e(y),"form-value":e(b).formValue},null,8,["paramsCfg","form-value"])):L("",!0)]),_:1}),(U=(T=e(l))==null?void 0:T.expInfo)!=null&&U.exp_id?L("",!0):(f(),B(Z,{key:0,class:"!mb-0"})),(Y=(ne=e(l))==null?void 0:ne.expInfo)!=null&&Y.exp_id?L("",!0):(f(),V("div",ja,[r("div",Ua,[s(j,{type:"primary",size:"small",loading:e(E),onClick:re,class:"w-full flex-1"},{icon:i(()=>[s(e(Et))]),default:i(()=>[$(" "+u(e(g)("expInfo.submit")),1)]),_:1},8,["loading"])])]))]}),_:1},8,["model","rules","disabled"])]}),_:1})]),_:1},8,["show"])}}}),Aa={class:"min-h-[98px] flex justify-between"},Fa={key:0,class:"flex flex-col pr-4 mr-5",style:{"border-right":"1px solid rgba(56, 137, 197, 0.35)"}},Ha={class:"text-xl font-bold"},Qa={class:"text-sm font-light mt-2 opacity-60"},Ja={class:"flex-1 flex"},Wa={class:"flex flex-col gap-1.5 min-w-[260px] pr-5 mr-5",style:{"border-right":"1px solid rgba(56, 137, 197, 0.35)"}},Ga={class:"flex"},Ka={class:"inline-block pr-1"},Ya={class:"font-bold"},Za={class:"inline-flex items-center"},Xa={class:"flex-1 flex gap-1.5 min-w-[260px]"},es={class:"flex flex-col gap-1.5 flex-1"},ts={class:"flex"},as={key:0,class:"pr-1"},ss={class:"font-bold"},os={class:"flex items-center"},ns={key:0,class:"italic opacity-70 pr-1 text-xs"},ls={key:1,class:"italic pr-1 text-xs"},is={class:"flex"},rs={key:1,class:"flex flex-col gap-2 min-w-52"},cs={class:"flex gap-4 justify-between"},ps={key:1},us={class:"flex gap-2"},ds={class:"flex items-center gap-2"},_s={class:"text-lg mb-4 flex justify-between"},fs={class:"text-lg mb-4 flex justify-between"},ms={class:"relative"},xs=A({__name:"ExpInfoView",setup(v){const{t:l}=Ee(),c=It(),w=Ct(),n=Me(),m=Ve(),t=xe(),_=_a(),z=D(),y=D(),b=()=>{var o,a,p;(a=(o=t.expInfo)==null?void 0:o.exp)!=null&&a.template&&((p=y.value)==null||p.open())},O=D(),g=async()=>{const o=n.query.device_group_name;if(!o)return;const[a,p]=await Yt({device_group_name:o});if(!a&&(p==null?void 0:p.status)===0){const{space_list:x,...I}=p.data;_.groupInfo=I,_.spaceList=x.map(h=>({...h,label:h.space_name,value:h.space_id}))}},E=async()=>{var p;if(n.query.exp_id===void 0||n.query.exp_id==="")return;const[o,a]=await ca({exp_id:n.query.exp_id,device_group_name:n.query.device_group_name,space_id:n.query.space_id});!o&&(a==null?void 0:a.status)===0&&((p=a.data)!=null&&p.data&&(a.data.data=JSON.parse(a.data.data)),t.result=a.data)},H=async()=>{t.loading=!0;const{device_group_name:o,exp_id:a}=n.query;if(!o||!a){t.loading=!1;return}const[p,x]=await ia({device_group_name:o,exp_id:a});t.loading=!1,!p&&(x==null?void 0:x.status)===0&&(ze(x),pe(()=>{n.query.dup&&(W(),pe(()=>{setTimeout(()=>{m.replace({name:"waveforms",query:Ce(n.query,"dup")})},300)}))}),E())},re=async()=>{var p;if((p=t==null?void 0:t.expInfo)!=null&&p.status&&[me.COMPLETE,me.CANCELED,me.ERROR].includes(t.expInfo.status)){S();return}if(!n.query.exp_id)return;const[o,a]=await ra({device_group_name:n.query.device_group_name,exp_id:n.query.exp_id});!o&&(a==null?void 0:a.status)===0&&(t.expInfo={...t.expInfo,...a.data||{}})},ce=async()=>{var p,x;const[o,a]=await ea();if(!o&&(a==null?void 0:a.status)===0){const I={};Object.keys(a.data).forEach(ee=>{I[ee]=a.data[ee].default?a.data[ee].default:void 0});const h=(x=(p=t.expInfo)==null?void 0:p.exp)==null?void 0:x.options;t.expOptions=a.data,t.running={...t.running,formValue:{...t.running.formValue,...he(h)?I:{}}}}},{start:P,stop:S}=ua(re,{isManual:!0,duration:3*1e3}),Q=async()=>{const[o,a]=await ta();!o&&(a==null?void 0:a.status)===0&&(t.waveCompiler=a.data)},J=async()=>{const[o,a]=await aa();!o&&(a==null?void 0:a.status)===0&&(t.waveFunctions=a.data)},k=async()=>{const[o,a]=await sa({device_group_name:n.query.device_group_name,space_id:n.query.space_id});if(!o&&(a==null?void 0:a.status)===0){let p=[];if(qe(a.data,(x,I)=>{p=p.concat(x.map((h,ee)=>({id:da(),value:h,visible:ee<10,type:I})))}),t.allQubits=p,!n.query.exp_id){const x=JSON.parse(JSON.stringify(t.allQubits));let I=[];qe(t==null?void 0:t.gates,h=>{I=I.concat(h.entity)}),I.length>0&&x.forEach(h=>{I.includes(h.value)?h.visible=!0:h.visible=!1}),t.allQubits=x;return}pe(()=>{H(),P()})}},Z=()=>{var o;(o=O.value)==null||o.open()},j=()=>{const o=new URLSearchParams({device_group_name:n.query.device_group_name,task_id:n.query.task_id,task_title:n.query.task_title,space_id:n.query.space_id,exp_id:n.query.exp_id,dup:String(1)});window.open(`/experiment/waveforms?${o.toString()}`,"_blank")},W=()=>{const o=JSON.parse(JSON.stringify(t.expInfo));delete o.exp_id,delete o.progress,delete o.status,delete o.exp_msg,t.expInfo=o,t.result=void 0,pe(()=>{w.success("Duplicated successfully"),m.replace({name:"waveforms",query:Ce(n.query,["exp_id"])})})},G=async()=>{const[o,a]=await oa({exp_id:n.query.exp_id});!o&&(a==null?void 0:a.status)===0&&w.success("实验终止成功")},K=()=>{var o;(o=z.value)==null||o.open()};St(()=>{if(ce(),k(),g(),setTimeout(()=>{Q(),J()},100),n.query.create=="1"){const o=Mt("t");o&&(ze(o),pe(()=>{setTimeout(()=>{m.replace({name:"waveforms",query:Ce(n.query,"combine")}).then(()=>{localStorage.removeItem("t")})},200)}))}});const N=()=>{t.showPlotParamsModal=!0};At(S);const F=async()=>{var p,x;const[o,a]=await na({group_name:n.query.device_group_name,exp_id:String((p=t==null?void 0:t.expInfo)==null?void 0:p.exp_id)});!o&&(a==null?void 0:a.status)===0&&bt.saveAs(`${ge(location.origin)}/${ge((x=a==null?void 0:a.data)==null?void 0:x.filename)}`,ht(a.data.filename))},T=async()=>{var p,x;const[o,a]=await la({group_name:n.query.device_group_name,space_id:n.query.space_id,version:String((p=t.expInfo)==null?void 0:p.space_timestamp)});!o&&(a==null?void 0:a.status)===0&&bt.saveAs(`${ge(location.origin)}/${ge((x=a==null?void 0:a.data)==null?void 0:x.filename)}`,ht(a.data.filename))},U=D(!1),ne=o=>{o||(U.value=!1)},Y=D(),R=D(),ve=()=>{var o;(o=Y.value)==null||o.refresh()},de=()=>{U.value=!0},X=D(!1),be=o=>{o||(X.value=!1,R.value="")},le=D(!1),Rt=o=>{o||(le.value=!1)},$t=()=>{var o;(o=t.expInfo)!=null&&o.exp_id?le.value=!0:X.value=!0};return(o,a)=>{const p=ue,x=Vt("router-link"),I=Ht,h=zt,ee=Qt,Lt=Jt,Dt=ka,Ot=Ia,Re=Se,Ie=we,ke=ye,Pt=qt;return f(),V(xt,null,[s(Ot,{type:"info","show-icon":!1},{default:i(()=>{var M,te,ae,se,ie,_e,$e,Le,De,Oe,Pe,Te,Ne,je,Ue,Be,Ae,Fe,He,Qe,Je,We,Ge,Ke,Ye,Ze,Xe,et,tt,at,st,ot,nt,lt,it,rt,ct,pt,ut,dt,_t,ft;return[r("div",Aa,[(M=e(_))!=null&&M.groupInfo?(f(),V("div",Fa,[s(x,{class:"underline underline-offset-4 inline-flex items-center gap-0.5",to:{name:"taskList",query:{device_group_name:e(n).query.device_group_name}}},{default:i(()=>{var C,q;return[s(p,{component:e(Ft)},null,8,["component"]),r("span",Ha,u((q=(C=e(_))==null?void 0:C.groupInfo)==null?void 0:q.device_group_name),1)]}),_:1},8,["to"]),r("span",Qa,u((ae=(te=e(_))==null?void 0:te.groupInfo)==null?void 0:ae.description),1)])):L("",!0),r("div",Ja,[(se=e(t))!=null&&se.expInfo?(f(),V(xt,{key:0},[r("div",Wa,[r("div",Ga,[r("span",Ka,[s(I,{type:"success",size:"small",color:{color:"#ff5722",textColor:"#fff"}},{default:i(()=>{var C,q;return[$(u(e(l)("expInfo.task"))+" "+u((q=(C=e(t))==null?void 0:C.expInfo)==null?void 0:q.task_id),1)]}),_:1})]),s(x,{to:{name:"experimentList",query:{device_group_name:e(n).query.device_group_name,task_id:(_e=(ie=e(t))==null?void 0:ie.expInfo)==null?void 0:_e.task_id,task_title:(Le=($e=e(t))==null?void 0:$e.expInfo)==null?void 0:Le.task_title,space_id:e(n).query.space_id}},class:"underline underline-offset-4"},{default:i(()=>{var C,q;return[r("span",Ya,u((q=(C=e(t))==null?void 0:C.expInfo)==null?void 0:q.task_title),1)]}),_:1},8,["to"]),s(h,{type:"primary",size:"small",class:"!ml-2 !h-[22px]",onClick:K},{icon:i(()=>[s(e(ba))]),default:i(()=>[$(" "+u(e(l)("expInfo.create")),1)]),_:1})]),r("div",null,[r("span",Za,[$(u(e(l)("expInfo.space"))+"： ",1),s(I,{size:"small",class:"!cursor-pointer",type:"warning",onClick:$t},{default:i(()=>{var C,q,fe,mt;return[$(u((q=(C=e(t))==null?void 0:C.expInfo)==null?void 0:q.space_name)+" ( "+u((mt=(fe=e(t))==null?void 0:fe.expInfo)==null?void 0:mt.space_time_str)+" ) ",1)]}),_:1}),s(ee,{trigger:"hover"},{trigger:i(()=>[s(h,{type:"info",class:"!ml-1",size:"tiny",onClick:T},{icon:i(()=>[s(e(wt))]),_:1})]),default:i(()=>[$(" "+u(e(l)("expInfo.downloadSpaceParams")),1)]),_:1})])]),r("div",null,u((Oe=(De=e(t))==null?void 0:De.expInfo)==null?void 0:Oe.task_desc),1)]),r("div",Xa,[(Pe=e(t).result)!=null&&Pe.small_picture_url?(f(),B(Lt,{key:0,src:e(vt)((Te=e(t).result)==null?void 0:Te.small_picture_url,"t",String(+new Date)),"preview-src":((Ne=e(t).result)==null?void 0:Ne.big_picture_url)||e(vt)((je=e(t).result)==null?void 0:je.small_picture_url,"t",String(+new Date)),alt:"",class:"mr-2 h-fit p-[1px] w-[100px]",style:Wt({border:`1px solid ${e(c).dividerColor}`})},null,8,["src","preview-src","style"])):L("",!0),r("div",es,[r("div",ts,[(Be=(Ue=e(t))==null?void 0:Ue.expInfo)!=null&&Be.exp_id?(f(),V("span",as,[s(I,{color:{color:"#7816ff",textColor:"#fff"},size:"small"},{default:i(()=>{var C,q;return[$(u(e(l)("expInfo.exp"))+" "+u((q=(C=e(t))==null?void 0:C.expInfo)==null?void 0:q.exp_id),1)]}),_:1})])):L("",!0),r("span",ss,u((Fe=(Ae=e(t))==null?void 0:Ae.expInfo)==null?void 0:Fe.exp_title),1)]),r("div",os,[(He=e(t).expInfo)!=null&&He.exp_id?(f(),V("span",ns,u((Je=(Qe=e(t))==null?void 0:Qe.expInfo)==null?void 0:Je.create_time),1)):(f(),V("span",ls,[s(I,{size:"small",bordered:!1,color:{color:"#f00",textColor:"#fff"}},{default:i(()=>[$(u(e(l)("expInfo.unsumbit")),1)]),_:1})])),r("span",null,[s(I,{type:"warning",size:"small",onClick:b,class:"!cursor-pointer"},{default:i(()=>{var C,q,fe;return[$(u(((fe=(q=(C=e(t))==null?void 0:C.expInfo)==null?void 0:q.exp)==null?void 0:fe.template)||e(l)("expInfo.notpl")),1)]}),_:1})]),(We=e(t).expInfo)!=null&&We.exp_id?(f(),B(ee,{key:2,trigger:"hover"},{trigger:i(()=>[s(h,{type:"info",class:"!ml-1",size:"tiny",onClick:F},{icon:i(()=>[s(e(wt))]),_:1})]),default:i(()=>[$(" "+u(e(l)("expInfo.downloadExp")),1)]),_:1})):L("",!0)]),r("div",is,u((Ke=(Ge=e(t))==null?void 0:Ge.expInfo)==null?void 0:Ke.exp_desc),1)])])],64)):L("",!0)]),(Ye=e(t))!=null&&Ye.expInfo?(f(),V("div",rs,[r("div",cs,[(Xe=(Ze=e(t))==null?void 0:Ze.expInfo)!=null&&Xe.status?(f(),B(I,{key:0,color:{color:e(gt)[e(t).expInfo.status].color,textColor:"#fff"},size:"small"},{default:i(()=>[$(u(e(l)(e(gt)[e(t).expInfo.status].text)),1)]),_:1},8,["color"])):L("",!0),(tt=(et=e(t))==null?void 0:et.expInfo)!=null&&tt.progress?(f(),V("span",ps,u((st=(at=e(t))==null?void 0:at.expInfo)==null?void 0:st.progress),1)):L("",!0),s(Dt,{value:(nt=(ot=e(t).expInfo)==null?void 0:ot.exp_msg)==null?void 0:nt.length,max:15,class:"cursor-pointer",onClick:Z},{default:i(()=>[s(p,{size:22},{default:i(()=>[s(e($a))]),_:1})]),_:1},8,["value"])]),r("div",us,[s(h,{type:"info",size:"small",class:"flex-1",onClick:j,disabled:((rt=(it=(lt=e(t))==null?void 0:lt.expInfo)==null?void 0:it.exp)==null?void 0:rt.exp_mode)==="batch_circuit"||!e(n).query.exp_id},{icon:i(()=>[s(e(ma))]),default:i(()=>[$(u(e(l)("expInfo.duplicate"))+" ",1)]),_:1},8,["disabled"]),s(h,{type:"info",size:"small",class:"flex-1",disabled:![e(me).RUNNING,e(me).HOST_DOWNLOADED].includes((ct=e(t).expInfo)==null?void 0:ct.status),onClick:G},{icon:i(()=>[s(e(xa))]),default:i(()=>[$(u(e(l)("expInfo.stop"))+" ",1)]),_:1},8,["disabled"])]),r("div",ds,[s(h,{class:"flex-1",type:"primary",size:"small",onClick:N,disabled:!!((ut=(pt=e(t))==null?void 0:pt.expInfo)!=null&&ut.exp_id)},{icon:i(()=>[s(e(Et))]),default:i(()=>[$(u(e(l)("expInfo.run"))+" ",1)]),_:1},8,["disabled"])])])):L("",!0),s(Ta,{ref_key:"msgViewRef",ref:O},null,512)]),s(va,{ref_key:"expsTplRef",ref:z},null,512),s(Na,{ref_key:"tempalteDataRef",ref:y,"template-data":(ft=(_t=(dt=e(t))==null?void 0:dt.expInfo)==null?void 0:_t.exp)==null?void 0:ft.template_data},null,8,["template-data"]),s(Ba)]}),_:1}),s(ke,{show:e(le),"onUpdate:show":[a[0]||(a[0]=M=>oe(le)?le.value=M:null),Rt],size:"huge"},{default:i(()=>[s(Ie,{style:{"min-height":"82vh",overflow:"auto",width:"1200px","min-width":"500px"}},{default:i(()=>{var M,te,ae,se,ie,_e;return[r("div",_s,[r("div",null,u(e(l)("expInfo.space"))+"： "+u((te=(M=e(t))==null?void 0:M.expInfo)==null?void 0:te.space_name)+" ( "+u((se=(ae=e(t))==null?void 0:ae.expInfo)==null?void 0:se.space_time_str)+" ) ",1)]),s(Re,{class:"!my-4"}),e(n).query.space_id?(f(),B(yt,{key:0,ref_key:"paramsLatestRef",ref:Y,"max-height":"65vh","read-only":"",version:(_e=(ie=e(t))==null?void 0:ie.expInfo)==null?void 0:_e.space_timestamp,"space-id":+e(n).query.space_id},null,8,["version","space-id"])):L("",!0)]}),_:1})]),_:1},8,["show"]),s(ke,{show:e(X),"onUpdate:show":[a[2]||(a[2]=M=>oe(X)?X.value=M:null),be],size:"huge"},{default:i(()=>[s(Ie,{style:{"min-height":"82vh",overflow:"auto",width:"1200px","min-width":"500px"}},{default:i(()=>{var M,te,ae,se;return[r("div",fs,[r("div",null,u(e(l)("expInfo.space"))+"： "+u((te=(M=e(t))==null?void 0:M.expInfo)==null?void 0:te.space_name)+" ( "+u((se=(ae=e(t))==null?void 0:ae.expInfo)==null?void 0:se.space_time_str)+" ) ",1),r("div",ms,[s(Pt,{style:{width:"310px","padding-right":"20px"},value:e(R),"onUpdate:value":a[1]||(a[1]=ie=>oe(R)?R.value=ie:null),valueModifiers:{trim:!0},onKeyup:Gt(de,["enter"]),placeholder:e(l)("groupDetail.parameterManager.searchPlaceholder")},null,8,["value","placeholder"]),r("div",{class:"absolute -right-4 top-1/2 -translate-1/2 h-full w-8 flex items-center justify-center cursor-pointer",onClick:de},[s(p,{color:e(c).primaryColor,component:e(Kt)},null,8,["color","component"])])])]),s(Re,{class:"!my-4"}),e(n).query.space_id?(f(),B(yt,{key:0,ref_key:"paramsLatestRef",ref:Y,"max-height":"65vh","space-id":+e(n).query.space_id},null,8,["space-id"])):L("",!0)]}),_:1})]),_:1},8,["show"]),s(ke,{show:e(U),"onUpdate:show":a[4]||(a[4]=M=>oe(U)?U.value=M:null),size:"huge",onUpdateShow:ne},{default:i(()=>[s(Ie,{style:{"min-height":"82vh",overflow:"auto",width:"1300px","max-width":"95vw","min-width":"500px"}},{default:i(()=>[e(n).query.space_id?(f(),B(pa,{key:0,search:"","space-id":+e(n).query.space_id,"hide-history-option":"",modelValue:e(R),"onUpdate:modelValue":a[3]||(a[3]=M=>oe(R)?R.value=M:null),onRefresh:ve},null,8,["space-id","modelValue"])):L("",!0)]),_:1})]),_:1},8,["show"])],64)}}}),vs={class:"flex mt-5"},gs={class:"ml-5 flex-1"},As=A({__name:"ExperimentView",setup(v){const{t:l}=Ee(),c=Me(),w=Ve(),n=xe(),m=D(),t=_=>{w.push({name:_,query:c.query})};return Zt(c,_=>{m.value=_.name},{deep:!0,immediate:!0}),St(()=>{const _=Mt("t");he(_)||(n.reset(),pe(()=>{ze(_),localStorage.removeItem("t")}))}),(_,z)=>{const y=Ca,b=qa,O=Vt("router-view");return f(),V("div",null,[s(xs),r("div",vs,[s(b,{type:"card",animated:"",placement:"left",class:"!h-full !w-auto",value:e(m),"onUpdate:value":z[0]||(z[0]=g=>oe(m)?m.value=g:null),onUpdateValue:t},{default:i(()=>{var g,E,H;return[s(y,{name:"waveforms",tab:d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},d(e(ue),{size:20},{default:()=>d(e(fa))})),d("div",[d("div",{class:"font-bold"},e(l)("expInfo.waveforms"))])])},null,8,["tab"]),s(y,{name:"program",tab:d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},d(e(ue),{size:20},{default:()=>d(e(Pa))})),d("div",[d("div",{class:"font-bold"},e(l)("expInfo.program"))])])},null,8,["tab"]),s(y,{name:"finalSetting",disabled:!((g=e(n).expInfo)!=null&&g.exp_id),tab:d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},d(e(ue),{size:20},{default:()=>d(e(Da))})),d("div",[d("div",{class:"font-bold"},e(l)("expInfo.plotter"))])])},null,8,["disabled","tab"]),s(y,{name:"result",disabled:!((E=e(n).expInfo)!=null&&E.exp_id),tab:d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},d(e(ue),{size:20},{default:()=>d(e(Va))})),d("div",[d("div",{class:"font-bold"},e(l)("expInfo.fitting"))])])},null,8,["disabled","tab"]),s(y,{name:"attachment",disabled:!((H=e(n).expInfo)!=null&&H.exp_id),tab:d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},d(e(ue),{size:20},{default:()=>d(e(Sa))})),d("div",[d("div",{class:"font-bold"},e(l)("expInfo.attachment"))])])},null,8,["disabled","tab"])]}),_:1},8,["value"]),r("div",gs,[s(O)])])])}}});export{As as default};
