<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}Mocktricks Exporter{% endblock %}</title>
    <script>
      // Tailwind CDN config: set a pleasant brand color
      window.tailwind = window.tailwind || {};
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              brand: {
                DEFAULT: '#6366f1', // indigo-500
              },
            },
          },
        },
      };
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <style>
      /* Per-metric collapse only (global collapse removed) */
      [data-metric-collapsed="1"] .metric-values { display: none; }
      [data-metric-collapsed="1"] [id^="add-value-"] { display: none; }
      [data-metric-collapsed="1"] .metric-doc { display: none; }
      [data-metric-collapsed="1"] .metric-labels { display: none; }
      [data-metric-collapsed="1"] .metric-actions > * { display: none; }
      [data-metric-collapsed="1"] .metric-actions > .minimize-toggle { display: inline-flex; }
      /* tighten padding on collapsed cards */
      [data-metric-collapsed="1"] { padding-top: 0.125rem; padding-bottom: 0.125rem; }
      /* smaller title and button when collapsed */
      [data-metric-collapsed="1"] .metric-title { font-size: 0.75rem; line-height: 1rem; }
      [data-metric-collapsed="1"] .minimize-toggle { font-size: 0.625rem; padding: 0.125rem 0.375rem; }
    </style>
    <script>
      function _getCollapsedSet() {
        try { return new Set(JSON.parse(localStorage.getItem('collapsedMetrics') || '[]')); }
        catch { return new Set(); }
      }
      function _saveCollapsedSet(set) {
        localStorage.setItem('collapsedMetrics', JSON.stringify(Array.from(set)));
      }
      function applyCollapsedState() {
        const list = document.getElementById('metrics-list');
        if (!list) return;
        // Clean up deprecated global collapsed flag
        try { localStorage.removeItem('metricsCollapsed'); } catch {}
        const set = _getCollapsedSet();
        set.forEach(id => {
          const card = document.getElementById('metric-' + id);
          if (card) {
            card.dataset.metricCollapsed = '1';
            const btn = card.querySelector('.minimize-toggle');
            if (btn) btn.innerText = 'Expand';
          }
        });
      }
      document.addEventListener('DOMContentLoaded', applyCollapsedState);
      document.addEventListener('htmx:afterSwap', (e) => {
        if (e.target && e.target.id === 'metrics-list') applyCollapsedState();
      });
    </script>
  </head>
  <body class="min-h-screen bg-slate-50 text-slate-900">
    <header class="border-b bg-white">
      <div class="mx-auto max-w-6xl px-4 py-4 flex items-center">
        <h1 class="text-lg font-semibold tracking-tight text-slate-900">Mocktricks Exporter</h1>
      </div>
    </header>
    <main class="mx-auto max-w-6xl px-4 py-6">
      {% block content %}{% endblock %}
    </main>
    <footer class="mx-auto max-w-5xl px-4 py-8 text-xs text-neutral-500">
      <p>Serving metrics on <code class="font-mono">:8000</code> and API on <code class="font-mono">:8080</code>.</p>
    </footer>
  </body>
  </html>
