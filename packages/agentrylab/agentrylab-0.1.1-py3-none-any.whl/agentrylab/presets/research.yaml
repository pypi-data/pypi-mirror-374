#########################
# Research Collaboration preset
# Tips:
# - Add/replace advisors for style, safety, or pedagogy feedback.
# - Use TOPIC to seed objective, and pin via context_defaults.
# - Reorder the scheduler to change cadence (e.g., put summarizer at the end).
#########################

version: "1.0.0"
id: research_team
name: Research Collaboration
description: Scientists explore a research problem with light-touch moderation.

# Optional user seed topic (pinned when enabled)
objective: ${TOPIC:Investigate a curious scientific question together.}

runtime:
  max_rounds: 6
  trace: { enabled: true }
  scheduler:
    impl: agentrylab.runtime.scheduler.every_n.EveryNScheduler
    params:
      schedule:
        scientistA: 1
        scientistB: 1
        style_coach: 2
        moderator: 2
        summarizer:
          every_n: 2
          run_on_last: true
  message_contract:
    require_metadata: false
  context_defaults:
    pin_objective: true

providers:
  - id: ollama_llama3
    impl: agentrylab.runtime.providers.ollama.OllamaProvider
    model: "llama3:latest"
    base_url: "http://localhost:11434"
    timeout: 8

tools:
  - id: search_ddg
    impl: agentrylab.runtime.tools.ddg.DuckDuckGoSearchTool
    params:
      max_results: 5

agents:
  - id: scientistA
    role: agent
    provider: ollama_llama3
    tools: [search_ddg]
    description: Focused on theory
    system_prompt: "You are a scientist exploring theoretical explanations. Be open and creative."
  - id: scientistB
    role: agent
    provider: ollama_llama3
    tools: [search_ddg]
    description: Focused on experiments
    system_prompt: "You are a scientist proposing experiments and practical tests. Keep it approachable."
  - id: moderator
    role: moderator
    provider: ollama_llama3
    tools: [search_ddg]
    description: Senior leader moderating
    system_prompt: |
      You are a supportive moderator. Encourage evidence and good structure,
      but avoid strict policing. Respond ONLY with JSON using the following keys:
      {"summary": str, "drift": float, "action": "CONTINUE"|"STOP"|"STEP_BACK", "rollback": int, "citations": [str], "clear_summaries": bool}

      Example:
      {
        "summary": "Concise status of progress",
        "drift": 0.1,
        "action": "CONTINUE",
        "rollback": 0,
        "citations": ["https://example.org"],
        "clear_summaries": false
      }
  - id: summarizer
    role: summarizer
    provider: ollama_llama3
    description: Summarizes scientific progress
    system_prompt: "Summarize the debate neutrally with a light, readable tone."
    max_summary_chars: 600

advisors:
  - id: style_coach
    role: advisor
    provider: ollama_llama3
    description: Non-blocking style feedback
    system_prompt: |
      You are a concise style coach. Offer 2-3 short bullets to improve clarity and structure.
      Avoid content changes; focus on readability and organization.
