(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2423],{74833:function(a,e,n){var t=n(56127),i=/^\s+/;a.exports=function(a){return a?a.slice(0,t(a)+1).replace(i,""):a}},56632:function(a,e,n){var t=n(89278),i=n(80068),s=n(50098);a.exports=function(a){return function(e,n,o){var r=Object(e);if(!i(e)){var l=t(n,3);e=s(e),n=function(a){return l(r[a],a,r)}}var _=a(e,n,o);return _>-1?r[l?e[_]:_]:void 0}}},56127:function(a){var e=/\s/;a.exports=function(a){for(var n=a.length;n--&&e.test(a.charAt(n)););return n}},66726:function(a,e,n){var t=n(11611),i=n(82846),s=n(91936),o=Math.max,r=Math.min;a.exports=function(a,e,n){var l,_,u,F,d,c,S=0,m=!1,v=!1,C=!0;if("function"!=typeof a)throw TypeError("Expected a function");function f(e){var n=l,t=_;return l=_=void 0,S=e,F=a.apply(t,n)}function h(a){var n=a-c,t=a-S;return void 0===c||n>=e||n<0||v&&t>=u}function y(){var a,n,t,s=i();if(h(s))return p(s);d=setTimeout(y,(a=s-c,n=s-S,t=e-a,v?r(t,u-n):t))}function p(a){return(d=void 0,C&&l)?f(a):(l=_=void 0,F)}function A(){var a,n=i(),t=h(n);if(l=arguments,_=this,c=n,t){if(void 0===d)return S=a=c,d=setTimeout(y,e),m?f(a):F;if(v)return clearTimeout(d),d=setTimeout(y,e),f(c)}return void 0===d&&(d=setTimeout(y,e)),F}return e=s(e)||0,t(n)&&(m=!!n.leading,u=(v="maxWait"in n)?o(s(n.maxWait)||0,e):u,C="trailing"in n?!!n.trailing:C),A.cancel=function(){void 0!==d&&clearTimeout(d),S=0,l=c=_=d=void 0},A.flush=function(){return void 0===d?F:p(i())},A}},64925:function(a,e,n){var t=n(56632)(n(66259));a.exports=t},66259:function(a,e,n){var t=n(95372),i=n(89278),s=n(47991),o=Math.max;a.exports=function(a,e,n){var r=null==a?0:a.length;if(!r)return -1;var l=null==n?0:s(n);return l<0&&(l=o(r+l,0)),t(a,i(e,3),l)}},82846:function(a,e,n){var t=n(77400);a.exports=function(){return t.Date.now()}},94919:function(a,e,n){var t=n(91936),i=1/0;a.exports=function(a){return a?(a=t(a))===i||a===-i?(a<0?-1:1)*17976931348623157e292:a==a?a:0:0===a?a:0}},47991:function(a,e,n){var t=n(94919);a.exports=function(a){var e=t(a),n=e%1;return e==e?n?e-n:e:0}},91936:function(a,e,n){var t=n(74833),i=n(11611),s=n(55193),o=0/0,r=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,_=/^0o[0-7]+$/i,u=parseInt;a.exports=function(a){if("number"==typeof a)return a;if(s(a))return o;if(i(a)){var e="function"==typeof a.valueOf?a.valueOf():a;a=i(e)?e+"":e}if("string"!=typeof a)return 0===a?a:+a;a=t(a);var n=l.test(a);return n||_.test(a)?u(a.slice(2),n?2:8):r.test(a)?o:+a}},86850:function(a,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/[monitorId]",function(){return n(24699)}])},30952:function(a,e,n){"use strict";n.d(e,{f:function(){return l}});var t=n(24246),i=n(66726),s=n.n(i),o=n(27378),r=n(26917);let l=a=>{let{value:e,onChange:n,placeholder:i,...l}=a,[_,u]=(0,o.useState)(e);(0,o.useEffect)(()=>{u(e||"")},[e]);let F=s()(n,500),d=(0,o.useCallback)(a=>{u(a),F(a)},[]);return(0,t.jsx)(r.Z,{value:_,onChange:d,onClear:()=>{u(""),n("")},placeholder:i,...l})}},26089:function(a,e,n){"use strict";var t=n(24246),i=n(96306),s=n(99830),o=n.n(s);e.Z=a=>{let{onClick:e,children:n}=a;return(0,t.jsx)(i.wpx,{onClick:e,type:"link",role:"link",size:"small",className:o().toastLink,children:n})}},8411:function(a,e,n){"use strict";n.d(e,{NA:function(){return s},Z8:function(){return i}});var t=n(54682);let i={[t._F.ER]:"Eritrea",[t._F.DJ]:"Djibouti",[t._F.MR]:"Mauritania",[t._F.NA]:"Namibia",[t._F.GH]:"Ghana",[t._F.SS]:"South Sudan",[t._F.SC]:"Seychelles",[t._F.IO]:"British Indian Ocean Territory",[t._F.GQ]:"Equatorial Guinea",[t._F.AO]:"Angola",[t._F.CG]:"Republic of the Congo",[t._F.BW]:"Botswana",[t._F.BI]:"Burundi",[t._F.DZ]:"Algeria",[t._F.TD]:"Chad",[t._F.NG]:"Nigeria",[t._F.TZ]:"Tanzania",[t._F.EH]:"Western Sahara",[t._F.SN]:"Senegal",[t._F.LR]:"Liberia",[t._F.ZA]:"South Africa",[t._F.CV]:"Cape Verde",[t._F.GM]:"Gambia",[t._F.SD]:"Sudan",[t._F.KM]:"Comoros",[t._F.SZ]:"Eswatini",[t._F.UG]:"Uganda",[t._F.MG]:"Madagascar",[t._F.RW]:"Rwanda",[t._F.CD]:"DR Congo",[t._F.CM]:"Cameroon",[t._F.SH]:"Saint Helena, Ascension and Tristan da Cunha",[t._F.TG]:"Togo",[t._F.MU]:"Mauritius",[t._F.NE]:"Niger",[t._F.BJ]:"Benin",[t._F.EG]:"Egypt",[t._F.LS]:"Lesotho",[t._F.ET]:"Ethiopia",[t._F.MA]:"Morocco",[t._F.YT]:"Mayotte",[t._F.BF]:"Burkina Faso",[t._F.RE]:"R\xe9union",[t._F.ST]:"S\xe3o Tom\xe9 and Pr\xedncipe",[t._F.CF]:"Central African Republic",[t._F.MZ]:"Mozambique",[t._F.MW]:"Malawi",[t._F.ML]:"Mali",[t._F.ZM]:"Zambia",[t._F.LY]:"Libya",[t._F.GW]:"Guinea-Bissau",[t._F.SO]:"Somalia",[t._F.KE]:"Kenya",[t._F.GN]:"Guinea",[t._F.ZW]:"Zimbabwe",[t._F.TN]:"Tunisia",[t._F.SL]:"Sierra Leone",[t._F.GA]:"Gabon",[t._F.CI]:"Ivory Coast",[t._F.JO]:"Jordan",[t._F.PK]:"Pakistan",[t._F.KP]:"North Korea",[t._F.MO]:"Macau",[t._F.AM]:"Armenia",[t._F.SY]:"Syria",[t._F.TJ]:"Tajikistan",[t._F.SA]:"Saudi Arabia",[t._F.KR]:"South Korea",[t._F.NP]:"Nepal",[t._F.PH]:"Philippines",[t._F.IQ]:"Iraq",[t._F.LB]:"Lebanon",[t._F.MN]:"Mongolia",[t._F.PS]:"Palestine",[t._F.YE]:"Yemen",[t._F.JP]:"Japan",[t._F.KZ]:"Kazakhstan",[t._F.LK]:"Sri Lanka",[t._F.MM]:"Myanmar",[t._F.KG]:"Kyrgyzstan",[t._F.CN]:"China",[t._F.AF]:"Afghanistan",[t._F.OM]:"Oman",[t._F.IN]:"India",[t._F.LA]:"Laos",[t._F.UZ]:"Uzbekistan",[t._F.MV]:"Maldives",[t._F.ID]:"Indonesia",[t._F.VN]:"Vietnam",[t._F.MY]:"Malaysia",[t._F.TW]:"Taiwan",[t._F.KH]:"Cambodia",[t._F.AE]:"United Arab Emirates",[t._F.HK]:"Hong Kong",[t._F.GE]:"Georgia (Country)",[t._F.BD]:"Bangladesh",[t._F.KW]:"Kuwait",[t._F.TM]:"Turkmenistan",[t._F.QA]:"Qatar",[t._F.BH]:"Bahrain",[t._F.BN]:"Brunei",[t._F.TH]:"Thailand",[t._F.BT]:"Bhutan",[t._F.SG]:"Singapore",[t._F.IL]:"Israel",[t._F.AZ]:"Azerbaijan",[t._F.TL]:"Timor-Leste",[t._F.IR]:"Iran",[t._F.TR]:"Turkey",[t._F.MK]:"North Macedonia",[t._F.IE]:"Ireland",[t._F.DK]:"Denmark",[t._F.SK]:"Slovakia",[t._F.MD]:"Moldova",[t._F.AX]:"\xc5land Islands",[t._F.PL]:"Poland",[t._F.BA]:"Bosnia and Herzegovina",[t._F.SM]:"San Marino",[t._F.CZ]:"Czechia",[t._F.EE]:"Estonia",[t._F.XK]:"Kosovo",[t._F.FO]:"Faroe Islands",[t._F.SJ]:"Svalbard and Jan Mayen",[t._F.GG]:"Guernsey",[t._F.FR]:"France",[t._F.NL]:"Netherlands",[t._F.FI]:"Finland",[t._F.PT]:"Portugal",[t._F.DE]:"Germany",[t._F.MT]:"Malta",[t._F.JE]:"Jersey",[t._F.IS]:"Iceland",[t._F.ES]:"Spain",[t._F.GI]:"Gibraltar",[t._F.NO]:"Norway",[t._F.CY]:"Cyprus",[t._F.RS]:"Serbia",[t._F.LT]:"Lithuania",[t._F.MC]:"Monaco",[t._F.LU]:"Luxembourg",[t._F.UA]:"Ukraine",[t._F.IM]:"Isle of Man",[t._F.RO]:"Romania",[t._F.BE]:"Belgium",[t._F.SE]:"Sweden",[t._F.ME]:"Montenegro",[t._F.LV]:"Latvia",[t._F.VA]:"Vatican City",[t._F.AT]:"Austria",[t._F.AL]:"Albania",[t._F.LI]:"Liechtenstein",[t._F.GR]:"Greece",[t._F.IT]:"Italy",[t._F.AD]:"Andorra",[t._F.GB]:"United Kingdom",[t._F.RU]:"Russia",[t._F.SI]:"Slovenia",[t._F.BY]:"Belarus",[t._F.CH]:"Switzerland",[t._F.HU]:"Hungary",[t._F.BG]:"Bulgaria",[t._F.HR]:"Croatia",[t._F.TC]:"Turks and Caicos Islands",[t._F.CW]:"Cura\xe7ao",[t._F.GP]:"Guadeloupe",[t._F.UM]:"United States Minor Outlying Islands",[t._F.GT]:"Guatemala",[t._F.PM]:"Saint Pierre and Miquelon",[t._F.BQ]:"Caribbean Netherlands",[t._F.GL]:"Greenland",[t._F.SX]:"Sint Maarten",[t._F.PA]:"Panama",[t._F.AW]:"Aruba",[t._F.MQ]:"Martinique",[t._F.AG]:"Antigua and Barbuda",[t._F.BM]:"Bermuda",[t._F.CU]:"Cuba",[t._F.GD]:"Grenada",[t._F.NI]:"Nicaragua",[t._F.LC]:"Saint Lucia",[t._F.KN]:"Saint Kitts and Nevis",[t._F.DO]:"Dominican Republic",[t._F.VC]:"Saint Vincent and the Grenadines",[t._F.BZ]:"Belize",[t._F.HT]:"Haiti",[t._F.JM]:"Jamaica",[t._F.BS]:"Bahamas",[t._F.MX]:"Mexico",[t._F.MF]:"Saint Martin",[t._F.SV]:"El Salvador",[t._F.BL]:"Saint Barth\xe9lemy",[t._F.AI]:"Anguilla",[t._F.MS]:"Montserrat",[t._F.VG]:"British Virgin Islands",[t._F.BB]:"Barbados",[t._F.HN]:"Honduras",[t._F.KY]:"Cayman Islands",[t._F.DM]:"Dominica",[t._F.TT]:"Trinidad and Tobago",[t._F.CR]:"Costa Rica",[t._F.SR]:"Suriname",[t._F.CX]:"Christmas Island",[t._F.WS]:"Samoa",[t._F.PF]:"French Polynesia",[t._F.AS]:"American Samoa",[t._F.NC]:"New Caledonia",[t._F.TK]:"Tokelau",[t._F.PW]:"Palau",[t._F.KI]:"Kiribati",[t._F.VU]:"Vanuatu",[t._F.PN]:"Pitcairn Islands",[t._F.CK]:"Cook Islands",[t._F.FJ]:"Fiji",[t._F.PG]:"Papua New Guinea",[t._F.MP]:"Northern Mariana Islands",[t._F.NU]:"Niue",[t._F.TV]:"Tuvalu",[t._F.NF]:"Norfolk Island",[t._F.TO]:"Tonga",[t._F.FM]:"Micronesia",[t._F.SB]:"Solomon Islands",[t._F.NR]:"Nauru",[t._F.WF]:"Wallis and Futuna",[t._F.GU]:"Guam",[t._F.AU]:"Australia",[t._F.NZ]:"New Zealand",[t._F.MH]:"Marshall Islands",[t._F.CC]:"Cocos (Keeling) Islands",[t._F.VE]:"Venezuela",[t._F.PY]:"Paraguay",[t._F.BR]:"Brazil",[t._F.CO]:"Colombia",[t._F.PE]:"Peru",[t._F.CL]:"Chile",[t._F.UY]:"Uruguay",[t._F.AR]:"Argentina",[t._F.GY]:"Guyana",[t._F.BO]:"Bolivia",[t._F.GF]:"French Guiana",[t._F.EC]:"Ecuador",[t._F.FK]:"Falkland Islands",[t._F.US_AL]:"Alabama",[t._F.US_AK]:"Alaska",[t._F.US_AZ]:"Arizona",[t._F.US_AR]:"Arkansas",[t._F.US_CA]:"California",[t._F.US_CO]:"Colorado",[t._F.US_CT]:"Connecticut",[t._F.US_DE]:"Delaware",[t._F.US_DC]:"District of Columbia (DC)",[t._F.US_FL]:"Florida",[t._F.US_GA]:"Georgia",[t._F.US_HI]:"Hawaii",[t._F.US_ID]:"Idaho",[t._F.US_IL]:"Illinois",[t._F.US_IN]:"Indiana",[t._F.US_IA]:"Iowa",[t._F.US_KS]:"Kansas",[t._F.US_KY]:"Kentucky",[t._F.US_LA]:"Louisiana",[t._F.US_ME]:"Maine",[t._F.US_MD]:"Maryland",[t._F.US_MA]:"Massachusetts",[t._F.US_MI]:"Michigan",[t._F.US_MN]:"Minnesota",[t._F.US_MS]:"Mississippi",[t._F.US_MO]:"Missouri",[t._F.US_MT]:"Montana",[t._F.US_NE]:"Nebraska",[t._F.US_NV]:"Nevada",[t._F.US_NH]:"New Hampshire",[t._F.US_NJ]:"New Jersey",[t._F.US_NM]:"New Mexico",[t._F.US_NY]:"New York",[t._F.US_NC]:"North Carolina",[t._F.US_ND]:"North Dakota",[t._F.US_OH]:"Ohio",[t._F.US_OK]:"Oklahoma",[t._F.US_OR]:"Oregon",[t._F.US_PA]:"Pennsylvania",[t._F.US_PR]:"Puerto Rico",[t._F.US_RI]:"Rhode Island",[t._F.US_SC]:"South Carolina",[t._F.US_SD]:"South Dakota",[t._F.US_TN]:"Tennessee",[t._F.US_TX]:"Texas",[t._F.US_UT]:"Utah",[t._F.US_VA]:"Virginia",[t._F.US_VI]:"United States Virgin Islands",[t._F.US_VT]:"Vermont",[t._F.US_WA]:"Washington",[t._F.US_WV]:"West Virginia",[t._F.US_WI]:"Wisconsin",[t._F.US_WY]:"Wyoming",[t._F.CA_AB]:"Alberta",[t._F.CA_BC]:"British Columbia",[t._F.CA_MB]:"Manitoba",[t._F.CA_NB]:"New Brunswick",[t._F.CA_NL]:"Newfoundland and Labrador",[t._F.CA_NS]:"Nova Scotia",[t._F.CA_ON]:"Ontario",[t._F.CA_PE]:"Prince Edward Island",[t._F.CA_QC]:"Quebec",[t._F.CA_SK]:"Saskatchewan",[t._F.CA_NT]:"Northwest Territories",[t._F.CA_NU]:"Nunavut",[t._F.CA_YT]:"Yukon",[t._F.CA]:"Canada",[t._F.US]:"United States",[t._F.MEXICO_CENTRAL_AMERICA]:"Mexico and Central America",[t._F.CARIBBEAN]:"Caribbean",[t._F.EEA]:"European Economic Area (EEA)",[t._F.NON_EEA]:"Non European Economic Area",[t._F.GLOBAL]:"Global"},s=new Map(Object.entries(i));Object.entries(i).map(a=>({value:a[0],label:a[1]}))},14908:function(a,e,n){"use strict";var t=n(86677),i=n(27378);let s=a=>a.startsWith("#")?a.slice(1):a;e.Z=a=>{let{tabKeys:e,initialTab:n}=a,o=(0,t.useRouter)(),r=o.asPath.split("#")[1]||e[0],[l,_]=(0,i.useState)(r);return(0,i.useEffect)(()=>{n&&e.includes(n)&&_(n)},[n,e,o.isReady]),{activeTab:l,onTabChange:(0,i.useCallback)(async a=>{if(!e.includes(a)){await o.replace({pathname:o.pathname,query:o.query,hash:void 0}),_(e[0]);return}o.isReady&&(await o.replace({pathname:o.pathname,query:o.query,hash:s(a)},void 0,{shallow:!0}),_(a))},[o,e])}}},76904:function(a,e,n){"use strict";n.d(e,{dK:function(){return F},Rv:function(){return m},$P:function(){return c},zj:function(){return v},Kr:function(){return C},q1:function(){return d},QL:function(){return f}});var t=n(24246),i=n(96306),s=n(3124),o=n.n(s);let r=a=>{let{...e}=a;return(0,t.jsx)("svg",{viewBox:"0 0 8 8",focusable:"false",...e,children:(0,t.jsx)("path",{fill:"currentColor",d:"M7.23192 8H8V7.23192V1.85539V1.08731H6.46385V1.85539V5.37654L1.62976 0.544855L1.08731 0L0 1.08731L0.542454 1.62976L5.37654 6.46385H1.85539H1.08731V8H1.85539H7.23192Z"})})},l=a=>{let{...e}=a;return(0,t.jsx)("svg",{viewBox:"0 0 8 8",focusable:"false",...e,children:(0,t.jsx)("path",{fill:"currentColor",d:"M7.23192 0H8V0.768077V6.14461V6.91269H6.46385V6.14461V2.62346L1.62976 7.45515L1.08731 8L0 6.91269L0.542454 6.37024L5.37654 1.53615H1.85539H1.08731V0H1.85539H7.23192Z"})})},_=a=>{let{...e}=a;return(0,t.jsx)("svg",{viewBox:"0 0 9 10",focusable:"false",...e,children:(0,t.jsx)("path",{fill:"currentColor",d:"M0 0.5V5L4.5 9.5L9 5L4.5 0.5H0ZM2.25 2.10714C2.4205 2.10714 2.58401 2.17487 2.70457 2.29543C2.82513 2.41599 2.89286 2.5795 2.89286 2.75C2.89286 2.9205 2.82513 3.08401 2.70457 3.20457C2.58401 3.32513 2.4205 3.39286 2.25 3.39286C2.0795 3.39286 1.91599 3.32513 1.79543 3.20457C1.67487 3.08401 1.60714 2.9205 1.60714 2.75C1.60714 2.5795 1.67487 2.41599 1.79543 2.29543C1.91599 2.17487 2.0795 2.10714 2.25 2.10714Z"})})};var u=n(28278);let F=()=>(0,t.jsx)(l,{style:{color:o().FIDESUI_SUCCESS},className:"size-2","data-testid":"add-icon"}),d=()=>(0,t.jsx)(r,{style:{color:o().FIDESUI_ERROR},className:"size-2","data-testid":"remove-icon"}),c=()=>(0,t.jsx)(_,{style:{color:o().FIDESUI_WARNING},className:"size-3","data-testid":"classify-icon"}),S=a=>{let{color:e,...n}=a;return(0,t.jsx)(i.PJP.fRw,{style:{color:e},className:"size-2",...n})},m=()=>(0,t.jsx)(S,{color:o().FIDESUI_INFO,"data-testid":"change-icon"}),v=()=>(0,t.jsx)(S,{color:o().FIDESUI_SUCCESS,"data-testid":"monitored-icon"}),C=()=>(0,t.jsx)(S,{color:o().FIDESUI_ERROR,"data-testid":"muted-icon"}),f={[u.E.ADDITION]:(0,t.jsx)(F,{}),[u.E.REMOVAL]:(0,t.jsx)(d,{}),[u.E.CLASSIFICATION]:(0,t.jsx)(c,{}),[u.E.CHANGE]:(0,t.jsx)(m,{}),[u.E.MONITORED]:(0,t.jsx)(v,{}),[u.E.MUTED]:(0,t.jsx)(C,{}),[u.E.IN_PROGRESS]:(0,t.jsx)(()=>(0,t.jsx)(S,{color:o().FIDESUI_WARNING,"data-testid":"in-progress-icon"}),{}),[u.E.NONE]:null}},28278:function(a,e,n){"use strict";var t,i;n.d(e,{E:function(){return t}}),(i=t||(t={})).ADDITION="Addition",i.CHANGE="Change",i.REMOVAL="Removal",i.CLASSIFICATION="Classification",i.IN_PROGRESS="Classifying",i.MONITORED="Monitoring",i.MUTED="Unmonitored",i.NONE="--"},24699:function(a,e,n){"use strict";n.r(e),n.d(e,{default:function(){return P}});var t=n(24246),i=n(86677),s=n(35287),o=n(77830),r=n(58754),l=n(96306),_=n(25415),u=n(54682),F=n(30952),d=n(27378),c=n(812),S=n(8125),m=n(46628),v=n(37059),C=n(98145),f=n(9320),h=n(88708),y=n(8411),p=n(26070),A=n(3110),I=n(54762);let M=a=>{let{monitorId:e,system:n,allowIgnore:s,onTabChange:r}=a,[_,{isLoading:u}]=(0,v.rs)(),[F,{isLoading:d}]=(0,v.nP)(),S=(0,i.useRouter)(),C=(0,l.pmc)(),y=u||d,{id:p,name:A,system_key:I,total_updates:M}=n,N=async()=>{let a=await _({monitor_config_key:e,resolved_system_ids:[p]});if((0,c.D4)(a))C((0,m.Vo)((0,c.e$)(a.error)));else{let a="".concat(o.So,"/configure/").concat(I,"#assets");C((0,m.t5)((0,f._)(I?"".concat(M," assets from ").concat(A," have been added to the system inventory."):"".concat(A," and ").concat(M," assets have been added to the system inventory. ").concat(A," is now configured for consent."),I?()=>S.push(a):void 0)))}},g=async()=>{let a=await F({monitor_config_key:e,resolved_system_ids:[p||o.Kl]});(0,c.D4)(a)?C((0,m.Vo)((0,c.e$)(a.error))):C((0,m.t5)((0,f._)(A?"".concat(M," assets from ").concat(A," have been ignored and will not appear in future scans."):"".concat(M," uncategorized assets have been ignored and will not appear in future scans."),async()=>{await r(h.A.IGNORED)})))};return(0,t.jsxs)(l.vyj,{children:[(0,t.jsx)(l.esZ,{title:n.id?void 0:"These assets must be categorized before you can add them to the inventory.",children:(0,t.jsx)(l.wpx,{"data-testid":"add-btn",size:"small",onClick:N,disabled:!n.id||y,loading:u,children:"Add"})}),s&&(0,t.jsx)(l.wpx,{"data-testid":"ignore-btn",size:"small",onClick:g,disabled:y,loading:d,children:"Ignore"})]})};var N=n(79894),g=n.n(N);let{Link:E,Text:x}=l.AntTypography,U=a=>{let{href:e,children:n,...i}=a;return e?(0,t.jsx)(g(),{href:e,passHref:!0,legacyBehavior:!0,children:(0,t.jsx)(E,{strong:!0,ellipsis:!0,onClick:a=>a.stopPropagation(),...i,children:n})}):(0,t.jsx)(x,{strong:!0,ellipsis:!0,...i,children:n})};var b=n(76904);let T=a=>{let{system:e,rowClickUrl:n}=a,i=null==n?void 0:n(e);return(0,t.jsxs)(l.vyj,{className:"max-w-[250px] flex-nowrap",children:[!e.system_key&&(0,t.jsx)(l.esZ,{title:"New system",children:(0,t.jsx)("span",{children:b.QL.Change})}),(0,t.jsx)(U,{href:i,"data-testid":i?"system-name-link":"system-name-text",children:e.name||"Uncategorized assets"}),(0,t.jsx)(I.l,{consentStatus:e.consent_status})]})};var k=n(34929),L=n(2525),j=n(78238),w=a=>{var e,n;let{system:i,columnState:s}=a,{getDataUseDisplayName:o}=(0,k.Z)(),r=(null!==(n=null===(e=i.data_uses)||void 0===e?void 0:e.filter(a=>(0,j.Z)(a)))&&void 0!==n?n:[]).map(a=>({label:o(a),key:a}));return(0,t.jsx)(L.Q,{values:r,columnState:s})};let R=a=>{let{monitorId:e,readonly:n,allowIgnore:i,onTabChange:s,consentStatus:o,rowClickUrl:r}=a,[_,u]=(0,d.useState)(!1),[F,c]=(0,d.useState)(!1),[S,m]=(0,d.useState)(!1),[v,f]=(0,d.useState)(0),[h,N]=(0,d.useState)(0),[g,E]=(0,d.useState)(0);return{columns:(0,d.useMemo)(()=>{let a=[{title:()=>(0,t.jsxs)(l.vyj,{children:[(0,t.jsx)("div",{children:"System"}),(0,t.jsx)(I.l,{consentStatus:o})]}),dataIndex:"name",key:C.vQ.SYSTEM_NAME,fixed:"left",render:(a,e)=>(0,t.jsx)(T,{system:e,rowClickUrl:r})},{title:"Assets",dataIndex:"total_updates",key:C.vQ.TOTAL_UPDATES},{title:"Categories of consent",key:C.vQ.DATA_USE,menu:{items:A.DI,onClick:a=>{a.domEvent.stopPropagation(),"expand-all"===a.key?(m(!0),E(a=>a+1)):"collapse-all"===a.key&&(m(!1),E(a=>a+1))}},render:(a,e)=>(0,t.jsx)(w,{system:e,columnState:{isExpanded:S,version:g}})},{title:"Locations",menu:{items:A.DI,onClick:a=>{a.domEvent.stopPropagation(),"expand-all"===a.key?(u(!0),f(a=>a+1)):"collapse-all"===a.key&&(u(!1),f(a=>a+1))}},dataIndex:"locations",key:C.vQ.LOCATIONS,render:a=>{var e;return(0,t.jsx)(p.Q,{values:null!==(e=null==a?void 0:a.map(a=>{var e;return{label:null!==(e=y.Z8[a])&&void 0!==e?e:a,key:a}}))&&void 0!==e?e:[],columnState:{isExpanded:_,isWrapped:!0,version:v}})}},{title:"Domains",menu:{items:A.DI,onClick:a=>{a.domEvent.stopPropagation(),"expand-all"===a.key?(c(!0),N(a=>a+1)):"collapse-all"===a.key&&(c(!1),N(a=>a+1))}},dataIndex:"domains",key:C.vQ.DOMAINS,render:a=>(0,t.jsx)(p.v,{values:a,valueSuffix:"domains",columnState:{isExpanded:F,version:h}})}];return n||a.push({title:"Actions",key:C.vQ.ACTIONS,fixed:"right",render:(a,n)=>(0,t.jsx)(M,{system:n,monitorId:e,allowIgnore:i,onTabChange:s})}),a},[n,o,r,S,_,F,g,v,h,e,i,s])}},G=a=>{let{monitorId:e}=a,n=(0,i.useRouter)(),s=(0,l.pmc)(),[r,_]=(0,d.useState)(),{filterTabs:F,activeTab:y,onTabChange:p,activeParams:A,actionsDisabled:I}=(0,h.Z)(),M=(0,S.o)({sorting:{validColumns:Object.values(C.vQ)}}),{pageIndex:N,pageSize:g,searchQuery:E,updateSearch:x,resetState:U}=M,{data:b,isLoading:T,isFetching:k}=(0,v.wi)({key:e,page:N,size:g,search:E,...A}),[L,{isLoading:j}]=(0,v.rs)(),[w,{isLoading:G}]=(0,v.nP)(),D=(0,d.useCallback)(a=>{var e,n,t;return null!==(t=null!==(n=null!==(e=a.id)&&void 0!==e?e:a.vendor_id)&&void 0!==n?n:a.name)&&void 0!==t?t:o.Kl},[]),P=(0,d.useCallback)(a=>{var n;return"".concat(o.vi,"/").concat(e,"/").concat(null!==(n=a.id)&&void 0!==n?n:o.Kl).concat(y?"#".concat(y):"")},[e,y]),O=(0,d.useMemo)(()=>({enableSelection:!0,getRowKey:D,isLoading:T,isFetching:k,dataSource:(null==b?void 0:b.items)||[],totalRows:(null==b?void 0:b.total)||0,customTableProps:{locale:{emptyText:(0,t.jsx)(l.oj8,{image:l.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})}}}),[D,T,k,null==b?void 0:b.items,null==b?void 0:b.total]),B=(0,S.V)(M,O),{selectedRows:K,resetSelections:V}=B,H=(0,d.useCallback)(async a=>{_(void 0),await p(a),U(),V()},[p,U,V]),{columns:Z}=R({monitorId:e,onTabChange:H,readonly:I,allowIgnore:!A.diff_status.includes(u.LL.MUTED),consentStatus:r,rowClickUrl:P});(0,d.useEffect)(()=>{if((null==b?void 0:b.items)&&!r){var a;let e=null===(a=b.items.find(a=>{var e;return(null===(e=a.consent_status)||void 0===e?void 0:e.status)===u.pF.ALERT}))||void 0===a?void 0:a.consent_status;_(null!=e?e:void 0)}},[b,r]);let z=(0,d.useCallback)(async()=>{let a=K.reduce((a,e)=>a+e.total_updates,0),t=await L({monitor_config_key:e,resolved_system_ids:K.map(a=>a.id)});(0,c.D4)(t)?s((0,m.Vo)((0,c.e$)(t.error))):(s((0,m.t5)((0,f._)("".concat(a," assets have been added to the system inventory."),()=>n.push(o.So)))),V())},[K,L,e,s,n,V]),W=(0,d.useCallback)(async()=>{let a=K.reduce((a,e)=>a+e.total_updates,0),n=await w({monitor_config_key:e,resolved_system_ids:K.map(a=>{var e;return null!==(e=a.id)&&void 0!==e?e:o.Kl})});(0,c.D4)(n)?s((0,m.Vo)((0,c.e$)(n.error))):(s((0,m.t5)((0,f._)("".concat(a," assets have been ignored and will not appear in future scans."),async()=>{await p(h.A.IGNORED)}))),V())},[K,w,e,s,p,V]),Q=K.some(a=>null===a.id);return{columns:Z,data:b,isLoading:T,isFetching:k,searchQuery:E,updateSearch:x,resetState:U,tableProps:B.tableProps,selectionProps:B.selectionProps,filterTabs:F,activeTab:y,handleTabChange:H,activeParams:A,actionsDisabled:I,selectedRows:K,hasSelectedRows:B.hasSelectedRows,resetSelections:V,uncategorizedIsSelected:Q,handleBulkAdd:z,handleBulkIgnore:W,anyBulkActionIsLoading:j||G,isAddingResults:j,isIgnoringResults:G}},D=a=>{let{monitorId:e}=a,{columns:n,searchQuery:i,updateSearch:s,tableProps:o,selectionProps:r,filterTabs:d,activeTab:c,handleTabChange:S,activeParams:m,selectedRows:v,hasSelectedRows:C,uncategorizedIsSelected:f,handleBulkAdd:h,handleBulkIgnore:y,anyBulkActionIsLoading:p}=G({monitorId:e});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Niu,{"aria-label":"Asset state filter",mode:"horizontal",items:d.map(a=>({key:a.hash,label:a.label})),selectedKeys:[c],onClick:async a=>{await S(a.key)},className:"mb-4","data-testid":"asset-state-filter"}),(0,t.jsxs)(l.jqI,{justify:"space-between",align:"center",className:"mb-4",children:[(0,t.jsx)(F.f,{value:i,onChange:s}),(0,t.jsxs)(l.vyj,{size:"large",children:[C&&(0,t.jsx)(_.a,{count:v.length}),(0,t.jsx)(l.S0p,{menu:{items:[{key:"add",label:(0,t.jsx)(l.esZ,{title:f?"Uncategorized assets can't be added to the inventory":null,placement:"left",children:"Add"}),onClick:h,disabled:f},m.diff_status.includes(u.LL.MUTED)?null:{key:"ignore",label:"Ignore",onClick:y}]},trigger:["click"],children:(0,t.jsx)(l.wpx,{type:"primary",icon:(0,t.jsx)(l.PJP._ME,{}),iconPosition:"end",loading:p,disabled:!C,"data-testid":"bulk-actions-menu",children:"Actions"})})]})]}),(0,t.jsx)(l.V5H,{...o,columns:n,rowSelection:r})]})};var P=()=>{let a=decodeURIComponent((0,i.useRouter)().query.monitorId);return(0,t.jsxs)(s.Z,{title:"Action center - Discovered assets by system",children:[(0,t.jsx)(r.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:o.vi},{title:a}]}),(0,t.jsx)(D,{monitorId:a})]})}},99830:function(a){a.exports={toastLink:"ToastLink_toastLink__OLSeq"}}},function(a){a.O(0,[431,8765,9278,5163,4164,3847,2888,9774,179],function(){return a(a.s=86850)}),_N_E=a.O()}]);