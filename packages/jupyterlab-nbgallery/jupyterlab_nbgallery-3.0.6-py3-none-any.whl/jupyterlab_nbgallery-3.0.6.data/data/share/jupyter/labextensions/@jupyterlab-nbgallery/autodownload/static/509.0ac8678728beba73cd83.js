"use strict";(self.webpackChunk_jupyterlab_nbgallery_autodownload=self.webpackChunk_jupyterlab_nbgallery_autodownload||[]).push([[509],{509:(e,o,n)=>{n.r(o),n.d(o,{default:()=>c});var t=n(10),a=n(397),r=n(76),l=n.n(r);const c={id:"@jupyterlab-nbgallery/autodownload",autoStart:!0,requires:[t.ISettingRegistry],activate:async(e,o)=>{let n="",t=0,r=!1;function c(){return a.PageConfig.getBaseUrl()}function s(e,o,n){l().ajax({method:"GET",headers:{Accept:"application/json"},url:e,cache:!1,xhrFields:{withCredentials:!0},success:function(e){!async function(e,o,n){l().ajax({url:c()+"post/"+e+"/"+encodeURIComponent(o)+".ipynb",type:"POST",success:function(){},error:function(e){console.error("Failed upload: "+o)},data:JSON.stringify({type:"notebook",content:JSON.parse(n)})})}(o,n,e)}})}function i(e,o,n){l().ajax({method:"GET",url:c()+"api/contents/"+encodeURIComponent(e),cache:!1,xhrFields:{withCredentials:!0},success:function(e){},error:function(t){console.info("Downloading notebooks to "+e),l().ajax({method:"POST",url:c()+"post/"+encodeURIComponent(e),data:JSON.stringify({type:"directory"}),cache:!1,success:function(t){l().ajax({method:"GET",headers:{Accept:"application/json"},url:o+n,cache:!1,xhrFields:{withCredentials:!0},success:function(n){let t;for(t in n){var a=n[t];s(o+"/notebooks/"+a.uuid+"/download?clickstream=false",e,a.title.replace(/\//g,"⁄"))}}})}})}})}Promise.all([e.restored,o.load("@jupyterlab-nbgallery/autodownload:autodownload"),o.load("@jupyterlab-nbgallery/environment-registration:environment-registration")]).then(([,e,o])=>{try{!function(e,o){n=o.get("nbgallery_url").composite,l().ajax({method:"GET",headers:{Accept:"application/json"},url:c()+"jupyterlab_nbgallery/environment",cache:!1,xhrFields:{withCredentials:!0},success:function(o){0==n.length&&(n=o.NBGALLERY_URL),t=o.NBGALLERY_ENABLE_AUTODOWNLOAD,r=e.get("enabled").composite,console.info("Auto Downloading Notebooks"),(1==t||r&&n.length>0)&&(i("Starred",n,"/notebooks/stars"),i("Recently Executed",n,"/notebooks/recently_executed"))}})}(e,o)}catch(e){console.error(`Problem downloading notebooks \n ${e}`)}})}}}}]);