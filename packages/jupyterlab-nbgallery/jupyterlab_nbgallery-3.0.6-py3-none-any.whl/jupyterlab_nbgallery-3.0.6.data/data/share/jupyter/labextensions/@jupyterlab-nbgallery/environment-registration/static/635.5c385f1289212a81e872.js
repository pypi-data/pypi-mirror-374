"use strict";(self.webpackChunk_jupyterlab_nbgallery_environment_registration=self.webpackChunk_jupyterlab_nbgallery_environment_registration||[]).push([[635],{635:(e,n,t)=>{t.r(n),t.d(n,{default:()=>s});var r=t(10),o=t(397),a=t(566),i=t(76),l=t.n(i);const s={id:"@jupyterlab-nbgallery/environment-registration",autoStart:!0,requires:[r.ISettingRegistry],activate:async(e,n)=>{let t=!1,r="",i="",s="",g="";try{const e=await async function(e="",n={}){const t=a.ServerConnection.makeSettings(),r=o.URLExt.join(t.baseUrl,"jupyterlab_nbgallery",e);let i;try{i=await a.ServerConnection.makeRequest(r,n,t)}catch(e){throw new a.ServerConnection.NetworkError(e)}const l=await i.json();if(!i.ok)throw new a.ServerConnection.ResponseError(i,l.message);return l}("environment");s=e.NBGALLERY_URL,g=e.NBGALLERY_CLIENT_NAME}catch(e){console.error(`ERROR on get /jupyter_nbgallery/environment.\n ${e}`)}Promise.all([e.restored,n.load("@jupyterlab-nbgallery/environment-registration:environment-registration")]).then(([,e])=>{!function(e){r=e.get("nbgallery_url").composite,(!r||0==r.length)&&s&&s.length>0&&(r=s,e.set("nbgallery_url",r)),i=e.get("nbgallery_client_name").composite,(!i||0==i.length)&&g&&g.length>0&&(i=g,e.set("nbgallery_client_name",i)),t=e.get("registered").composite;let n="lab";""!=o.PageConfig.getOption("notebookPage")&&(n="notebook"),!t&&r&&r.length>0&&l().ajax({method:"POST",headers:{Accept:"application/json"},url:o.URLExt.join(r,"environments").toString(),data:{name:i,url:o.PageConfig.getBaseUrl(),user_interface:n},xhrFields:{withCredentials:!0},success:function(n){e.set("registered",!0),console.log("Environment Registered to NBGallery")}})}(e)})}}}}]);