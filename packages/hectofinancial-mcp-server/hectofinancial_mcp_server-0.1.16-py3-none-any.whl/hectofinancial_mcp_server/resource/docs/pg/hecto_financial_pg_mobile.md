# 20\. 휴대폰 결제 (UI)

## 20.1 요청 전문 (가맹점 → 헥토파이낸셜)

가맹점 서버에서 헥토파이낸셜측으로 요청하는 컬럼을 다음과 같이 정의합니다.

     
| 파라미터 | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- |
| mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 고유 상점아이디  <br>※ 테스트용 상점 아이디  <br>nxhp\_sb\_il:일반  <br>nxhp\_sb\_hd:인증/승인분리형(하이브리드)  <br>nxhp\_sb\_ma:월자동결제 | AN(10) | ●   | "nxhp\_sb\_il" |
| method | 결제수단 | PG 서비스에 해당하는 결제 구분 코드 | AN(20) | ●   | “mobile”  <br>※ 고정값 |
| trdDt | 요청일자 | yyyyMMdd | N(8) | ●   | "20211231" |
| trdTm | 요청시간 | HH24MISS | N(6) | ●   | "100000" |
| mchtTrdNo | 상점주문번호 | 상점에서 생성하는 고유 주문번호  <br>※ 한글 제외 | AN(100) | ●   | "ORDER20211231100000" |
| mchtName | 상점한글명 | 상점한글명 | AHN(100) | ●   | "헥토파이낸셜" |
| mchtEName | 상점영문명 | 상점영문명 | AN(100) | ●   | "Hecto Financial" |
| pmtPrdtNm | 상품명 | 결제상품명 | AHN(128) | ●   | "테스트상품" |
| trdAmt | 거래금액 | 거래금액  <br>※ AES 암호화 | N(12) | ●   | "1000" |
| mchtCustNm | 고객명 | 고객명  <br>※ AES 암호화 | AHN(30) | ○   | "홍길동" |
| notiUrl | 결과처리 URL | 결제 후 결과 전달되는 페이지의 URL(Server To Server 연동 URL)  <br>※ 휴대폰 하이브리드 연동의 경우 전달 X | AN(250) | ●   | "https://example.com/notiUrl" |
| nextUrl | 결과화면 URL | 결제 후 결과 전달 및 이동페이지 URL | AN(250) | ●   | "https://example.com/nextUrl" |
| cancUrl | 결제취소 URL | 고객 강제 종료시 결과 전달 및 이동페이지 URL | AN(250) | ●   | "https://example.com/cancUrl" |
| mchtParam | 상점예약필드 | 기타 주문 정보를 입력하는 상점 예약 필드 | AHN(4000) | ○   | "name=HongGilDong&age=25" |
| cphoneNo | 휴대폰번호 | 010xxxxyyyy(하이픈 제거)  <br>※ AES 암호화 | N(11) | ○   | "01012345678" |
| email | 이메일 | 이메일 주소  <br>※ AES 암호화 | AN(60) | ○   | "HongGilDong@example.com" |
| prdtTerm | 상품제공기간 | yyyyMMddHHmmss  <br>값이 없으면 일반결제로 표기 | N(14) | ○   | "20221231235959" |
| telecomCd | 통신사 | SKT:SK Telecom ,  <br>KTF:KT,  <br>LGT:LG U+,  <br>CJH:CJ헬로모바일,  <br>KCT:한국케이블텔레콤,  <br>SKL:SK 7Mobile  <br>  <br>※주의 사항  <br>입력한 통신사만 화면에 노출됩니다.  <br>"\|"를 구분자로 사용하여 통신사 다중 입력 가능  <br>ex) "SKT\|KTF\|LGT", "SKT" | AN(23) | ○   | "SKT\|KTF\|LGT" |
| mchtCustId | 상점고객아이디 | 상점에서 보내주는 고유 고객아이디 혹은 유니크키  <br>※ AES 암호화 | AN(50) | ○   | "HongGilDong" |
| taxTypeCd | 면세여부 | N:과세, Y:면세, G:복합과세  <br>공백일 경우 상점 설정에 따름 | A(1) | ○   | "N" |
| taxAmt | 과세금액 | 과세금액(복합과세 경우에만 요청)  <br>※ AES 암호화 | N(12) | ○   | "909" |
| vatAmt | 부가세금액 | 부가세금액(복합과세 경우에만 요청)  <br>※ AES 암호화 | N(12) | ○   | "91" |
| taxFreeAmt | 비과세금액 | 면세금액(복합과세 경우에만 요청)  <br>※ AES 암호화 | N(12) | ○   | "0" |
| autoPayType | 자동결제 타입 | ※ 공백:일반결제, M:월자동 결제 | A(1) | ○   | ""  |
| linkMethod | 연동 방식 | ※ 공백 or STD : 표준결제창  <br>HBRD:하이브리드(인증, 승인 분리 방식) | AN(12) | ○   | "STD" |
| custIp | 고객 IP주소 | 상점 서버의 IP가 아닌, 고객 기기의 IP주소 | AN(15) | ○   | "127.0.0.1" |
| pktHash | hash데이터 | SHA256 방식으로 생성한 해쉬값  <br>\[[요청 전문 해쉬 코드](#item-465)\] 참고 | AN(200) | ●   | "f395b6725a9a18f2563ce34f8bc76698051d27c05e5ba815f463f00429061c0c" |

## 20.2 요청 전문 해쉬 코드

 
| 항목  | 조합 필드 |
| --- | --- |
| pktHash | 상점아이디 + 결제수단 + 상점주문번호 + 요청일자 + 요청시간 + 거래금액(평문) + 해쉬키 |

## 20.3 응답 전문 (헥토파이낸셜 → 가맹점)

휴대폰 결제창에서 가맹점측으로 응답하는 컬럼을 다음과 같이 정의 합니다.

     
| 파라미터 | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- |
| mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 고유 상점아이디  <br>※ 테스트용 상점 아이디  <br>nxhp\_sb\_il:일반  <br>nxhp\_sb\_hd:인증/승인분리형(하이브리드)  <br>nxhp\_sb\_ma:월자동결제 | AN(10) | ●   | "nxhp\_sb\_il" |
| outStatCd | 거래상태 | 거래상태코드(성공/실패)  <br>0021:성공  <br>0061:인증 성공(하이브리드 방식)  <br>0031:실패 | AN(4) | ●   | "0021" |
| outRsltCd | 거절코드 | 거래상태가 "0031"일 경우, 상세 코드 전달  <br>\[[거절 코드 표](#item-544)\] 참고 | AN(4) | ●   | "0000" |
| outRsltMsg | 결과메세지 | 결과 메세지 전달  <br>URL Encoding, UTF-8 | AHN(200) | ●   | "결제 요청 정보 누락 (상품명)" |
| method | 결제수단 | PG 서비스에 해당하는 결제 구분 코드 | AN(20) | ●   | "mobile"  <br>※ 고정값 |
| mchtTrdNo | 상점주문번호 | 상점에서 생성하는 고유 주문번호  <br>※ 한글 제외 | AN(100) | ●   | "ORDER20211231100000" |
| mchtCustId | 상점고객아이디 | 보내주는 고유 고객아이디 혹은 유니크 키  <br>※ AES 암호화 | AN(50) | ○   | "HongGilDong" |
| trdNo | 거래번호 | 헥토파이낸셜 거래번호 | AN(40) | ●   | "STFP\_PGVAnxhp\_sb\_il00210806075210M1853381" |
| trdAmt | 거래금액 | 거래금액  <br>※ AES 암호화 | N(12) | ●   | "1000" |
| mchtParam | 상점예약필드 | 요청으로 받은 필드값을 응답으로 Bypass | AHN(4000) | ○   | "name=HongGilDong&age=25" |
| billKey | 자동결제키  <br>(대문자'K') | 월 자동 결제 키. 2회차 결제시 사용  <br>※빌키 이용 상점만 해당 | AN(50) | ○   | "MO0123456789" |
| authDt | 승인일시 | 승인일시 | N(14) | ○   | "20211231100000" |
| fnNm | 이통사명 | 이통사명 | A(50) | ○   | "SKT" |
| fnCd | 이통사코드 | 이통사코드 | N(3) | ○   | "001" |

## 20.4 노티 전문 (헥토파이낸셜 → 가맹점)

거래가 정상적으로 완료되면, 헥토파이낸셜에서 가맹점으로 노티(결과통보) 메세지가 전송됩니다.

     
| 파라미터 | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- |
| outStatCd | 거래상태 | 성공\[0021\] | N(4) | ●   | "0021" |
| trdNo | 거래번호 | 헥토파이낸셜에서 부여하는 고유 거래번호 | AN(40) | ●   | "STFP\_PGVAnxhp\_sb\_il00210806075210M1853381" |
| method | 결제수단 | 휴대폰결제\[MP\] | A(2) | ●   | "MP" |
| bizType | 업무구분 | 결제\[B0\], 취소\[C0\], 자동연장\[B1\], 헥토파이낸셜 원천 결제\[B2\], 환불\[C1\] | AN(2) | ●   | "B0" |
| mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 상점아이디 | AN(12) | ●   | "nxhp\_sb\_il" |
| mchtTrdNo | 상점주문번호 | 상점에서 생성하는 고유주문번호 | AN(100) | ●   | "ORDER20211231100000" |
| mchtCustNm | 고객명 | 실제 결제자의 주문자명 | AHN(30) | ○   | "홍길동" |
| mchtName | 상점한글명 | 실판매자명, 거래요청시 실판매자명이 없는 경우 헥토파이낸셜와 계약된 상점명 | AHN(20) | ○   | "헥토파이낸셜" |
| pmtprdNm | 상품명 | 고객이 주문한 결제 상품명 | AHN(128) | ○   | "테스트상품" |
| trdDtm | 거래일시 | 승인일시, 취소/부분취소거래 : 취소일시가 전달됩니다.  <br>형식:YYYYMMDDhhmmss | N(14) | ●   | "20211231010101" |
| trdAmt | 거래금액 | 거래금액 | N(12) | ○   | "1000" |
| billKey | 자동결제키 | 자동결제 2회차를 위한 billKey발급 | AN(40) | ○   | "MO0123456789" |
| billKeyExpireDt | 자동결제키 유효기간 | YYMM | N(4) | ○   | "1231" |
| telecomCd | 이통사코드 | SKT:SK Telecom,  <br>KTF:KT,  <br>LGT:LG U+,  <br>CJH:CJ헬로모바일,  <br>KCT:한국케이블텔레콤,  <br>SKL:SK 7Mobile | A(10) | ○   | "SKT" |
| telecomNm | 이통사명 | 이통사 명 | AHN(10) | ○   | "SK Telecom" |
| email | 고객이메일 | 상점고객이메일 | AN(60) | ○   | "HongGilDong@example.com" |
| mchtCustId | 상점고객아이디 | 상점고객아이디 | AN(50) | ○   | "HongGilDong" |
| phoneNoEnc | 휴대폰번호(암호화) | 고객의 휴대폰번호를 암호화하여 전달  <br>※ AES 암호화 | N(11) | ○   | "01012345678" |
| orgTrdNo | 원거래번호 | 취소 시, 원거래번호 | AN(40) | ○   | "STFP\_PGVAnxhp\_sb\_il00210806075210M1853381" |
| orgTrdDt | 원거래일자 | 취소 시, 원거래일자 | N(8) | ○   | "20211231" |
| cnclType | 취소거래타입 | 00:전체취소, 10:부분취소 | N(2) | ○   | "00" |
| mchtParam | 상점예약필드 | 상점에서 이용하는 추가 정보 필드로 전달한 값이 그대로 반환됩니다. | AHN(4000) | ○   | "name=HongGilDong&age=25" |
| pktHash | 해쉬값 | SHA256 (거래상태코드+거래일자+거래시간+상점아이디+상점주문번호+거래금액+해쉬키) | AN(64) | ●   | "a2d6d597d55d7c9b689baa2e08c1ddf0ce71f4248c5b9b59fe61bfbf949543e1" |

가맹점에서 헥토파이낸셜로 응답을 전송합니다.

 
| 응답 (가맹점 → 헥토파이낸셜) |     |
| --- | --- |
| 성공시 | "OK" (대문자) |
| 실패시 | "FAIL" (대문자, FAIL로 응답시 명확한 실패로 인식합니다. 노티가 재전송 됩니다.) |
| 그 외 | 비정상 실패로 인식하여, 설정된 횟수만큼 노티 재발송 처리함. |

# 21\. 휴대폰승인API(하이브리드)

## 21.1 API URI

 
| 구분  | URL |
| --- | --- |
| 테스트베드 | https://tbgw.settlebank.co.kr/spay/APIService.do |
| 상용 환경 | https://gw.settlebank.co.kr/spay/APIService.do |

## 21.2 요청 및 응답 헤더

휴대폰 승인(하이브리드 방식) API는 Non-UI 방식으로 표준결제창을 이용하지 않습니다. ([JSON 요청 데이터](#item-584) 예시)항목을 참고 하십시오.

 
| 구분  | 내용  |
| --- | --- |
| 요청  | Content-type=application/json; charset=UTF-8 |
| 응답  | Content-type=application/json; charset=UTF-8 |

## 21.3 요청 전문 (가맹점 → 헥토파이낸셜)

가맹점 서버에서 헥토파이낸셜측으로 요청하는 컬럼을 다음과 같이 정의합니다.

      
| 파라미터 |     | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- | --- |
| params | mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 고유 상점아이디 | AN(10) | ●   | "nxhp\_sb\_hd" |
| ver | 버전  | 전문의 버전 | AN(4) | ●   | "0A19"  <br>※ 고정값 |
| method | 결제수단 | 결제수단 | A(2) | ●   | "MP"  <br>※ 고정값 |
| bizType | 업무구분 | 업무 구분코드  <br>B0: 페이레터 재판매 승인,  <br>B2: 헥토파이낸셜 원천 승인 | AN(2) | ●   | "B2" |
| encCd | 암호화 구분 | 암호화 구분 코드 | N(2) | ●   | "23"  <br>※ 고정값 |
| mchtTrdNo | 상점주문번호 | ※ 주의  <br>반드시 인증요청시에 생성한 상점주문번호를 기재해야 합니다. | AN(100) | ●   | "ORDER20211231100000" |
| trdDt | 요청일자 | 현재 전문을 전송하는 일자(YYYYMMDD) | N(8) | ●   | "20211231" |
| trdTm | 요청시간 | 현재 전문을 전송하는 시간(HHMMSS) | N(6) | ●   | "100000" |
| mobileYn | 모바일 여부 | Y:모바일웹/앱, N:PC 또는 그 외 | A(1) | ○   | "N" |
| osType | OS 구분 | A:Android, I:IOS, W:windows, M:Mac, E:기타, 공백:확인불가 | A(1) | ○   | "W" |
| data | pktHash | hash데이터 | SHA256 방식으로 생성한 해쉬값  <br>\[[요청 전문 해쉬 코드](#item-1035)\] 참고 | AN(200) | ●   | "f395b6725a9a18f2563ce34f8bc76698051d27c05e5ba815f463f00429061c0c" |
| phoneNo | 휴대폰번호 | 고객 휴대폰 번호  <br>※ AES 암호화 | N(11) | ○   | "01012345678" |
| telCo | 통신사 | SKT:SK Telecom ,  <br>KTF:KT,  <br>LGT:LG U+,  <br>CJH:CJ헬로모바일,  <br>KCT:한국케이블텔레콤,  <br>SKL:SK 7Mobile  <br>※ AES 암호화 | A(3) | ○   | "SKT" |
| email | 이메일 | 고개 이메일 주소 | AN(60) | ○   | "HongGilDong@example.com" |
| mUserId | 상점고객아이디 | 상점고객아이디 | AHN(50) | ○   | "HongGilDong" |
| crcCd | 통화구분 | 통화구분 | A(3) | ●   | "KRW"  <br>※ 고정값 |
| trdAmt | 거래금액 | ※ AES 암호화 | N(12) | ●   | "1000" |
| prdtNm | 상품명 | 상품명 | AHN(128) | ●   | "드시모네" |
| sellerNm | 판매자명 | 판매자명 | AHN(128) | ○   | "헥토파이낸셜" |
| ordNm | 주문자명 | 주문자명 | AHN(30) | ○   | "홍길동" |
| getBillKeyYn | 빌키발급여부 | Y:빌키발급,  <br>그외:빌키미발급 | A(1) | ○   | ""  |
| authTrdNo | 인증거래번호 | ※ 인증 성공 시, 헥토파이낸셜에서 응답한 거래번호 | AN(40) | ●   | "SOFP\_PGMPnxhp\_pl\_hd0211021111808M1234567" |
| linkMethod | 연동방식코드 | 연동 방식 코드 | AN(12) | ●   | "HBRD"  <br>※ 고정값 |
| notiUrl | 결과처리 URL | 결제 후 결과 전달되는 페이지의 URL(Server To Server 연동 URL) | AN(250) | ○   | "https://example.com/notiUrl" |
| mchtParam | 상점예약필드 | 기타 주문 정보를 입력하는 상점 예약 필드 | AHN(4000) | ○   | "name=HongGilDong&age=25" |

## 21.4 요청 전문 해쉬 코드

 
| 항목  | 조합 필드 |
| --- | --- |
| pktHash | 거래일자+거래시간+상점아이디+상점주문번호+거래금액(평문)+해쉬키 |

## 21.5 응답 전문 (헥토파이낸셜 → 가맹점)

헥토파이낸셜에서 가맹점측으로 응답하는 컬럼을 다음과 같이 정의합니다.

      
| 파라미터 |     | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- | --- |
| params | mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 고유 상점아이디 | AN(10) | ●   | "nxhp\_pl\_hd" |
| ver | 버전  | 전문의 버전 | AN(4) | ●   | "0A19"  <br>※ 고정값 |
| method | 결제수단 | 결제수단 | A(2) | ●   | "MP"  <br>※ 고정값 |
| bizType | 업무구분 | 업무 구분코드 | AN(2) | ●   | "B0"  <br>※ 고정값 |
| encCd | 암호화 구분 | 암호화 구분 코드 | N(2) | ●   | "23"  <br>※ 고정값 |
| mchtTrdNo | 상점주문번호 | 상점에서 생성하는 고유한 주문번호 | AN(100) | ●   | "ORDER20211231100000" |
| trdNo | 헥토파이낸셜 거래번호 | 헥토파이낸셜에서 생성하는 고유한 거래번호 | AN(40) | ●   | "STFP\_PGCAnxca\_jt\_il0211129135810M1494620" |
| trdDt | 요청일자 | 현재 전문을 전송하는 일자(YYYYMMDD) | N(8) | ●   | "20211231" |
| trdTm | 요청시간 | 현재 전문을 전송하는 시간(HHMMSS) | N(6) | ●   | "100000" |
| outStatCd | 거래상태 | 거래상태코드(성공/실패)  <br>0021:성공  <br>0031:실패 | AN(4) | ●   | "0021" |
| outRsltCd | 거절코드 | 거래상태가 "0031"일 경우, 상세 코드 전달  <br>\[[거절 코드 표](#item-544)\] 참고 | AN(4) | ●   | "0000" |
| outRsltMsg | 결과메세지 | 결과 메세지 전달  <br>URL Encoding, UTF-8 | AHN(200) | ●   | "정상적으로 처리되었습니다." |
| data | pktHash | 해쉬값 | 요청시, hash 값 그대로 return | AN(64) | ●   |     |
| phoneNo | 휴대폰번호 | 고객의 휴대폰번호  <br>※ AES 암호화 | N(11) | ○   | "01012341234" |
| telCo | 통신사 | 요청 시, 값 그대로 return  <br>※ AES 암호화 | A(3) | ○   | "SKT" |
| trdAmt | 거래금액 | 요청 시, 값 그대로 return  <br>※ AES 암호화 | N(12) | ●   | "1000" |
| getBillKeyYn | 빌키발급여부 | Y:빌키발급,  <br>그외:빌키미발급 | A(1) | ○   | ""  |
| billKey | 빌키  | 헥토파이낸셜에서 발급하는 빌키, 2회차부터 사용 | AN(50) | ○   | "MO0123456789" |

## 21.6 노티 전문 (헥토파이낸셜 → 가맹점)

※ \[[20.4 노티 전문](#item-718)\] 참고

# 22\. 휴대폰 자동결제 (Non-UI)

## 22.1 요약 설명

*    **월자동 결제**
    *   휴대폰 자동결제는 1회차 결제 승인 이후, 발급된 인증키(billKey)로 다음 회차에 다시 결제하는 방식의 서비스입니다.
    *   1회차 결제시([19.1 요청 전문 참고](#item-464)) `autoPayType` 요청 파라미터에 "M"을 설정하면, 헥토파이낸셜에서 응답으로 `billKey` 파라미터를 리턴합니다.
    *   2회차 결제시, 발급 받은 `billKey`를 요청파라미터에 세팅하여 결제 요청합니다.
    *   2회차 결제시의 거래금액과 상품명은 1회차 결제와 동일해야 합니다.

## 22.2 API URI

 
| 구분  | URL |
| --- | --- |
| 테스트베드 | https://tbgw.settlebank.co.kr/spay/APIService.do |
| 상용 환경 | https://gw.settlebank.co.kr/spay/APIService.do |

## 22.3 요청 및 응답 헤더

휴대폰 자동결제는 Non-UI 방식으로 표준결제창을 이용하지 않습니다. ([JSON 요청 데이터](#item-584) 예시)항목을 참고 하십시오.

 
| 구분  | 내용  |
| --- | --- |
| 요청  | Content-type=application/json; charset=UTF-8 |
| 응답  | Content-type=application/json; charset=UTF-8 |

## 22.4 월자동 요청 전문 (가맹점 → 헥토파이낸셜)

가맹점 서버에서 헥토파이낸셜측으로 요청하는 컬럼을 다음과 같이 정의합니다.

      
| 파라미터 |     | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- | --- |
| params | mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 고유 상점아이디 | AN(10) | ●   | "nxhp\_pl\_ma" |
| ver | 버전  | 전문의 버전 | AN(4) | ●   | "0A19"  <br>※ 고정값 |
| method | 결제수단 | 결제수단 | A(2) | ●   | "MP"  <br>※ 고정값 |
| bizType | 업무구분 | 업무 구분코드 | AN(2) | ●   | "B1"  <br>※ 고정값 |
| encCd | 암호화 구분 | 암호화 구분 코드 | N(2) | ●   | "23"  <br>※ 고정값 |
| mchtTrdNo | 상점주문번호 | 상점에서 생성하는 고유한 주문번호 | AN(100) | ●   | "ORDER20211231100000" |
| trdDt | 요청일자 | 현재 전문을 전송하는 일자(YYYYMMDD) | N(8) | ●   | "20211231" |
| trdTm | 요청시간 | 현재 전문을 전송하는 시간(HHMMSS) | N(6) | ●   | "100000" |
| mobileYn | 모바일 여부 | Y:모바일웹/앱, N:PC 또는 그 외 | A(1) | ○   | "N" |
| osType | OS 구분 | A:Android, I:IOS, W:windows, M:Mac, E:기타, 공백:확인불가 | A(1) | ○   | "W" |
| data | pktHash | hash데이터 | SHA256 방식으로 생성한 해쉬값  <br>\[[요청 전문 해쉬 코드](#item-654)\] 참고 | AN(200) | ●   | "f395b6725a9a18f2563ce34f8bc76698051d27c05e5ba815f463f00429061c0c" |
| email | 이메일 | 고개 이메일 주소 | AN(60) | ●   | "HongGilDong@example.com" |
| mUserId | 상점고객아이디 | 상점고객아이디 | AHN(50) | ●   | "HongGilDong" |
| crcCd | 통화구분 | 통화구분 | A(3) | ●   | "KRW"  <br>※ 고정값 |
| trdAmt | 거래금액 | ※ AES 암호화 | N(12) | ●   | "1000" |
| prdtNm | 상품명 | 상품명 | AHN(128) | ●   | "드시모네" |
| sellerNm | 판매자명 | 판매자명 | AHN(50) | ○   | "헥토파이낸셜" |
| ordNm | 주문자명 | 주문자명 | AHN(50) | ●   | "홍길동" |
| billKey | 빌키  | 헥토파이낸셜에서 발급한 빌키 | AN(50) | ●   | "MO0123456789" |

## 22.5 요청 전문 해쉬 코드

 
| 항목  | 조합 필드 |
| --- | --- |
| pktHash | 거래일자+거래시간+상점아이디+상점주문번호+거래금액(평문)+해쉬키 |

## 22.6 월자동 응답 전문 (헥토파이낸셜 → 가맹점)

헥토파이낸셜에서 가맹점측으로 응답하는 컬럼을 다음과 같이 정의합니다.

      
| 파라미터 |     | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- | --- |
| params | mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 고유 상점아이디 | AN(10) | ●   | "nxhp\_pl\_ma" |
| ver | 버전  | 전문의 버전 | AN(4) | ●   | "0A19"  <br>※ 고정값 |
| method | 결제수단 | 결제수단 | A(2) | ●   | "MP"  <br>※ 고정값 |
| bizType | 업무구분 | 업무 구분코드 | AN(2) | ●   | "B1"  <br>※ 고정값 |
| encCd | 암호화 구분 | 암호화 구분 코드 | N(2) | ●   | "23"  <br>※ 고정값 |
| mchtTrdNo | 상점주문번호 | 상점에서 생성하는 고유한 거래번호 | AN(100) | ●   | "ORDER20211231100000" |
| trdNo | 헥토파이낸셜 거래번호 | 헥토파이낸셜에서 생성하는 고유한 거래번호 | AN(40) | ●   | "STFP\_PGCAnxca\_jt\_il0211129135810M1494620" |
| trdDt | 요청일자 | 현재 전문을 전송하는 일자(YYYYMMDD) | N(8) | ●   | "20211231" |
| trdTm | 요청시간 | 현재 전문을 전송하는 시간(HHMMSS) | N(6) | ●   | "100000" |
| outStatCd | 거래상태 | 거래상태코드(성공/실패)  <br>0021:성공  <br>0031:실패 | AN(4) | ●   | "0021" |
| outRsltCd | 거절코드 | 거래상태가 "0031"일 경우, 상세 코드 전달  <br>\[[거절 코드 표](#item-544)\] 참고 | AN(4) | ●   | "0000" |
| outRsltMsg | 결과메세지 | 결과 메세지 전달  <br>URL Encoding, UTF-8 | AHN(200) | ●   | "정상적으로 처리되었습니다." |
| data | pktHash | 해쉬값 | 요청시, hash 값 그대로 return | AN(64) | ●   |     |
| telCo | 통신사 | 요청 시, 값 그대로 return  <br>※ AES 암호화 | A(3) | ○   | "SKT" |
| trdAmt | 거래금액 | 요청 시, 값 그대로 return  <br>※ AES 암호화 | N(12) | ●   | "1000" |
| billKey | 빌키  | 요청 시, 값 그대로 return | AN(50) | ●   | "MO0123456789" |

# 23\. 휴대폰결제 취소 (Non-UI)

통신사 결제 취소 가능 기간\[당월\]에 취소 시 취소API를 요청하며, 익월부터는 환불API를 요청합니다.

*    **예시**
    *   2023-06-30 승인 건 / 2023-07-01에 환불 API 요청

## 23.1 요청 전문 (가맹점 → 헥토파이낸셜)

가맹점 서버에서 헥토파이낸셜측으로 요청하는 컬럼을 다음과 같이 정의합니다.

      
| 파라미터 |     | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- | --- |
| params | mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 고유 상점아이디 | AN(10) | ●   | "nxhp\_pl\_il" |
| ver | 버전  | 전문의 버전 | AN(4) | ●   | "0A19"  <br>※ 고정값 |
| method | 결제수단 | 결제수단 | A(2) | ●   | "MP"  <br>※ 고정값 |
| bizType | 업무구분 | 업무 구분코드 | AN(2) | ●   | "C0"  <br>※ 고정값 |
| encCd | 암호화 구분 | 암호화 구분 코드 | N(2) | ●   | "23"  <br>※ 고정값 |
| mchtTrdNo | 상점주문번호 | 상점에서 생성하는 고유한 주문번호 | AN(100) | ●   | "ORDER20211231100000" |
| trdDt | 취소요청일자 | 현재 전문을 전송하는 일자(YYYYMMDD) | N(8) | ●   | "20211231" |
| trdTm | 취소요청시간 | 현재 전문을 전송하는 시간(HHMMSS) | N(6) | ●   | "100000" |
| mobileYn | 모바일 여부 | Y:모바일웹/앱, N:PC 또는 그 외 | A(1) | ○   | "N" |
| osType | OS 구분 | A:Android, I:IOS, W:windows, M:Mac, E:기타, 공백:확인불가 | A(1) | ○   | "W" |
| data | pktHash | hash데이터 | SHA256 방식으로 생성한 해쉬값  <br>\[[요청 전문 해쉬 코드](#item-471)\] 참고 | AN(200) | ●   | "f395b6725a9a18f2563ce34f8bc76698051d27c05e5ba815f463f00429061c0c" |
| orgTrdNo | 원거래번호 | 결제 시, 헥토파이낸셜에서 발급한 거래번호 | AN(40) | ●   | "STFP\_PGCAnxca\_jt\_il0211129135810M1494620" |
| crcCd | 통화구분 | 통화 구분 값 | A(3) | ●   | "KRW"  <br>※ 고정값 |
| cnclOrd | 취소회차 | 001부터 시작. 부분취소 2회차의 경우 002 | N(3) | ●   | "001" |
| taxTypeCd | 면세여부 | Y:면세, N:과세, G:복합과세. 공백일 경우 상점 기본 정보에 따름. | A(1) | ○   | "N" |
| cnclAmt | 취소금액 | 취소금액  <br>※ AES 암호화 | N(12) | ●   | "1000" |
| taxAmt | 과세금액 | 취소금액 중 과세금액(복합과세 경우에만 요청)  <br>※ AES 암호화 | N(12) | ○   | "909" |
| vatAmt | 부가세금액 | 취소금액 중 부가세금액(복합과세 경우에만 요청)  <br>※ AES 암호화 | N(12) | ○   | "91" |
| taxFreeAmt | 비과세금액 | 취소금액 중 면세금액(복합과세 경우에만 요청)  <br>※ AES 암호화 | N(12) | ○   | "0" |
| cnclRsn | 취소사유내용 | 필요한 경우, 취소 사유 메세지 기재 | AHN(255) | ○   | "상품이 마음에 들지 않아서" |

## 23.2 요청 전문 해쉬 코드

 
| 항목  | 조합 필드 |
| --- | --- |
| pktHash | 취소요청일자 + 취소요청시간 + 상점아이디 + 상점주문번호 + 취소금액(평문) + 해쉬키 |

## 23.3 응답 전문 (헥토파이낸셜 → 가맹점)

헥토파이낸셜에서 가맹점측으로 응답하는 컬럼을 다음과 같이 정의합니다.

      
| 파라미터 |     | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- | --- |
| params | mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 고유 상점아이디 | AN(10) | ●   | "nxhp\_pl\_il" |
| ver | 버전  | 전문의 버전 | AN(4) | ●   | "0A19"  <br>※ 고정값 |
| method | 결제수단 | 결제수단 | A(2) | ●   | "MP"  <br>※ 고정값 |
| bizType | 업무구분 | 업무 구분코드 | AN(2) | ●   | "C0"  <br>※ 고정값 |
| encCd | 암호화 구분 | 암호화 구분 코드 | N(2) | ●   | "23"  <br>※ 고정값 |
| mchtTrdNo | 상점주문번호 | 상점에서 생성하는 고유한 거래번호 | AN(100) | ●   | "ORDER20211231100000" |
| trdNo | 헥토파이낸셜 거래번호 | 헥토파이낸셜에서 생성하는 고유한 거래번호 | AN(40) | ●   | "STFP\_PGCAnxca\_jt\_il0211129135810M1494620" |
| trdDt | 취소요청일자 | 현재 전문을 전송하는 일자(YYYYMMDD) | N(8) | ●   | "20211231" |
| trdTm | 취소요청시간 | 현재 전문을 전송하는 시간(HHMMSS) | N(6) | ●   | "100000" |
| outStatCd | 거래상태 | 거래상태코드(성공/실패)  <br>0021:성공  <br>0031:실패 | AN(4) | ●   | "0021" |
| outRsltCd | 거절코드 | 거래상태가 "0031"일 경우, 상세 코드 전달  <br>\[[거절 코드 표](#item-544)\] 참고 | AN(4) | ●   | "0000" |
| outRsltMsg | 결과메세지 | 결과 메세지 전달  <br>URL Encoding, UTF-8 | AHN(200) | ●   | "정상적으로 처리되었습니다." |
| data | pktHash | 해쉬값 | 요청시, hash 값 그대로 return | AN(64) | ●   |     |
| orgTrdNo | 원거래번호 | 결제 시, 헥토파이낸셜에서 발급한 거래번호 | AN(40) | ●   | "STFP\_PGCAnxca\_jt\_il0211129135810M1494620" |
| cnclAmt | 취소금액 | 취소금액  <br>※ AES 암호화 | N(12) | ●   | "1000" |
| blcAmt | 취소가능잔액 | 취소성공시 거래번호 기준 남은 취소 가능잔액 리턴  <br>※ AES 암호화 | N(12) | ●   | "0" |
| rfdPsblCd | 환불가능여부 | 취소 실패에 따른 환불 구분 코드  <br>Y:환불 가능  <br>N:환불 불가(서비스 미등록)  <br>C:환불 불가(환불 조건 미충족) | A(1) | ○   | "Y" |

## 23.4 노티 전문 (헥토파이낸셜 → 가맹점)

※ \[[20.4 노티 전문](#item-718)\] 참고

# 24\. 휴대폰결제 환불 (Non-UI)

휴대폰 결제 취소 가능 기간\[당월\]이 지나 취소가 불가할때, 환불 요청합니다.

*    **예시**
    *   2023-06-30 승인 건 / 2023-07-01에 환불 API 요청

# 24.1 요청 전문 (가맹점 → 헥토파이낸셜)

요청 URI

 
| 구분  | URL |
| --- | --- |
| 테스트베드 | https://tbgw.settlebank.co.kr/spay/APIRefund.do |
| 상용 환경 | https://gw.settlebank.co.kr/spay/APIRefund.do |

가맹점 서버에서 헥토파이낸셜측으로 요청하는 컬럼을 다음과 같이 정의합니다.

      
| 파라미터 |     | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- | --- |
| params | mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 고유 상점아이디 | AN(10) | ●   | "nxhp\_sb\_il" |
| ver | 버전  | 전문의 버전 | AN(4) | ●   | "0A19"  <br>※ 고정값 |
| method | 결제수단 | 결제수단 | A(2) | ●   | "MP"  <br>※ 고정값 |
| bizType | 업무구분 | 업무 구분코드 | AN(2) | ●   | "C1"  <br>※ 고정값 |
| encCd | 암호화 구분 | 암호화 구분 코드 | N(2) | ●   | "23"  <br>※ 고정값 |
| mchtTrdNo | 상점주문번호 | 환불시 상점에서 생성하는 고유한 주문번호 | AN(100) | ●   | "ORDER20211231" |
| trdDt | 요청일자 | 현재 전문을 전송하는 일자(YYYYMMDD) | N(8) | ●   | "20211231" |
| trdTm | 요청시간 | 현재 전문을 전송하는 시간(HHMMSS) | N(6) | ●   | "100000" |
| mobileYn | 모바일 여부 | Y:모바일웹/앱, N:PC 또는 그 외 | A(1) | ○   | "N" |
| osType | OS 구분 | A:Android, I:IOS, W:windows, M:Mac, E:기타, 공백:확인불가 | A(1) | ○   | "W" |
| data | pktHash | hash데이터 | SHA256 방식으로 생성한 해쉬값  <br>\[[요청 전문 해쉬 코드](#item-1074)\] 참고 | AN(200) | ●   | "f395b6725a9a18f2563ce34f8bc76698051d27c05e5ba815f463f00429061c0c" |
| orgTrdNo | 원거래번호 | 채번요청시, 헥토파이낸셜에서 발급한 거래번호 | AN(40) | ●   | "STFP\_PGVAnx\_mid\_il00210806075210M1853381" |
| crcCd | 통화구분 | 통화 구분 값 | A(3) | ●   | "KRW"  <br>※ 고정값 |
| cnclOrd | 취소회차 | 001부터 시작. 부분취소 2회차의 경우 002 | N(3) | ●   | "001" |
| taxTypeCd | 면세여부 | Y:면세, N:과세, G:복합과세. 공백일 경우 상점 기본 정보에 따름. | A(1) | ○   | "N" |
| cnclAmt | 환불금액 | 환불금액  <br>※ AES 암호화 | N(12) | ●   | "1000" |
| taxAmt | 과세금액 | 환불금액 중 과세금액(복합과세 경우에만 요청)  <br>※ AES 암호화 | N(12) | ○   | "909" |
| vatAmt | 부가세금액 | 환불금액 중 부가세금액(복합과세 경우에만 요청)  <br>※ AES 암호화 | N(12) | ○   | "91" |
| taxFreeAmt | 비과세금액 | 환불금액 중 면세금액(복합과세 경우에만 요청)  <br>※ AES 암호화 | N(12) | ○   | "0" |
| refundBankCd | 환불은행코드 | 환불할 은행 코드  <br>\[[금융기관 식별자](#item-546)\] 참고 | AN(3) | ●   | "011" |
| refundAcntNo | 환불계좌번호 | 환불할 계좌 번호  <br>※ AES 암호화 | N(16) | ●   | "1234567890" |
| refundDpstrNm | 환불계좌예금주명 | 환불계좌의 예금주명 | AHN(50) | ●   | "홍길동" |
| cnclRsn | 환불사유내용 | 필요한 경우, 환불 사유 메세지 기재 | AHN(255) | ○   | "상품이 마음에 들지 않아서" |

# 24.2 요청 전문 해쉬 코드

 
| 항목  | 조합 필드 |
| --- | --- |
| pktHash | 환불요청일자 + 환불요청시간 + 상점아이디 + 상점주문번호 + 환불금액(평문) + 해쉬키 |

# 24.3 응답 전문 (헥토파이낸셜 → 가맹점)

헥토파이낸셜에서 가맹점측으로 응답하는 컬럼을 다음과 같이 정의합니다.

      
| 파라미터 |     | 이름  | 설명  | 타입(길이) | 필수  | 비고  |
| --- | --- | --- | --- | --- | --- | --- |
| params | mchtId | 상점아이디 | 헥토파이낸셜에서 부여하는 고유 상점아이디 | AN(10) | ●   | "nxhp\_sb\_il" |
| ver | 버전  | 전문의 버전 | AN(4) | ●   | "0A19"  <br>※ 고정값 |
| method | 결제수단 | 결제수단 | A(2) | ●   | "MP"  <br>※ 고정값 |
| bizType | 업무구분 | 업무 구분코드 | AN(2) | ●   | "C1"  <br>※ 고정값 |
| encCd | 암호화 구분 | 암호화 구분 코드 | N(2) | ●   | "23"  <br>※ 고정값 |
| mchtTrdNo | 상점주문번호 | 환불시, 상점에서 생성하는 고유한 주문번호 | AN(100) | ●   | "ORDER20211231100000" |
| trdNo | 헥토파이낸셜 거래번호 | 헥토파이낸셜에서 생성하는 고유한 거래번호 | AN(40) | ●   | "STFP\_PGVAnx\_mid\_il00210806075210M1853381" |
| trdDt | 요청일자 | 현재 전문을 전송하는 일자(YYYYMMDD) | N(8) | ●   | "20211231" |
| trdTm | 요청시간 | 현재 전문을 전송하는 시간(HHMMSS) | N(6) | ●   | "100000" |
| outStatCd | 거래상태 | 거래상태코드(성공/실패)  <br>0021:성공  <br>0031:실패 | AN(4) | ●   | "0021" |
| outRsltCd | 거절코드 | 거래상태가 "0031"일 경우, 상세 코드 전달  <br>\[[거절 코드 표](#item-544)\] 참고 | AN(4) | ●   | "0000" |
| outRsltMsg | 결과메세지 | 결과 메세지 전달  <br>URL Encoding, UTF-8 | AHN(200) | ●   | "정상적으로 처리되었습니다." |
| data | pktHash | 해쉬값 | 요청시, hash 값 그대로 return | AN(64) | ●   |     |
| orgTrdNo | 원거래번호 | 채번 요청시, 헥토파이낸셜에서 발급한 거래번호 | AN(40) | ●   | "STFP\_PGVAnx\_mid\_il00210806075210M1853381" |
| cnclAmt | 환불금액 | 환불금액  <br>※ AES 암호화 | N(12) | ●   | "1000" |
| blcAmt | 환불가능잔액 | 환불성공시 거래번호 기준 남은 환불 가능잔액 리턴  <br>※ AES 암호화 | N(12) | ●   | "0" |

# 24.4 노티 전문 (헥토파이낸셜 → 가맹점)

※ \[[20.4 노티 전문](#item-718)\] 참고

