from __future__ import annotations

import json
import sys

from sentineliqsdk.extractors import Extractor
from sentineliqsdk.extractors.custom.{SNAKE_NAME}_detector import {CLASS_NAME}


def main(argv: list[str]) -> int:
    ext = Extractor()
    ext.register_detector({CLASS_NAME}(), before="hash")
    values = ["foo", "MY:example", "bar"]
    results = [r.__dict__ for r in ext.check_iterable(values)]
    print(json.dumps(results, ensure_ascii=False))
    return 0


if __name__ == "__main__":
    raise SystemExit(main(sys.argv[1:]))

