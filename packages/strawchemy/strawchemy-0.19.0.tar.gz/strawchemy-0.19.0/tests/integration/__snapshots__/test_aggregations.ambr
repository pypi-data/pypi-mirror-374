# serializer version: 1
# name: test_count_aggregation[session-tracked-async-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT count(*) AS fruits__count_fruits,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.fruits__count_fruits AS fruits__count_fruits
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_count_aggregation[session-tracked-async-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT count(*) AS fruits__count_fruits,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.fruits__count_fruits AS fruits__count_fruits
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_count_aggregation[session-tracked-async-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.fruits__count_fruits AS fruits__count_fruits
    FROM color AS color
    JOIN LATERAL (
          SELECT count(*) AS fruits__count_fruits
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_count_aggregation[session-tracked-async-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.fruits__count_fruits AS fruits__count_fruits
    FROM color AS color
    JOIN LATERAL (
          SELECT count(*) AS fruits__count_fruits
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_count_aggregation[session-tracked-sync-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.fruits__count_fruits AS fruits__count_fruits
    FROM color AS color
    JOIN LATERAL (
          SELECT count(*) AS fruits__count_fruits
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_count_aggregation[session-tracked-sync-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT count(*) AS fruits__count_fruits,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.fruits__count_fruits AS fruits__count_fruits
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-bestTimeToPick-best_time_to_pick-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.best_time_to_pick) AS max_fruits__max_best_time_to_pick,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_best_time_to_pick AS max_fruits__max_best_time_to_pick
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-bestTimeToPick-best_time_to_pick-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.best_time_to_pick) AS max_fruits__max_best_time_to_pick,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_best_time_to_pick AS max_fruits__max_best_time_to_pick
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-bestTimeToPick-best_time_to_pick-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_best_time_to_pick AS max_fruits__max_best_time_to_pick
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.best_time_to_pick) AS max_fruits__max_best_time_to_pick
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-bestTimeToPick-best_time_to_pick-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_best_time_to_pick AS max_fruits__max_best_time_to_pick
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.best_time_to_pick) AS max_fruits__max_best_time_to_pick
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-createdAt-created_at-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.created_at) AS max_fruits__max_created_at,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_created_at AS max_fruits__max_created_at
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-createdAt-created_at-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.created_at) AS max_fruits__max_created_at,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_created_at AS max_fruits__max_created_at
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-createdAt-created_at-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_created_at AS max_fruits__max_created_at
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.created_at) AS max_fruits__max_created_at
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-createdAt-created_at-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_created_at AS max_fruits__max_created_at
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.created_at) AS max_fruits__max_created_at
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-name-name-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.name) AS max_fruits__max_name,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_name AS max_fruits__max_name
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-name-name-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.name) AS max_fruits__max_name,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_name AS max_fruits__max_name
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-name-name-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_name AS max_fruits__max_name
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.name) AS max_fruits__max_name
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-name-name-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_name AS max_fruits__max_name
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.name) AS max_fruits__max_name
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-rarity-rarity-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.rarity) AS max_fruits__max_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_rarity AS max_fruits__max_rarity
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-rarity-rarity-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.rarity) AS max_fruits__max_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_rarity AS max_fruits__max_rarity
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-rarity-rarity-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_rarity AS max_fruits__max_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.rarity) AS max_fruits__max_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-rarity-rarity-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_rarity AS max_fruits__max_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.rarity) AS max_fruits__max_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-sweetness-sweetness-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.sweetness) AS max_fruits__max_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_sweetness AS max_fruits__max_sweetness
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-sweetness-sweetness-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.sweetness) AS max_fruits__max_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_sweetness AS max_fruits__max_sweetness
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-sweetness-sweetness-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_sweetness AS max_fruits__max_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.sweetness) AS max_fruits__max_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-sweetness-sweetness-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_sweetness AS max_fruits__max_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.sweetness) AS max_fruits__max_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-waterPercent-water_percent-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.water_percent) AS max_fruits__max_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_water_percent AS max_fruits__max_water_percent
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-waterPercent-water_percent-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.water_percent) AS max_fruits__max_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_water_percent AS max_fruits__max_water_percent
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-waterPercent-water_percent-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_water_percent AS max_fruits__max_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.water_percent) AS max_fruits__max_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-async-waterPercent-water_percent-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_water_percent AS max_fruits__max_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.water_percent) AS max_fruits__max_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-bestTimeToPick-best_time_to_pick-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_best_time_to_pick AS max_fruits__max_best_time_to_pick
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.best_time_to_pick) AS max_fruits__max_best_time_to_pick
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-bestTimeToPick-best_time_to_pick-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.best_time_to_pick) AS max_fruits__max_best_time_to_pick,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_best_time_to_pick AS max_fruits__max_best_time_to_pick
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-createdAt-created_at-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_created_at AS max_fruits__max_created_at
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.created_at) AS max_fruits__max_created_at
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-createdAt-created_at-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.created_at) AS max_fruits__max_created_at,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_created_at AS max_fruits__max_created_at
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-name-name-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_name AS max_fruits__max_name
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.name) AS max_fruits__max_name
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-name-name-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.name) AS max_fruits__max_name,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_name AS max_fruits__max_name
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-rarity-rarity-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_rarity AS max_fruits__max_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.rarity) AS max_fruits__max_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-rarity-rarity-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.rarity) AS max_fruits__max_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_rarity AS max_fruits__max_rarity
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-sweetness-sweetness-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_sweetness AS max_fruits__max_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.sweetness) AS max_fruits__max_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-sweetness-sweetness-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.sweetness) AS max_fruits__max_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_sweetness AS max_fruits__max_sweetness
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-waterPercent-water_percent-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_water_percent AS max_fruits__max_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT max(fruit_1.water_percent) AS max_fruits__max_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_max_aggregation[session-tracked-sync-waterPercent-water_percent-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT max(fruit_1.water_percent) AS max_fruits__max_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.max_fruits__max_water_percent AS max_fruits__max_water_percent
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-bestTimeToPick-best_time_to_pick-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.best_time_to_pick) AS min_fruits__min_best_time_to_pick,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_best_time_to_pick AS min_fruits__min_best_time_to_pick
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-bestTimeToPick-best_time_to_pick-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.best_time_to_pick) AS min_fruits__min_best_time_to_pick,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_best_time_to_pick AS min_fruits__min_best_time_to_pick
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-bestTimeToPick-best_time_to_pick-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_best_time_to_pick AS min_fruits__min_best_time_to_pick
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.best_time_to_pick) AS min_fruits__min_best_time_to_pick
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-bestTimeToPick-best_time_to_pick-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_best_time_to_pick AS min_fruits__min_best_time_to_pick
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.best_time_to_pick) AS min_fruits__min_best_time_to_pick
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-createdAt-created_at-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.created_at) AS min_fruits__min_created_at,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_created_at AS min_fruits__min_created_at
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-createdAt-created_at-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.created_at) AS min_fruits__min_created_at,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_created_at AS min_fruits__min_created_at
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-createdAt-created_at-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_created_at AS min_fruits__min_created_at
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.created_at) AS min_fruits__min_created_at
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-createdAt-created_at-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_created_at AS min_fruits__min_created_at
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.created_at) AS min_fruits__min_created_at
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-name-name-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.name) AS min_fruits__min_name,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_name AS min_fruits__min_name
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-name-name-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.name) AS min_fruits__min_name,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_name AS min_fruits__min_name
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-name-name-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_name AS min_fruits__min_name
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.name) AS min_fruits__min_name
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-name-name-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_name AS min_fruits__min_name
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.name) AS min_fruits__min_name
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-rarity-rarity-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.rarity) AS min_fruits__min_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_rarity AS min_fruits__min_rarity
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-rarity-rarity-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.rarity) AS min_fruits__min_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_rarity AS min_fruits__min_rarity
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-rarity-rarity-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_rarity AS min_fruits__min_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.rarity) AS min_fruits__min_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-rarity-rarity-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_rarity AS min_fruits__min_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.rarity) AS min_fruits__min_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-sweetness-sweetness-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.sweetness) AS min_fruits__min_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_sweetness AS min_fruits__min_sweetness
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-sweetness-sweetness-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.sweetness) AS min_fruits__min_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_sweetness AS min_fruits__min_sweetness
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-sweetness-sweetness-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_sweetness AS min_fruits__min_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.sweetness) AS min_fruits__min_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-sweetness-sweetness-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_sweetness AS min_fruits__min_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.sweetness) AS min_fruits__min_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-waterPercent-water_percent-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.water_percent) AS min_fruits__min_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_water_percent AS min_fruits__min_water_percent
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-waterPercent-water_percent-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.water_percent) AS min_fruits__min_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_water_percent AS min_fruits__min_water_percent
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-waterPercent-water_percent-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_water_percent AS min_fruits__min_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.water_percent) AS min_fruits__min_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-async-waterPercent-water_percent-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_water_percent AS min_fruits__min_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.water_percent) AS min_fruits__min_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-bestTimeToPick-best_time_to_pick-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_best_time_to_pick AS min_fruits__min_best_time_to_pick
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.best_time_to_pick) AS min_fruits__min_best_time_to_pick
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-bestTimeToPick-best_time_to_pick-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.best_time_to_pick) AS min_fruits__min_best_time_to_pick,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_best_time_to_pick AS min_fruits__min_best_time_to_pick
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-createdAt-created_at-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_created_at AS min_fruits__min_created_at
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.created_at) AS min_fruits__min_created_at
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-createdAt-created_at-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.created_at) AS min_fruits__min_created_at,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_created_at AS min_fruits__min_created_at
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-name-name-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_name AS min_fruits__min_name
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.name) AS min_fruits__min_name
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-name-name-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.name) AS min_fruits__min_name,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_name AS min_fruits__min_name
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-rarity-rarity-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_rarity AS min_fruits__min_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.rarity) AS min_fruits__min_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-rarity-rarity-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.rarity) AS min_fruits__min_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_rarity AS min_fruits__min_rarity
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-sweetness-sweetness-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_sweetness AS min_fruits__min_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.sweetness) AS min_fruits__min_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-sweetness-sweetness-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.sweetness) AS min_fruits__min_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_sweetness AS min_fruits__min_sweetness
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-waterPercent-water_percent-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_water_percent AS min_fruits__min_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT min(fruit_1.water_percent) AS min_fruits__min_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_min_aggregation[session-tracked-sync-waterPercent-water_percent-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT min(fruit_1.water_percent) AS min_fruits__min_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.min_fruits__min_water_percent AS min_fruits__min_water_percent
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-avg-no-pagination-aiosqlite_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-avg-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-avg-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-avg-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-avg-pagination-aiosqlite_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-avg-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-avg-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-avg-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddev-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev(fruit.rarity) OVER () AS stddev_fruits__stddev_rarity
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddev-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev(fruit.rarity) OVER () AS stddev_fruits__stddev_rarity
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddev-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev(fruit.rarity) OVER () AS stddev_fruits__stddev_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddev-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev(fruit.rarity) OVER () AS stddev_fruits__stddev_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevPop-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_pop(fruit.rarity) OVER () AS stddev_pop_fruits__stddev_pop_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevPop-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_pop(fruit.rarity) OVER () AS stddev_pop_fruits__stddev_pop_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevPop-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_pop(fruit.rarity) OVER () AS stddev_pop_fruits__stddev_pop_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevPop-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_pop(fruit.rarity) OVER () AS stddev_pop_fruits__stddev_pop_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevPop-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_pop(fruit.rarity) OVER () AS stddev_pop_fruits__stddev_pop_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevPop-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_pop(fruit.rarity) OVER () AS stddev_pop_fruits__stddev_pop_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevSamp-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_samp(fruit.rarity) OVER () AS stddev_samp_fruits__stddev_samp_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevSamp-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_samp(fruit.rarity) OVER () AS stddev_samp_fruits__stddev_samp_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevSamp-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_samp(fruit.rarity) OVER () AS stddev_samp_fruits__stddev_samp_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevSamp-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_samp(fruit.rarity) OVER () AS stddev_samp_fruits__stddev_samp_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevSamp-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_samp(fruit.rarity) OVER () AS stddev_samp_fruits__stddev_samp_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-stddevSamp-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_samp(fruit.rarity) OVER () AS stddev_samp_fruits__stddev_samp_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-sum-no-pagination-aiosqlite_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-sum-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-sum-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-sum-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-sum-pagination-aiosqlite_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-sum-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-sum-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-sum-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varPop-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_pop(fruit.rarity) OVER () AS var_pop_fruits__var_pop_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varPop-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_pop(fruit.rarity) OVER () AS var_pop_fruits__var_pop_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varPop-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_pop(fruit.rarity) OVER () AS var_pop_fruits__var_pop_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varPop-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_pop(fruit.rarity) OVER () AS var_pop_fruits__var_pop_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varPop-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_pop(fruit.rarity) OVER () AS var_pop_fruits__var_pop_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varPop-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_pop(fruit.rarity) OVER () AS var_pop_fruits__var_pop_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varSamp-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_samp(fruit.rarity) OVER () AS var_samp_fruits__var_samp_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varSamp-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_samp(fruit.rarity) OVER () AS var_samp_fruits__var_samp_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varSamp-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_samp(fruit.rarity) OVER () AS var_samp_fruits__var_samp_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varSamp-pagination-asyncmy_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_samp(fruit.rarity) OVER () AS var_samp_fruits__var_samp_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varSamp-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_samp(fruit.rarity) OVER () AS var_samp_fruits__var_samp_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-varSamp-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_samp(fruit.rarity) OVER () AS var_samp_fruits__var_samp_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-variance-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         variance(fruit.rarity) OVER () AS variance_fruits__variance_rarity
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-variance-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         variance(fruit.rarity) OVER () AS variance_fruits__variance_rarity
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-variance-pagination-asyncpg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         variance(fruit.rarity) OVER () AS variance_fruits__variance_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-rarity-rarity-variance-pagination-psycopg_async_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         variance(fruit.rarity) OVER () AS variance_fruits__variance_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sw  '''
  SELECT fruit.sweetness,
         fruit.id,
         CAST(var_pop(fruit.sweetness) OVER () AS DOUBLE PRECISION) AS var_pop_fruits__var_pop_sweetness
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweet         ) AS fruit
   LIMIT %s
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-avg-no-pagination-aiosqlite_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-avg-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-avg-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-avg-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-avg-pagination-aiosqlite_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-avg-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-avg-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-avg-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddev-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev(fruit.sweetness) OVER () AS stddev_fruits__stddev_sweetness
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddev-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev(fruit.sweetness) OVER () AS stddev_fruits__stddev_sweetness
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddev-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev(fruit.sweetness) OVER () AS stddev_fruits__stddev_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddev-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev(fruit.sweetness) OVER () AS stddev_fruits__stddev_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevPop-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_pop(fruit.sweetness) OVER () AS stddev_pop_fruits__stddev_pop_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevPop-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_pop(fruit.sweetness) OVER () AS stddev_pop_fruits__stddev_pop_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevPop-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_pop(fruit.sweetness) OVER () AS stddev_pop_fruits__stddev_pop_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevPop-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_pop(fruit.sweetness) OVER () AS stddev_pop_fruits__stddev_pop_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevPop-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_pop(fruit.sweetness) OVER () AS stddev_pop_fruits__stddev_pop_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevPop-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_pop(fruit.sweetness) OVER () AS stddev_pop_fruits__stddev_pop_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevSamp-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_samp(fruit.sweetness) OVER () AS stddev_samp_fruits__stddev_samp_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevSamp-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_samp(fruit.sweetness) OVER () AS stddev_samp_fruits__stddev_samp_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevSamp-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_samp(fruit.sweetness) OVER () AS stddev_samp_fruits__stddev_samp_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevSamp-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_samp(fruit.sweetness) OVER () AS stddev_samp_fruits__stddev_samp_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevSamp-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_samp(fruit.sweetness) OVER () AS stddev_samp_fruits__stddev_samp_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-stddevSamp-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_samp(fruit.sweetness) OVER () AS stddev_samp_fruits__stddev_samp_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-sum-no-pagination-aiosqlite_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-sum-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-sum-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-sum-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-sum-pagination-aiosqlite_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-sum-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-sum-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-sum-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varPop-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_pop(fruit.sweetness) OVER () AS var_pop_fruits__var_pop_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varPop-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_pop(fruit.sweetness) OVER () AS var_pop_fruits__var_pop_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varPop-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_pop(fruit.sweetness) OVER () AS var_pop_fruits__var_pop_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varPop-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_pop(fruit.sweetness) OVER () AS var_pop_fruits__var_pop_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varPop-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_pop(fruit.sweetness) OVER () AS var_pop_fruits__var_pop_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varPop-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_pop(fruit.sweetness) OVER () AS var_pop_fruits__var_pop_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varSamp-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_samp(fruit.sweetness) OVER () AS var_samp_fruits__var_samp_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varSamp-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_samp(fruit.sweetness) OVER () AS var_samp_fruits__var_samp_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varSamp-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_samp(fruit.sweetness) OVER () AS var_samp_fruits__var_samp_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varSamp-pagination-asyncmy_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_samp(fruit.sweetness) OVER () AS var_samp_fruits__var_samp_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varSamp-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_samp(fruit.sweetness) OVER () AS var_samp_fruits__var_samp_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-varSamp-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_samp(fruit.sweetness) OVER () AS var_samp_fruits__var_samp_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-variance-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         variance(fruit.sweetness) OVER () AS variance_fruits__variance_sweetness
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-variance-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         variance(fruit.sweetness) OVER () AS variance_fruits__variance_sweetness
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-variance-pagination-asyncpg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         variance(fruit.sweetness) OVER () AS variance_fruits__variance_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   L  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-avg-no-pagination-aiosqlite_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-avg-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-avg-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-avg-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-avg-pagination-aiosqlite_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-avg-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-avg-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-avg-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddev-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev(fruit.water_percent) OVER () AS stddev_fruits__stddev_water_percent
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddev-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev(fruit.water_percent) OVER () AS stddev_fruits__stddev_water_percent
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddev-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev(fruit.water_percent) OVER () AS stddev_fruits__stddev_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddev-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev(fruit.water_percent) OVER () AS stddev_fruits__stddev_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevPop-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_pop(fruit.water_percent) OVER () AS stddev_pop_fruits__stddev_pop_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevPop-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_pop(fruit.water_percent) OVER () AS stddev_pop_fruits__stddev_pop_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevPop-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_pop(fruit.water_percent) OVER () AS stddev_pop_fruits__stddev_pop_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevPop-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_pop(fruit.water_percent) OVER () AS stddev_pop_fruits__stddev_pop_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevPop-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_pop(fruit.water_percent) OVER () AS stddev_pop_fruits__stddev_pop_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevPop-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_pop(fruit.water_percent) OVER () AS stddev_pop_fruits__stddev_pop_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevSamp-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_samp(fruit.water_percent) OVER () AS stddev_samp_fruits__stddev_samp_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevSamp-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_samp(fruit.water_percent) OVER () AS stddev_samp_fruits__stddev_samp_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevSamp-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_samp(fruit.water_percent) OVER () AS stddev_samp_fruits__stddev_samp_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevSamp-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_samp(fruit.water_percent) OVER () AS stddev_samp_fruits__stddev_samp_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevSamp-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_samp(fruit.water_percent) OVER () AS stddev_samp_fruits__stddev_samp_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-stddevSamp-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_samp(fruit.water_percent) OVER () AS stddev_samp_fruits__stddev_samp_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-sum-no-pagination-aiosqlite_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-sum-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-sum-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-sum-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-sum-pagination-aiosqlite_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-sum-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-sum-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-sum-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varPop-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_pop(fruit.water_percent) OVER () AS var_pop_fruits__var_pop_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varPop-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_pop(fruit.water_percent) OVER () AS var_pop_fruits__var_pop_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varPop-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_pop(fruit.water_percent) OVER () AS var_pop_fruits__var_pop_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varPop-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_pop(fruit.water_percent) OVER () AS var_pop_fruits__var_pop_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varPop-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_pop(fruit.water_percent) OVER () AS var_pop_fruits__var_pop_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varPop-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_pop(fruit.water_percent) OVER () AS var_pop_fruits__var_pop_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varSamp-no-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_samp(fruit.water_percent) OVER () AS var_samp_fruits__var_samp_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varSamp-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_samp(fruit.water_percent) OVER () AS var_samp_fruits__var_samp_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varSamp-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_samp(fruit.water_percent) OVER () AS var_samp_fruits__var_samp_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varSamp-pagination-asyncmy_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_samp(fruit.water_percent) OVER () AS var_samp_fruits__var_samp_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %s,
                 %s
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %s
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varSamp-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_samp(fruit.water_percent) OVER () AS var_samp_fruits__var_samp_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-varSamp-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_samp(fruit.water_percent) OVER () AS var_samp_fruits__var_samp_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-variance-no-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         variance(fruit.water_percent) OVER () AS variance_fruits__variance_water_percent
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-variance-no-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         variance(fruit.water_percent) OVER () AS variance_fruits__variance_water_percent
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-variance-pagination-asyncpg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         variance(fruit.water_percent) OVER () AS variance_fruits__variance_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           LIMIT $1::INTEGER
          OFFSET $2::INTEGER
         ) AS fruit
   LIMIT $3::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-async-waterPercent-water_percent-variance-pagination-psycopg_async_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         variance(fruit.water_percent) OVER () AS variance_fruits__variance_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-avg-no-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-avg-no-pagination-sqlite_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-avg-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-avg-pagination-sqlite_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         avg(fruit.rarity) OVER () AS avg_fruits__avg_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-stddev-no-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev(fruit.rarity) OVER () AS stddev_fruits__stddev_rarity
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-stddev-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev(fruit.rarity) OVER () AS stddev_fruits__stddev_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-stddevPop-no-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_pop(fruit.rarity) OVER () AS stddev_pop_fruits__stddev_pop_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-stddevPop-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_pop(fruit.rarity) OVER () AS stddev_pop_fruits__stddev_pop_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-stddevSamp-no-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_samp(fruit.rarity) OVER () AS stddev_samp_fruits__stddev_samp_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-stddevSamp-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         stddev_samp(fruit.rarity) OVER () AS stddev_samp_fruits__stddev_samp_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-sum-no-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-sum-no-pagination-sqlite_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-sum-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-sum-pagination-sqlite_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         sum(fruit.rarity) OVER () AS sum_fruits__sum_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-varPop-no-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_pop(fruit.rarity) OVER () AS var_pop_fruits__var_pop_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-varPop-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_pop(fruit.rarity) OVER () AS var_pop_fruits__var_pop_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-varSamp-no-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_samp(fruit.rarity) OVER () AS var_samp_fruits__var_samp_rarity
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-varSamp-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         var_samp(fruit.rarity) OVER () AS var_samp_fruits__var_samp_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-variance-no-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         variance(fruit.rarity) OVER () AS variance_fruits__variance_rarity
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-rarity-rarity-variance-pagination-psycopg_engine]
  '''
  SELECT fruit.rarity,
         fruit.id,
         variance(fruit.rarity) OVER () AS variance_fruits__variance_rarity
    FROM (
          SELECT fruit.id AS id,
                 fruit.rarity AS rarity,
                 fruit.rarity AS rarity__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-avg-no-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-avg-no-pagination-sqlite_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-avg-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-avg-pagination-sqlite_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         avg(fruit.sweetness) OVER () AS avg_fruits__avg_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-stddev-no-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev(fruit.sweetness) OVER () AS stddev_fruits__stddev_sweetness
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-stddev-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev(fruit.sweetness) OVER () AS stddev_fruits__stddev_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-stddevPop-no-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_pop(fruit.sweetness) OVER () AS stddev_pop_fruits__stddev_pop_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-stddevPop-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_pop(fruit.sweetness) OVER () AS stddev_pop_fruits__stddev_pop_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-stddevSamp-no-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_samp(fruit.sweetness) OVER () AS stddev_samp_fruits__stddev_samp_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-stddevSamp-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         stddev_samp(fruit.sweetness) OVER () AS stddev_samp_fruits__stddev_samp_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-sum-no-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-sum-no-pagination-sqlite_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-sum-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-sum-pagination-sqlite_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         sum(fruit.sweetness) OVER () AS sum_fruits__sum_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-varPop-no-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_pop(fruit.sweetness) OVER () AS var_pop_fruits__var_pop_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-varPop-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_pop(fruit.sweetness) OVER () AS var_pop_fruits__var_pop_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-varSamp-no-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_samp(fruit.sweetness) OVER () AS var_samp_fruits__var_samp_sweetness
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-varSamp-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         var_samp(fruit.sweetness) OVER () AS var_samp_fruits__var_samp_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-variance-no-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         variance(fruit.sweetness) OVER () AS variance_fruits__variance_sweetness
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-sweetness-sweetness-variance-pagination-psycopg_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         variance(fruit.sweetness) OVER () AS variance_fruits__variance_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-avg-no-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-avg-no-pagination-sqlite_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-avg-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-avg-pagination-sqlite_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         avg(fruit.water_percent) OVER () AS avg_fruits__avg_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-stddev-no-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev(fruit.water_percent) OVER () AS stddev_fruits__stddev_water_percent
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-stddev-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev(fruit.water_percent) OVER () AS stddev_fruits__stddev_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-stddevPop-no-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_pop(fruit.water_percent) OVER () AS stddev_pop_fruits__stddev_pop_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-stddevPop-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_pop(fruit.water_percent) OVER () AS stddev_pop_fruits__stddev_pop_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-stddevSamp-no-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_samp(fruit.water_percent) OVER () AS stddev_samp_fruits__stddev_samp_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-stddevSamp-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         stddev_samp(fruit.water_percent) OVER () AS stddev_samp_fruits__stddev_samp_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-sum-no-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-sum-no-pagination-sqlite_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-sum-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-sum-pagination-sqlite_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         sum(fruit.water_percent) OVER () AS sum_fruits__sum_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT ?
          OFFSET ?
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT ?
  OFFSET ?
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-varPop-no-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_pop(fruit.water_percent) OVER () AS var_pop_fruits__var_pop_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-varPop-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_pop(fruit.water_percent) OVER () AS var_pop_fruits__var_pop_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-varSamp-no-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_samp(fruit.water_percent) OVER () AS var_samp_fruits__var_samp_water_percent
    FROM fruit AS fruit
   ORDER BY fruit.id ASC
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-varSamp-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         var_samp(fruit.water_percent) OVER () AS var_samp_fruits__var_samp_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           ORDER BY fruit.id ASC
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   ORDER BY fruit.id ASC
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-variance-no-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         variance(fruit.water_percent) OVER () AS variance_fruits__variance_water_percent
    FROM fruit AS fruit
  '''
# ---
# name: test_root_aggregation[session-tracked-sync-waterPercent-water_percent-variance-pagination-psycopg_engine]
  '''
  SELECT fruit.water_percent,
         fruit.id,
         variance(fruit.water_percent) OVER () AS variance_fruits__variance_water_percent
    FROM (
          SELECT fruit.id AS id,
                 fruit.water_percent AS water_percent,
                 fruit.water_percent AS water_percent__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_stat# name: test_root_aggregation[session-tracked-async-sweetness-sweetness-variance-pagination-psycopg_async_engine]
  '''
  SELECT fruit.sweetness,
         fruit.id,
         variance(fruit.sweetness) OVER () AS variance_fruits__variance_sweetness
    FROM (
          SELECT fruit.id AS id,
                 fruit.sweetness AS sweetness,
                 fruit.sweetness AS sweetness__1
            FROM fruit AS fruit
           LIMIT %(param_1)s::INTEGER
          OFFSET %(param_2)s::INTEGER
         ) AS fruit
   LIMIT %(param_3)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-avg-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT avg(fruit_1.rarity) AS avg_fruits__avg_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_rarity AS avg_fruits__avg_rarity
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-avg-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT avg(fruit_1.rarity) AS avg_fruits__avg_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_rarity AS avg_fruits__avg_rarity
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-avg-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_rarity AS avg_fruits__avg_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT avg(fruit_1.rarity) AS avg_fruits__avg_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-avg-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_rarity AS avg_fruits__avg_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT avg(fruit_1.rarity) AS avg_fruits__avg_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-stddev-asyncpg_engine]
  '''
  SELECT color.id,
         aggregation_0.stddev_fruits__stddev_rarity AS stddev_fruits__stddev_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev(fruit_1.rarity) AS stddev_fruits__stddev_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-stddev-psycopg_async_engine]
  '''
  SELECT color.id,
         aggregation_0.stddev_fruits__stddev_rarity AS stddev_fruits__stddev_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev(fruit_1.rarity) AS stddev_fruits__stddev_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-stddevPop-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT stddev_pop(fruit_1.rarity) AS stddev_pop_fruits__stddev_pop_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_rarity AS stddev_pop_fruits__stddev_pop_rarity
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-stddevPop-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_rarity AS stddev_pop_fruits__stddev_pop_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_pop(fruit_1.rarity) AS stddev_pop_fruits__stddev_pop_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-stddevPop-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_rarity AS stddev_pop_fruits__stddev_pop_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_pop(fruit_1.rarity) AS stddev_pop_fruits__stddev_pop_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-stddevSamp-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT stddev_samp(fruit_1.rarity) AS stddev_samp_fruits__stddev_samp_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_rarity AS stddev_samp_fruits__stddev_samp_rarity
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-stddevSamp-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_rarity AS stddev_samp_fruits__stddev_samp_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_samp(fruit_1.rarity) AS stddev_samp_fruits__stddev_samp_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-stddevSamp-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_rarity AS stddev_samp_fruits__stddev_samp_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_samp(fruit_1.rarity) AS stddev_samp_fruits__stddev_samp_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-varPop-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT var_pop(fruit_1.rarity) AS var_pop_fruits__var_pop_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_rarity AS var_pop_fruits__var_pop_rarity
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-varPop-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_rarity AS var_pop_fruits__var_pop_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT var_pop(fruit_1.rarity) AS var_pop_fruits__var_pop_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-varPop-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_rarity AS var_pop_fruits__var_pop_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT var_pop(fruit_1.rarity) AS var_pop_fruits__var_pop_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-varSamp-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT var_samp(fruit_1.rarity) AS var_samp_fruits__var_samp_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_rarity AS var_samp_fruits__var_samp_rarity
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-varSamp-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_rarity AS var_samp_fruits__var_samp_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT var_samp(fruit_1.rarity) AS var_samp_fruits__var_samp_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-varSamp-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_rarity AS var_samp_fruits__var_samp_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT var_samp(fruit_1.rarity) AS var_samp_fruits__var_samp_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-variance-asyncpg_engine]
  '''
  SELECT color.id,
         aggregation_0.variance_fruits__variance_rarity AS variance_fruits__variance_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT variance(fruit_1.rarity) AS variance_fruits__variance_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-rarity-rarity-variance-psycopg_async_engine]
  '''
  SELECT color.id,
         aggregation_0.variance_fruits__variance_rarity AS variance_fruits__variance_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT variance(fruit_1.rarity) AS variance_fruits__variance_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-avg-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT avg(fruit_1.sweetness) AS avg_fruits__avg_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_sweetness AS avg_fruits__avg_sweetness
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-avg-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT avg(fruit_1.sweetness) AS avg_fruits__avg_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_sweetness AS avg_fruits__avg_sweetness
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-avg-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_sweetness AS avg_fruits__avg_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT avg(fruit_1.sweetness) AS avg_fruits__avg_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-avg-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_sweetness AS avg_fruits__avg_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT avg(fruit_1.sweetness) AS avg_fruits__avg_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-stddev-asyncpg_engine]
  '''
  SELECT color.id,
         aggregation_0.stddev_fruits__stddev_sweetness AS stddev_fruits__stddev_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev(fruit_1.sweetness) AS stddev_fruits__stddev_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-stddev-psycopg_async_engine]
  '''
  SELECT color.id,
         aggregation_0.stddev_fruits__stddev_sweetness AS stddev_fruits__stddev_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev(fruit_1.sweetness) AS stddev_fruits__stddev_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-stddevPop-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT stddev_pop(fruit_1.sweetness) AS stddev_pop_fruits__stddev_pop_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_sweetness AS stddev_pop_fruits__stddev_pop_sweetness
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-stddevPop-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_sweetness AS stddev_pop_fruits__stddev_pop_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_pop(fruit_1.sweetness) AS stddev_pop_fruits__stddev_pop_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-stddevPop-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_sweetness AS stddev_pop_fruits__stddev_pop_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_pop(fruit_1.sweetness) AS stddev_pop_fruits__stddev_pop_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-stddevSamp-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT stddev_samp(fruit_1.sweetness) AS stddev_samp_fruits__stddev_samp_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_sweetness AS stddev_samp_fruits__stddev_samp_sweetness
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-stddevSamp-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_sweetness AS stddev_samp_fruits__stddev_samp_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_samp(fruit_1.sweetness) AS stddev_samp_fruits__stddev_samp_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-stddevSamp-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_sweetness AS stddev_samp_fruits__stddev_samp_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_samp(fruit_1.sweetness) AS stddev_samp_fruits__stddev_samp_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-varPop-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT var_pop(fruit_1.sweetness) AS var_pop_fruits__var_pop_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_sweetness AS var_pop_fruits__var_pop_sweetness
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-varPop-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_sweetness AS var_pop_fruits__var_pop_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT var_pop(fruit_1.sweetness) AS var_pop_fruits__var_pop_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-varPop-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_sweetness AS var_pop_fruits__var_pop_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT var_pop(fruit_1.sweetness) AS var_pop_fruits__var_pop_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-varSamp-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT var_samp(fruit_1.sweetness) AS var_samp_fruits__var_samp_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_sweetness AS var_samp_fruits__var_samp_sweetness
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-varSamp-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_sweetness AS var_samp_fruits__var_samp_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT var_samp(fruit_1.sweetness) AS var_samp_fruits__var_samp_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-varSamp-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_sweetness AS var_samp_fruits__var_samp_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT var_samp(fruit_1.sweetness) AS var_samp_fruits__var_samp_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-variance-asyncpg_engine]
  '''
  SELECT color.id,
         aggregation_0.variance_fruits__variance_sweetness AS variance_fruits__variance_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT variance(fruit_1.sweetness) AS variance_fruits__variance_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-sweetness-sweetness-variance-psycopg_async_engine]
  '''
  SELECT color.id,
         aggregation_0.variance_fruits__variance_sweetness AS variance_fruits__variance_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT variance(fruit_1.sweetness) AS variance_fruits__variance_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-avg-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT avg(fruit_1.water_percent) AS avg_fruits__avg_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_water_percent AS avg_fruits__avg_water_percent
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-avg-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT avg(fruit_1.water_percent) AS avg_fruits__avg_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_water_percent AS avg_fruits__avg_water_percent
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-avg-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_water_percent AS avg_fruits__avg_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT avg(fruit_1.water_percent) AS avg_fruits__avg_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-avg-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_water_percent AS avg_fruits__avg_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT avg(fruit_1.water_percent) AS avg_fruits__avg_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-stddev-asyncpg_engine]
  '''
  SELECT color.id,
         aggregation_0.stddev_fruits__stddev_water_percent AS stddev_fruits__stddev_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev(fruit_1.water_percent) AS stddev_fruits__stddev_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-stddev-psycopg_async_engine]
  '''
  SELECT color.id,
         aggregation_0.stddev_fruits__stddev_water_percent AS stddev_fruits__stddev_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev(fruit_1.water_percent) AS stddev_fruits__stddev_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-stddevPop-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT stddev_pop(fruit_1.water_percent) AS stddev_pop_fruits__stddev_pop_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_water_percent AS stddev_pop_fruits__stddev_pop_water_percent
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-stddevPop-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_water_percent AS stddev_pop_fruits__stddev_pop_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_pop(fruit_1.water_percent) AS stddev_pop_fruits__stddev_pop_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-stddevPop-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_water_percent AS stddev_pop_fruits__stddev_pop_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_pop(fruit_1.water_percent) AS stddev_pop_fruits__stddev_pop_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-stddevSamp-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT stddev_samp(fruit_1.water_percent) AS stddev_samp_fruits__stddev_samp_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_water_percent AS stddev_samp_fruits__stddev_samp_water_percent
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-stddevSamp-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_water_percent AS stddev_samp_fruits__stddev_samp_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_samp(fruit_1.water_percent) AS stddev_samp_fruits__stddev_samp_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-stddevSamp-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_water_percent AS stddev_samp_fruits__stddev_samp_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_samp(fruit_1.water_percent) AS stddev_samp_fruits__stddev_samp_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-varPop-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT var_pop(fruit_1.water_percent) AS var_pop_fruits__var_pop_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_water_percent AS var_pop_fruits__var_pop_water_percent
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-varPop-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_water_percent AS var_pop_fruits__var_pop_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT var_pop(fruit_1.water_percent) AS var_pop_fruits__var_pop_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-varPop-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_water_percent AS var_pop_fruits__var_pop_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT var_pop(fruit_1.water_percent) AS var_pop_fruits__var_pop_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-varSamp-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT var_samp(fruit_1.water_percent) AS var_samp_fruits__var_samp_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_water_percent AS var_samp_fruits__var_samp_water_percent
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-varSamp-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_water_percent AS var_samp_fruits__var_samp_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT var_samp(fruit_1.water_percent) AS var_samp_fruits__var_samp_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-varSamp-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_water_percent AS var_samp_fruits__var_samp_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT var_samp(fruit_1.water_percent) AS var_samp_fruits__var_samp_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-variance-asyncpg_engine]
  '''
  SELECT color.id,
         aggregation_0.variance_fruits__variance_water_percent AS variance_fruits__variance_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT variance(fruit_1.water_percent) AS variance_fruits__variance_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-async-waterPercent-water_percent-variance-psycopg_async_engine]
  '''
  SELECT color.id,
         aggregation_0.variance_fruits__variance_water_percent AS variance_fruits__variance_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT variance(fruit_1.water_percent) AS variance_fruits__variance_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-rarity-rarity-avg-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_rarity AS avg_fruits__avg_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT avg(fruit_1.rarity) AS avg_fruits__avg_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-rarity-rarity-avg-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT avg(fruit_1.rarity) AS avg_fruits__avg_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_rarity AS avg_fruits__avg_rarity
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-rarity-rarity-stddev-psycopg_engine]
  '''
  SELECT color.id,
         aggregation_0.stddev_fruits__stddev_rarity AS stddev_fruits__stddev_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev(fruit_1.rarity) AS stddev_fruits__stddev_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-rarity-rarity-stddevPop-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_rarity AS stddev_pop_fruits__stddev_pop_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_pop(fruit_1.rarity) AS stddev_pop_fruits__stddev_pop_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-rarity-rarity-stddevSamp-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_rarity AS stddev_samp_fruits__stddev_samp_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_samp(fruit_1.rarity) AS stddev_samp_fruits__stddev_samp_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-rarity-rarity-varPop-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_rarity AS var_pop_fruits__var_pop_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT var_pop(fruit_1.rarity) AS var_pop_fruits__var_pop_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-rarity-rarity-varSamp-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_rarity AS var_samp_fruits__var_samp_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT var_samp(fruit_1.rarity) AS var_samp_fruits__var_samp_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-rarity-rarity-variance-psycopg_engine]
  '''
  SELECT color.id,
         aggregation_0.variance_fruits__variance_rarity AS variance_fruits__variance_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT variance(fruit_1.rarity) AS variance_fruits__variance_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-sweetness-sweetness-avg-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_sweetness AS avg_fruits__avg_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT avg(fruit_1.sweetness) AS avg_fruits__avg_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-sweetness-sweetness-avg-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT avg(fruit_1.sweetness) AS avg_fruits__avg_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_sweetness AS avg_fruits__avg_sweetness
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-sweetness-sweetness-stddev-psycopg_engine]
  '''
  SELECT color.id,
         aggregation_0.stddev_fruits__stddev_sweetness AS stddev_fruits__stddev_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev(fruit_1.sweetness) AS stddev_fruits__stddev_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-sweetness-sweetness-stddevPop-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_sweetness AS stddev_pop_fruits__stddev_pop_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_pop(fruit_1.sweetness) AS stddev_pop_fruits__stddev_pop_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-sweetness-sweetness-stddevSamp-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_sweetness AS stddev_samp_fruits__stddev_samp_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_samp(fruit_1.sweetness) AS stddev_samp_fruits__stddev_samp_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-sweetness-sweetness-varPop-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_sweetness AS var_pop_fruits__var_pop_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT var_pop(fruit_1.sweetness) AS var_pop_fruits__var_pop_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-sweetness-sweetness-varSamp-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_sweetness AS var_samp_fruits__var_samp_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT var_samp(fruit_1.sweetness) AS var_samp_fruits__var_samp_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-sweetness-sweetness-variance-psycopg_engine]
  '''
  SELECT color.id,
         aggregation_0.variance_fruits__variance_sweetness AS variance_fruits__variance_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT variance(fruit_1.sweetness) AS variance_fruits__variance_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-waterPercent-water_percent-avg-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_water_percent AS avg_fruits__avg_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT avg(fruit_1.water_percent) AS avg_fruits__avg_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-waterPercent-water_percent-avg-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT avg(fruit_1.water_percent) AS avg_fruits__avg_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.avg_fruits__avg_water_percent AS avg_fruits__avg_water_percent
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-waterPercent-water_percent-stddev-psycopg_engine]
  '''
  SELECT color.id,
         aggregation_0.stddev_fruits__stddev_water_percent AS stddev_fruits__stddev_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev(fruit_1.water_percent) AS stddev_fruits__stddev_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-waterPercent-water_percent-stddevPop-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_pop_fruits__stddev_pop_water_percent AS stddev_pop_fruits__stddev_pop_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_pop(fruit_1.water_percent) AS stddev_pop_fruits__stddev_pop_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-waterPercent-water_percent-stddevSamp-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.stddev_samp_fruits__stddev_samp_water_percent AS stddev_samp_fruits__stddev_samp_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT stddev_samp(fruit_1.water_percent) AS stddev_samp_fruits__stddev_samp_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-waterPercent-water_percent-varPop-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_pop_fruits__var_pop_water_percent AS var_pop_fruits__var_pop_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT var_pop(fruit_1.water_percent) AS var_pop_fruits__var_pop_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-waterPercent-water_percent-varSamp-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.var_samp_fruits__var_samp_water_percent AS var_samp_fruits__var_samp_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT var_samp(fruit_1.water_percent) AS var_samp_fruits__var_samp_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_statistical_aggregation[session-tracked-sync-waterPercent-water_percent-variance-psycopg_engine]
  '''
  SELECT color.id,
         aggregation_0.variance_fruits__variance_water_percent AS variance_fruits__variance_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT variance(fruit_1.water_percent) AS variance_fruits__variance_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-rarity-rarity-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT sum(fruit_1.rarity) AS sum_fruits__sum_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_rarity AS sum_fruits__sum_rarity
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-rarity-rarity-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT sum(fruit_1.rarity) AS sum_fruits__sum_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_rarity AS sum_fruits__sum_rarity
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-rarity-rarity-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_rarity AS sum_fruits__sum_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT sum(fruit_1.rarity) AS sum_fruits__sum_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-rarity-rarity-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_rarity AS sum_fruits__sum_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT sum(fruit_1.rarity) AS sum_fruits__sum_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-sweetness-sweetness-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT sum(fruit_1.sweetness) AS sum_fruits__sum_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_sweetness AS sum_fruits__sum_sweetness
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-sweetness-sweetness-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT sum(fruit_1.sweetness) AS sum_fruits__sum_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_sweetness AS sum_fruits__sum_sweetness
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-sweetness-sweetness-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_sweetness AS sum_fruits__sum_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT sum(fruit_1.sweetness) AS sum_fruits__sum_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-sweetness-sweetness-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_sweetness AS sum_fruits__sum_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT sum(fruit_1.sweetness) AS sum_fruits__sum_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-waterPercent-water_percent-aiosqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT sum(fruit_1.water_percent) AS sum_fruits__sum_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_water_percent AS sum_fruits__sum_water_percent
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-waterPercent-water_percent-asyncmy_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT sum(fruit_1.water_percent) AS sum_fruits__sum_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_water_percent AS sum_fruits__sum_water_percent
    FROM color AS color
   INNER JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = %s
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-waterPercent-water_percent-asyncpg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_water_percent AS sum_fruits__sum_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT sum(fruit_1.water_percent) AS sum_fruits__sum_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = $1::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-async-waterPercent-water_percent-psycopg_async_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_water_percent AS sum_fruits__sum_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT sum(fruit_1.water_percent) AS sum_fruits__sum_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-sync-rarity-rarity-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_rarity AS sum_fruits__sum_rarity
    FROM color AS color
    JOIN LATERAL (
          SELECT sum(fruit_1.rarity) AS sum_fruits__sum_rarity
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-sync-rarity-rarity-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT sum(fruit_1.rarity) AS sum_fruits__sum_rarity,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_rarity AS sum_fruits__sum_rarity
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-sync-sweetness-sweetness-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_sweetness AS sum_fruits__sum_sweetness
    FROM color AS color
    JOIN LATERAL (
          SELECT sum(fruit_1.sweetness) AS sum_fruits__sum_sweetness
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-sync-sweetness-sweetness-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT sum(fruit_1.sweetness) AS sum_fruits__sum_sweetness,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_sweetness AS sum_fruits__sum_sweetness
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-sync-waterPercent-water_percent-psycopg_engine]
  '''
  SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_water_percent AS sum_fruits__sum_water_percent
    FROM color AS color
    JOIN LATERAL (
          SELECT sum(fruit_1.water_percent) AS sum_fruits__sum_water_percent
            FROM fruit AS fruit_1
           WHERE color.id = fruit_1.color_id
         ) AS __strawchemy_aggregation_0
      ON TRUE
   WHERE color.id = %(id_1)s::INTEGER
   ORDER BY color.id ASC
  '''
# ---
# name: test_sum_aggregation[session-tracked-sync-waterPercent-water_percent-sqlite_engine]
  '''
  WITH __strawchemy_aggregation_0 AS (
          SELECT sum(fruit_1.water_percent) AS sum_fruits__sum_water_percent,
                 fruit_1.color_id AS color_id
            FROM fruit AS fruit_1
           WHERE fruit_1.color_id IS NOT NULL
           GROUP BY fruit_1.color_id
         ) SELECT color.id,
         __strawchemy_aggregation_0.sum_fruits__sum_water_percent AS sum_fruits__sum_water_percent
    FROM color AS color
    JOIN __strawchemy_aggregation_0
      ON color.id = __strawchemy_aggregation_0.color_id
   WHERE color.id = ?
   ORDER BY color.id ASC
  '''
# ---
