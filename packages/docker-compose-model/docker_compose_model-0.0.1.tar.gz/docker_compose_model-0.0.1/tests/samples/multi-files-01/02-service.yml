---
services:
  data-model-migration:
    annotations:
      - nfo=Tuned analytics for SaaS customers
    depends_on:
      postgres:
        condition: service_healthy
      da:
        condition: service_healthy
    deploy:
      resources:
        limits:
          memory: 3G
    environment:
      DATABASE_URL: postgresql://${POSTGRES_USER:-pguser}:${POSTGRES_PASSWORD?}@${POSTGRES_HOST:-postgres}/${POSTGRES_DB:-pgdb}
    expose:
      - '5000'
    image: my-service:4.5.6
    labels:
      - prometheus.port=5000
      - prometheus.scrape=true
    logging:
      driver: json-file
      options:
        max-file: '5'
        max-size: 10m
    restart: always
    volumes:
      - ./volumes/data/:/mnt/data
      - ./volumes/bundle/raven:/mnt/data/bundle
      - /etc/ssh/ssh_pelico_app_id_rsa:/mnt/data/ssh_id_rsa
