# workflow-execution-parameters.yaml

body:
  name: new-workflow
  triggers:
    - cron: 0 0 * * *
  steps:
    step-1:
      type: standard
      imageId: 100
      imageVersionId: 100
      command: python script1.py > output.txt
      resources:
        instanceTypeId: 21
        storage: 10GB
      parents: []
      stepTimeout: 30
      clearImageCache: true
      repository:
        branch: main
        token: random_token
        url: "https://github.com/org/repo"
      outputParameters:
        scriptOutput: output.txt
    step-2:
      type: standard
      imageId: 100
      imageVersionId: 100
      command: python script2.py
      resources:
        instanceTypeId: 21
        storage: 10GB
      parents:
        - step-1
      stepTimeout: 30
      clearImageCache: true
      repository:
        branch: main
        token: random_token
        url: "https://github.com/org/repo"
      executionParameters:
        conditional:
          - condition: equals
            paramName: scriptOutput
            stepName: step-1
            value: output-value
        parentStatus:
          - condition: one-of
            parents:
              - step-1
            status:
              - success
    step-3:
      type: http
      parents:
        - step-1
      url: "https://peak.ai"
      payload: "{}"
      auth:
        type: bearer-token
        bearerToken: token
      headers:
        absolute:
          Content-Type: application/json
      executionParameters:
        conditional:
          - condition: equals
            paramName: scriptOutput
            stepName: step-1
            value: output-value
        parentStatus:
          - condition: all-of
            parents:
              - step-1
            status:
              - success
    step-4:
      type: sql
      repository:
        branch: main
        token: random_token
        url: "https://example.com"
        filePath: "path/to/file.sql"
      parameters:
        env:
          key1: value1
          key2: value2
        inherit:
          key3: value3
          key4: value4
      executionParameters:
        conditional:
          - condition: equals
            paramName: scriptOutput
            stepName: step-1
            value: output-value
        parentStatus:
          - condition: all-of
            parents:
              - step-1
            status:
              - success
    step-5:
      type: export
      schema: schema_name
      table: table_name
      sortBy: column_name
      sortOrder: asc
      compression: false
      executionParameters:
        parentStatus:
          - condition: all-of
            parents:
              - step-4
            status:
              - success
