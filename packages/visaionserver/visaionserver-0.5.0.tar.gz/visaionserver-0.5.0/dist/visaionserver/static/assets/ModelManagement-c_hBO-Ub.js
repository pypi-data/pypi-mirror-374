import{d as V,s as q,r as k,W as O,X as W,c as C,b as m,e as r,B as Q,a4 as X,m as h,w as o,g as b,q as c,t as w,P as D,Q as T,A as z,j as n,h as H,a3 as K,M as Y,o as f}from"./index-DeXzsHYB.js";import{a as Z,b as tt,r as et,j as at,d as st}from"./all-DeDzFpLI.js";import{J as p,E as _}from"./const-DgT7xBJS.js";import{u as lt}from"./model-CscD02Wt.js";import{_ as ot}from"./_plugin-vue_export-helper-DlAUqK2U.js";const nt={class:"model-management-container"},rt={class:"model-management-content"},it={class:"min-h-screen bg-gray-50 px-6 py-8"},dt={class:"mx-auto max-w-7xl"},ut={class:"flex items-center"},ct={class:"flex flex-wrap gap-2"},pt={class:"flex flex-wrap gap-2"},_t={class:"flex items-center gap-2"},mt=V({__name:"ModelManagement",setup(ft){const y=q(),M=lt(),E=H(),I=k(0),N=k(!1);let P=null;const v=k([]),L=t=>{S(t)},U=t=>({未开始1:"info",已完成1:"success",已终止:"danger",运行中1:""})[t],G=t=>{M.setModel(t),E.push({path:"/sample/modeldetail",query:{jid:t.id}})},J=t=>{M.setModel(t),E.push({path:"/model/updateModel",query:{jid:t.id}})},B=()=>{var s;let t=[],e=v.value;if(!(!e||e.length===0)){for(let u=0;u<e.length;u++){const l=e[u];(!l.status||l.status in[1,2,3,4,5])&&t.push(l.id),(l.status==="运行中"||l.status==="等待中"||l.isStart)&&t.push(l.id)}t.length!==0&&Z({project_id:(s=y.currentProject)==null?void 0:s.id,job_ids:t,job_type:"train"}).then(u=>{var x;let l=[],g=(x=u.data)==null?void 0:x.data;v.value.forEach(i=>{i.status||(i.status=p[1]),g&&g[i.id]!==void 0&&(i.status=p[g[i.id]],_.PENDING==g[i.id]||g[i.id]==_.RUNNING?i.isStart=!0:i.isStart=!1),l.push(i)}),v.value=l})}};let j;const R=t=>{var e;console.log(t),(e=y.currentProject)==null||e.id,t.id,t.param,j=K.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),et({id:t.id,job_type:"train"}).then(s=>{j.close(),t.isStart=!0}).catch(s=>{j.close()})},$=t=>{var e;at({project_id:(e=y.currentProject)==null?void 0:e.id,job_id:t.id,job_type:"train"}).then(s=>{t.isStart=!1})},S=t=>{var e;N.value=!0,tt({page:t,size:10,project_id:(e=y.currentProject)==null?void 0:e.id}).then(s=>{v.value=s.data.data,I.value=s.data.total,B()}).finally(()=>{N.value=!1})},A=t=>{Y.confirm("确定删除么?","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{st(t.id).then(e=>{S(1)})})};return O(()=>{console.log("mounterd"),S(1),P=setInterval(B,1800)}),W(()=>{clearInterval(P)}),(t,e)=>{const s=b("el-table-column"),u=b("el-tag"),l=b("el-button"),g=b("el-table"),x=b("el-pagination"),i=b("el-row"),F=X("loading");return f(),C("div",nt,[m("div",rt,[e[5]||(e[5]=m("h2",{class:"page-title",style:{width:"90px",float:"left"}},"模型管理 ",-1)),m("div",it,[m("div",dt,[Q((f(),h(g,{data:v.value,class:"w-full","element-loading-text":"加载中..."},{default:o(()=>[r(s,{prop:"name",label:"训练名称","min-width":"180"}),r(s,{prop:"status",label:"训练状态",width:"120"},{default:o(({row:a})=>[m("div",ut,[r(u,{type:U(a.status),effect:"light",size:"small",class:"whitespace-nowrap"},{default:o(()=>[c(w(a.status),1)]),_:2},1032,["type"])])]),_:1}),r(s,{label:"训练集","min-width":"180"},{default:o(({row:a})=>[m("div",ct,[(f(!0),C(D,null,T(a.train_sets,d=>(f(),h(u,{key:d,size:"small",effect:"plain"},{default:o(()=>[c(w(d),1)]),_:2},1024))),128))])]),_:1}),r(s,{label:"验证集","min-width":"180"},{default:o(({row:a})=>[m("div",pt,[(f(!0),C(D,null,T(a.val_sets,d=>(f(),h(u,{key:d,size:"small",effect:"plain"},{default:o(()=>[c(w(d),1)]),_:2},1024))),128))])]),_:1}),r(s,{label:"创建人",width:"120"},{default:o(a=>[c(w(a.row.username),1)]),_:1}),r(s,{prop:"create_time",label:"创建时间",width:"180"}),r(s,{fixed:"right",label:"操作",width:"200"},{default:o(a=>[m("div",_t,[r(l,{text:"",size:"small",type:"primary",style:{padding:"0"},onClick:d=>G(a.row)},{default:o(()=>e[0]||(e[0]=[c(" 详情 ")])),_:2},1032,["onClick"]),r(l,{disabled:a.row.status==n(p)[n(_).PENDING]||a.row.status==n(p)[n(_).RUNNING]||a.row.status==n(p)[n(_).COMPLETED],text:"",size:"small",type:"primary",style:{padding:"0"},onClick:d=>J(a.row)},{default:o(()=>e[1]||(e[1]=[c(" 修改 ")])),_:2},1032,["disabled","onClick"]),a.row.isStart?z("",!0):(f(),h(l,{key:0,disabled:a.row.status==n(p)[n(_).PENDING]||a.row.status==n(p)[n(_).RUNNING],text:"",size:"small",type:"primary",style:{padding:"0"},onClick:d=>R(a.row)},{default:o(()=>e[2]||(e[2]=[c(" 启动 ")])),_:2},1032,["disabled","onClick"])),a.row.isStart?(f(),h(l,{key:1,text:"",size:"small",type:"danger",style:{padding:"0"},onClick:d=>$(a.row)},{default:o(()=>e[3]||(e[3]=[c(" 停止 ")])),_:2},1032,["onClick"])):z("",!0),r(l,{disabled:a.row.status==n(p)[n(_).PENDING]||a.row.status==n(p)[n(_).RUNNING],text:"",size:"small",type:"danger",onClick:d=>A(a.row)},{default:o(()=>e[4]||(e[4]=[c(" 删除 ")])),_:2},1032,["disabled","onClick"])])]),_:1})]),_:1},8,["data"])),[[F,N.value]]),r(x,{style:{"margin-top":"8px"},background:"",layout:"prev, pager, next",total:I.value,onCurrentChange:L},null,8,["total"])])]),r(i)])])}}}),xt=ot(mt,[["__scopeId","data-v-8fec6a9a"]]);export{xt as default};
//# sourceMappingURL=ModelManagement-c_hBO-Ub.js.map
