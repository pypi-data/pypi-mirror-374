import{d as X,s as H,r as M,W as K,X as Y,c as E,b as _,e as n,B as Z,a4 as tt,m as w,w as o,g as u,q as c,t as x,P,Q as D,A as L,j as i,V as et,h as at,a3 as ot,M as nt,o as m}from"./index-o9GSe-j3.js";import{a as lt,b as st,r as rt,j as dt,d as it}from"./all-Bn4xrjUW.js";import{J as g,E as b}from"./const-DgT7xBJS.js";import{u as ut}from"./model-D63OprUB.js";import{_ as ct}from"./_plugin-vue_export-helper-DlAUqK2U.js";const pt={class:"model-management-container"},_t={class:"model-management-content"},mt={class:"min-h-screen bg-gray-50 px-6 py-8"},ft={class:"mx-auto max-w-7xl"},gt={class:"flex items-center"},bt={class:"flex flex-wrap gap-2"},vt={class:"flex flex-wrap gap-2"},ht={class:"flex items-center gap-2"},wt={class:"el-dropdown-link"},yt=X({__name:"ModelManagement",setup(xt){const y=H(),j=ut(),k=at(),T=M(0),S=M(!1);let B=null;const v=M([]),z=t=>{N(t)},U=t=>({未开始1:"info",已完成1:"success",已终止:"danger",运行中1:""})[t],G=t=>{j.setModel(t),k.push({path:"/sample/modeldetail",query:{jid:t.id}})},J=t=>{j.setModel(t),k.push({path:"/sample/training",query:{from:"clone"}})},$=t=>{j.setModel(t),k.push({path:"/model/updateModel",query:{jid:t.id}})},I=()=>{var l;let t=[],e=v.value;if(!(!e||e.length===0)){for(let p=0;p<e.length;p++){const s=e[p];(!s.status||s.status in[1,2,3,4,5])&&t.push(s.id),(s.status==="运行中"||s.status==="等待中"||s.isStart)&&t.push(s.id)}t.length!==0&&lt({project_id:(l=y.currentProject)==null?void 0:l.id,job_ids:t,job_type:"train"}).then(p=>{var h;let s=[],f=(h=p.data)==null?void 0:h.data;v.value.forEach(r=>{r.status||(r.status=g[1]),f&&f[r.id]!==void 0&&(r.status=g[f[r.id]],b.PENDING==f[r.id]||f[r.id]==b.RUNNING?r.isStart=!0:r.isStart=!1),s.push(r)}),v.value=s})}};let C;const V=t=>{var e;console.log(t),(e=y.currentProject)==null||e.id,t.id,t.param,C=ot.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),rt({id:t.id,job_type:"train"}).then(l=>{C.close(),t.isStart=!0}).catch(l=>{C.close()})},q=t=>{var e;dt({project_id:(e=y.currentProject)==null?void 0:e.id,job_id:t.id,job_type:"train"}).then(l=>{t.isStart=!1})},N=t=>{var e;S.value=!0,st({page:t,size:10,project_id:(e=y.currentProject)==null?void 0:e.id}).then(l=>{v.value=l.data.data,T.value=l.data.total,I()}).finally(()=>{S.value=!1})},A=t=>{nt.confirm("确定删除么?","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{it(t.id).then(e=>{N(1)})})};return K(()=>{console.log("mounterd"),N(1),B=setInterval(I,1800)}),Y(()=>{clearInterval(B)}),(t,e)=>{const l=u("el-table-column"),p=u("el-tag"),s=u("el-button"),f=u("el-icon"),h=u("el-dropdown-item"),r=u("el-dropdown-menu"),F=u("el-dropdown"),R=u("el-table"),O=u("el-pagination"),W=u("el-row"),Q=tt("loading");return m(),E("div",pt,[_("div",_t,[e[6]||(e[6]=_("h2",{class:"page-title",style:{width:"90px",float:"left"}},"模型管理 ",-1)),_("div",mt,[_("div",ft,[Z((m(),w(R,{data:v.value,class:"w-full","element-loading-text":"加载中..."},{default:o(()=>[n(l,{prop:"name",label:"训练名称","min-width":"180"}),n(l,{prop:"status",label:"训练状态",width:"120"},{default:o(({row:a})=>[_("div",gt,[n(p,{type:U(a.status),effect:"light",size:"small",class:"whitespace-nowrap"},{default:o(()=>[c(x(a.status),1)]),_:2},1032,["type"])])]),_:1}),n(l,{label:"训练集","min-width":"180"},{default:o(({row:a})=>[_("div",bt,[(m(!0),E(P,null,D(a.train_sets,d=>(m(),w(p,{key:d,size:"small",effect:"plain"},{default:o(()=>[c(x(d),1)]),_:2},1024))),128))])]),_:1}),n(l,{label:"验证集","min-width":"180"},{default:o(({row:a})=>[_("div",vt,[(m(!0),E(P,null,D(a.val_sets,d=>(m(),w(p,{key:d,size:"small",effect:"plain"},{default:o(()=>[c(x(d),1)]),_:2},1024))),128))])]),_:1}),n(l,{label:"创建人",width:"120"},{default:o(a=>[c(x(a.row.username),1)]),_:1}),n(l,{prop:"create_time",label:"创建时间",width:"180"}),n(l,{fixed:"right",label:"操作",width:"200"},{default:o(a=>[_("div",ht,[n(s,{text:"",size:"small",type:"primary",style:{padding:"0"},onClick:d=>G(a.row)},{default:o(()=>e[0]||(e[0]=[c(" 详情 ")])),_:2},1032,["onClick"]),n(s,{disabled:a.row.status==i(g)[i(b).PENDING]||a.row.status==i(g)[i(b).RUNNING]||a.row.status==i(g)[i(b).COMPLETED],text:"",size:"small",type:"primary",style:{padding:"0"},onClick:d=>$(a.row)},{default:o(()=>e[1]||(e[1]=[c(" 修改 ")])),_:2},1032,["disabled","onClick"]),a.row.isStart?L("",!0):(m(),w(s,{key:0,disabled:a.row.status==i(g)[i(b).PENDING]||a.row.status==i(g)[i(b).RUNNING],text:"",size:"small",type:"primary",style:{padding:"0"},onClick:d=>V(a.row)},{default:o(()=>e[2]||(e[2]=[c(" 启动 ")])),_:2},1032,["disabled","onClick"])),a.row.isStart?(m(),w(s,{key:1,text:"",size:"small",type:"danger",style:{padding:"0"},onClick:d=>q(a.row)},{default:o(()=>e[3]||(e[3]=[c(" 停止 ")])),_:2},1032,["onClick"])):L("",!0),n(F,{style:{"margin-left":"8px"}},{dropdown:o(()=>[n(r,null,{default:o(()=>[n(h,{onClick:d=>A(a.row)},{default:o(()=>e[4]||(e[4]=[c("删除")])),_:2},1032,["onClick"]),n(h,{onClick:d=>J(a.row)},{default:o(()=>e[5]||(e[5]=[c("克隆")])),_:2},1032,["onClick"])]),_:2},1024)]),default:o(()=>[_("span",wt,[n(f,{style:{color:"blue","margin-top":"6px"}},{default:o(()=>[n(i(et))]),_:1})])]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[Q,S.value]]),n(O,{style:{"margin-top":"8px"},background:"",layout:"prev, pager, next",total:T.value,onCurrentChange:z},null,8,["total"])])]),n(W)])])}}}),Mt=ct(yt,[["__scopeId","data-v-ae1106e7"]]);export{Mt as default};
//# sourceMappingURL=ModelManagement-kxY5NRKW.js.map
