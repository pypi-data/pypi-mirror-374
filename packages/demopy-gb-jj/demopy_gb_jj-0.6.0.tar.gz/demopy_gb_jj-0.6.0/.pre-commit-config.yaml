# Pre-commit hooks configuration for demopy_gb_jj
# Install with: pip install pre-commit && pre-commit install

repos:
  # Rust formatting and linting
  - repo: local
    hooks:
      - id: cargo-fmt
        name: Cargo format
        description: Format Rust code with cargo fmt
        entry: cargo fmt --all --
        language: system
        files: \.rs$
        pass_filenames: false
      
      - id: cargo-clippy
        name: Cargo clippy
        description: Lint Rust code with cargo clippy
        entry: cargo clippy --all-targets --all-features -- -D warnings
        language: system
        files: \.rs$
        pass_filenames: false
      
      - id: cargo-test
        name: Cargo test
        description: Run Rust tests
        entry: cargo test
        language: system
        files: \.rs$
        pass_filenames: false

  # Python formatting and linting
  - repo: https://github.com/psf/black
    rev: 24.10.0
    hooks:
      - id: black
        name: Black Python formatter
        description: Format Python code with Black
        files: ^(python|tests|scripts)/.*\.py$
        args: [--line-length=88]

  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort
        name: isort Python import sorter
        description: Sort Python imports with isort
        files: ^(python|tests|scripts)/.*\.py$
        args: [--profile=black, --line-length=88]

  - repo: https://github.com/pycqa/flake8
    rev: 7.1.1
    hooks:
      - id: flake8
        name: Flake8 Python linter
        description: Lint Python code with flake8
        files: ^(python|tests|scripts)/.*\.py$
        args: [--max-line-length=88, --extend-ignore=E203,W503]

  # Python type checking
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.13.0
    hooks:
      - id: mypy
        name: MyPy static type checker
        description: Static type checking for Python
        files: ^(python|tests|scripts)/.*\.py$
        args: [--ignore-missing-imports, --no-strict-optional]
        additional_dependencies: [types-all]

  # General file formatting
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: trailing-whitespace
        name: Trim trailing whitespace
        description: Remove trailing whitespace
      
      - id: end-of-file-fixer
        name: Fix end of files
        description: Ensure files end with a newline
      
      - id: check-yaml
        name: Check YAML
        description: Validate YAML files
        files: \.(yaml|yml)$
      
      - id: check-toml
        name: Check TOML
        description: Validate TOML files
        files: \.toml$
      
      - id: check-merge-conflict
        name: Check for merge conflicts
        description: Check for merge conflict markers
      
      - id: check-added-large-files
        name: Check for large files
        description: Prevent large files from being committed
        args: [--maxkb=1000]

  # Markdown formatting
  - repo: https://github.com/igorshubovych/markdownlint-cli
    rev: v0.42.0
    hooks:
      - id: markdownlint
        name: Markdown lint
        description: Lint Markdown files
        files: \.md$
        args: [--fix]

# Configuration for specific tools
default_language_version:
  python: python3

# Skip certain hooks for specific files
exclude: |
  (?x)^(
    \.venv/.*|
    target/.*|
    \.git/.*|
    __pycache__/.*|
    \.pytest_cache/.*
  )$
