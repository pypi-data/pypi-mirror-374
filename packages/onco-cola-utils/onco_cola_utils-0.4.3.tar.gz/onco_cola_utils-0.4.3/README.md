# ExcelDataProcessor

–ú–æ—â–Ω—ã–π –∏ –≥–∏–±–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏, –∞–Ω–∞–ª–∏–∑–∞ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ Excel-—Ñ–∞–π–ª–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ —É–¥–æ–±–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä. –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî `ReaderController` ‚Äî –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å XLS(X) —Ñ–∞–π–ª–∞–º–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–º–∏ —Ç–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –ò–ò-–º–æ–¥–µ–ª–µ–π.

---

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ **–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Excel (xls/xlsx)**: —á—Ç–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –ª–∏—Å—Ç–æ–≤
- üîç **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –Ω—É–∂–Ω–æ–≥–æ –ª–∏—Å—Ç–∞** –ø–æ –∫–ª—é—á–µ–≤—ã–º –ø–æ–ª—è–º (`source_name`, `url`)
- üßπ **–û—á–∏—Å—Ç–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: —É–¥–∞–ª–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫, —Ä–∞–±–æ—Ç–∞ —Å TTL-–∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- üî¢ **–õ–æ–∫–∞–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ç—Ä–æ–∫** —á–µ—Ä–µ–∑ `local_id` (—É—Å—Ç–æ–π—á–∏–≤–∞—è –∫ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—è–º)
- üîÑ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ ID**: –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–ª–∏—è–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ò–ò-–æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å –∏—Å—Ö–æ–¥–Ω—ã–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–º
- üõ°Ô∏è **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫**: –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
- üìÑ **–≠–∫—Å–ø–æ—Ä—Ç –≤ CSV**: –≥–∏–±–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
- üßæ **–ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä**: –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ pretty-print –¥–ª—è —Å–ª–æ–≤–∞—Ä–µ–π, —Å–ø–∏—Å–∫–æ–≤ –∏ dataclass
- üìã **–¶–≤–µ—Ç–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `loguru`, —É–¥–æ–±–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–æ–≤ (DEBUG, INFO, SUCCESS, ERROR)

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–≠—Ç–æ—Ç –ø–∞–∫–µ—Ç –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –º–æ–¥—É–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–æ—Å—Ç–∞–≤–µ larger ETL- –∏–ª–∏ AI-–ø—Ä–æ–µ–∫—Ç–∞). –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```bash
pip install pandas openpyxl loguru deprecated
```

> ‚ö†Ô∏è –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã **–Ω–µ –æ—Ç–∫—Ä—ã—Ç—ã –≤ Excel**, –∏–Ω–∞—á–µ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏.

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```python
from onco_cola_utils.reader_controller.core import ReaderController
from pathlib import Path

# –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
input_file = Path("data/input.xlsx")
output_file = Path("data/output.xlsx")

# –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
reader = ReaderController(file_path=input_file, file_output=output_file)

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –Ω—É–∂–Ω—ã–π –ª–∏—Å—Ç –∏ —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
reader.read_data()

# –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
clean_data = reader.perfect_data(reader.get_data())

# –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–µ –∏–∑ –ò–ò-–æ—Ç–≤–µ—Ç–∞
ai_response = [
    {"ID": "1", "category_asis": "Electronics", "remark": "1"},
    {"ID": "2", "category_asis": "Books", "remark": None},
]

# –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
reader.update_dataframe_from_updated_dataframe(
    updated_dataframe={1: ai_response[0], 2: ai_response[1]},
    updated_fields=["category_asis", "remark"]
)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
reader.update_file()
```

---

## API-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### `ReaderController(file_path, file_output, is_new=False, skip_rows=0)`

–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Excel-—Ñ–∞–π–ª–∞–º–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `file_path` (`Path`): –ø—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É.
- `file_output` (`Path`): –ø—É—Ç—å –∫ –≤—ã—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É (–º–æ–∂–µ—Ç —Å–æ–≤–ø–∞–¥–∞—Ç—å).
- `is_new` (`bool`): —Ñ–ª–∞–≥, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, —á—Ç–æ —Ñ–∞–π–ª –Ω–æ–≤—ã–π (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ).
- `skip_rows` (`int`): –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞–ø—Ä—è–º—É—é, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–æ).

**–ü—Ä–∏–º–µ—Ä:**
```python
rc = ReaderController(Path("in.xlsx"), Path("out.xlsx"))
```

---

### `read_data(sheet_name=None) -> None`

–ß–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel-–ª–∏—Å—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Å–ø–∏—Å–∫–∞ —Å–ª–æ–≤–∞—Ä–µ–π. –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ —Å—Ç—Ä–æ–∫–∏ (—Å –æ–±—Ä–µ–∑–∞–Ω–∏–µ–º `.0` —É —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª).

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `sheet_name` (`str | None`): –∏–º—è –ª–∏—Å—Ç–∞. –ï—Å–ª–∏ `None` ‚Äî —á–∏—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –ª–∏—Å—Ç.

**–ü—Ä–∏–º–µ—Ä:**
```python
reader.read_data(sheet_name="Sheet1")
```

---

### `get_data(sheet_name=None) -> list[dict]`

–õ–µ–Ω–∏–≤–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç `read_data()`.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `list[dict]`: —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫ –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä–µ–π (–∫–ª—é—á ‚Äî –∏–º—è —Å—Ç–æ–ª–±—Ü–∞).

**–ü—Ä–∏–º–µ—Ä:**
```python
data = reader.get_data()
```

---

### `perfect_data(data_list) -> dict`

–§–∏–ª—å—Ç—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ, —É–¥–∞–ª—è—è —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–æ–ª–µ `DATA_ENTITY_TOBE` —è–≤–ª—è–µ—Ç—Å—è "–Ω—É–ª–µ–≤—ã–º" (—Å–æ–≥–ª–∞—Å–Ω–æ `System.NULLED`).

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `data_list` (`list[dict]`): –≤—Ö–æ–¥–Ω–æ–π —Å–ø–∏—Å–æ–∫ –¥–∞–Ω–Ω—ã—Ö.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `dict`: —Å–ª–æ–≤–∞—Ä—å, –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `local_id`.

**–ü—Ä–∏–º–µ—Ä:**
```python
filtered = reader.perfect_data(reader.get_data())
```

---

### `local_idfy(data_list) -> dict`

–ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ `local_id` –∏–∑ –¥–∞–Ω–Ω—ã—Ö.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `data_list` (`list[dict]`): —Å–ø–∏—Å–æ–∫ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–ª–µ–º `local_id`.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `dict`: —Å–ª–æ–≤–∞—Ä—å –≤–∏–¥–∞ `{local_id: row_data}`.

**–ü—Ä–∏–º–µ—Ä:**
```python
idfy_data = reader.local_idfy(data_list)
```

---

### `cycle_right_sheet() -> None`

–¶–∏–∫–ª–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç –ø–µ—Ä–≤—ã–µ –ª–∏—Å—Ç—ã Excel-—Ñ–∞–π–ª–∞, –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥—ë—Ç –ª–∏—Å—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –ø–æ–ª—è `source_name` –∏ `url`.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ü–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–ª—É–∂–µ–±–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª –±–µ–∑ –Ω–µ–Ω—É–∂–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤.

**–ü—Ä–∏–º–µ—Ä:**
```python
reader.cycle_right_sheet()  # –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ check_local_id
```

---

### `check_local_id(find_it=True) -> bool`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ –ø–µ—Ä–≤—ã–π –ª–∏—Å—Ç –ø–æ–ª–µ `local_id`. –ü–µ—Ä–µ–¥ —ç—Ç–∏–º –∑–∞–ø—É—Å–∫–∞–µ—Ç `cycle_right_sheet`.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `find_it` (`bool`): –µ—Å–ª–∏ `True`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ `local_id`; –∏–Ω–∞—á–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ª–∏—Å—Ç–∞.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `bool`: `True`, –µ—Å–ª–∏ `local_id` –Ω–∞–π–¥–µ–Ω.

**–ü—Ä–∏–º–µ—Ä:**
```python
if not reader.check_local_id():
    reader.process_local_idfying()
```

---

### `process_local_idfying(field=ColumnStrings.DATA_LOCAL_ID) -> None`

–î–æ–±–∞–≤–ª—è–µ—Ç `local_id` (1, 2, 3...) –∫ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª.

**–ü—Ä–∏–º–µ—Ä:**
```python
reader.process_local_idfying()
```

---

### `update_dataframe_from_updated_dataframe(updated_dataframe, updated_fields, field_id="ID") -> bool | None`

–û–±–Ω–æ–≤–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–æ–≤–∞—Ä—è –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–≤–µ—Ç–∞ –ò–ò).

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `updated_dataframe` (`dict[int, dict]`): —Å–ª–æ–≤–∞—Ä—å `{ID: {field: value}}`.
- `updated_fields` (`list[str]`): —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.
- `field_id` (`str`): –∫–ª—é—á, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è —Å—Ç—Ä–æ–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `"ID"`).

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `True` –ø—Ä–∏ —É—Å–ø–µ—Ö–µ, `None` –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö.

**–ü—Ä–∏–º–µ—Ä:**
```python
reader.update_dataframe_from_updated_dataframe(
    updated_dataframe={1: {"cat_asis": "NewCat"}},
    updated_fields=["cat_asis"]
)
```

---

### `update_file(same_file=True) -> bool`

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –æ–±—Ä–∞—Ç–Ω–æ –≤ Excel.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `same_file` (`bool`): –µ—Å–ª–∏ `True`, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç `file_path`, –∏–Ω–∞—á–µ ‚Äî `file_output`.

**–ü—Ä–∏–º–µ—Ä:**
```python
reader.update_file(same_file=False)  # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ output
```

---

### `save_to_csv(same_file=True) -> bool`

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `same_file` (`bool`): –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `file_path` –∏–ª–∏ `file_output`.

**–ü—Ä–∏–º–µ—Ä:**
```python
reader.save_to_csv()
```

---

### `rename(new_name, same_file=True) -> bool`

–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç —Ñ–∞–π–ª.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `new_name` (`str`): –Ω–æ–≤–æ–µ –∏–º—è –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.
- `same_file` (`bool`): –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω–æ–π –∏–ª–∏ –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª.

**–ü—Ä–∏–º–µ—Ä:**
```python
reader.rename("processed_data")
```

---

### `get_asis_fields() -> list[str]`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö `_asis`.

**–ü—Ä–∏–º–µ—Ä:**
```python
asis_cols = reader.get_asis_fields()
```

---

### `get_tobe_fields() -> list[str]`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö `_tobe`.

**–ü—Ä–∏–º–µ—Ä:**
```python
tobe_cols = reader.get_tobe_fields()
```

---

### `idfy_to_dataframe(idfy_data) -> list[dict]`

–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç `idfy`-—Å–ª–æ–≤–∞—Ä—å –æ–±—Ä–∞—Ç–Ω–æ –≤ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π (—Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞).

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `idfy_data` (`dict`): —Å–ª–æ–≤–∞—Ä—å –≤–∏–¥–∞ `{ID: data}`.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `list[dict]`: –≥–æ—Ç–æ–≤—ã–π –¥–ª—è `DataFrame` —Å–ø–∏—Å–æ–∫.

---

## pretty_print(obj, title='PRETTY_PRINT', m2d=False, outputter=log)

–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ —Å–ª–æ–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (—Å–ª–æ–≤–∞—Ä–∏, —Å–ø–∏—Å–∫–∏, dataclass).

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `obj`: –æ–±—ä–µ–∫—Ç –¥–ª—è –≤—ã–≤–æ–¥–∞.
- `title` (`str`): –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ª–æ–≥–∞.
- `m2d` (`bool`): –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –≤ —Å–ª–æ–≤–∞—Ä—å (—á–µ—Ä–µ–∑ `model_to_dict`) –ø–µ—Ä–µ–¥ –≤—ã–≤–æ–¥–æ–º.
- `outputter` (`callable`): —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `log`).

**–ü—Ä–∏–º–µ—Ä:**
```python
from your_package.pretty_print.core import pretty_print

pretty_print({"a": 1, "b": {"c": 2}}, title="DATA")
# –í—ã–≤–æ–¥:
# PRETTY_PRINT
# dict(
#     a='1',
#     b=dict(
#         c='2',
#     ),
# )
```

---

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `loguru` —Å —Ü–≤–µ—Ç–Ω—ã–º –≤—ã–≤–æ–¥–æ–º –∏ —É—Ä–æ–≤–Ω—è–º–∏:

| –£—Ä–æ–≤–µ–Ω—å | –§—É–Ω–∫—Ü–∏—è | –¶–≤–µ—Ç |
|--------|--------|------|
| DEBUG | `log("msg")` | –ë–µ–ª—ã–π |
| INFO | `loginf("msg")` | –°–∏–Ω–∏–π |
| SUCCESS | `logsuc("msg")` | –ó–µ–ª—ë–Ω—ã–π |
| ERROR | `logerr("msg")` | –ö—Ä–∞—Å–Ω—ã–π |

**–ü—Ä–∏–º–µ—Ä:**
```python
logsuc("–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω")
logerr("–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö")
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (–≤ `configs/system.py`)

- `System.NULLED`: –∑–Ω–∞—á–µ–Ω–∏—è, —Å—á–∏—Ç–∞–µ–º—ã–µ "–ø—É—Å—Ç—ã–º–∏" (–Ω–∞–ø—Ä–∏–º–µ—Ä, `["", "0", "none"]`).
- `System.FULL_SKIP`: –∑–Ω–∞—á–µ–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–æ–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è.
- `System.ID`: –∏–º—è –ø–æ–ª—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è ID (`"ID"`).

### –°—Ç—Ä–æ–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ (–≤ `configs/column_strings.py`)

- `ColumnStrings.DATA_LOCAL_ID`: –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ `local_id`.
- `ColumnStrings.DATA_SOURCE_NAME`: –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ `source_name`.
- `ColumnStrings.DATA_URL`: –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ `url`.
- `ColumnStrings.RMK`: –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ –¥–ª—è –∑–∞–º–µ—Ç–æ–∫ (`remark`).
- `ColumnStrings.DATA_ENTITY_TOBE`: –ø–æ–ª–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ "–Ω—É–ª–µ–≤–æ–µ" –∑–Ω–∞—á–µ–Ω–∏–µ.

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```txt
pandas>=1.3.0
openpyxl>=3.0.0
loguru>=0.7.0
deprecated>=1.2.0
```

> –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Excel-—Ñ–∞–π–ª—ã **–Ω–µ –æ—Ç–∫—Ä—ã—Ç—ã –≤ Excel** –≤–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ `PermissionError`.

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

UNLICENSED (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø—Ä–æ–µ–∫—Ç). –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ.

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- `WrongSheetListError`: –Ω–∏ –æ–¥–∏–Ω –ª–∏—Å—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π.
- `ContentLengthError`: –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–ª–∏ –ø—É—Å—Ç—ã.
- `PermissionError`: —Ñ–∞–π–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (–æ—Ç–∫—Ä—ã—Ç –≤ Excel).
- `ValueError`: –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ (–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤).

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –í—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–π—Ç–µ `cycle_right_sheet()` –ø–µ—Ä–µ–¥ —Ä–∞–±–æ—Ç–æ–π —Å –¥–∞–Ω–Ω—ã–º–∏.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `local_idfy` –≤–º–µ—Å—Ç–æ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ `idfy_data`.
- –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `show_local_idfy_dataframe()`.
```

---

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç –∏ –≤—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –≤ —Ñ–∞–π–ª `README.md` –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –í—Å—ë –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–æ, –≤–∞–ª–∏–¥–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.