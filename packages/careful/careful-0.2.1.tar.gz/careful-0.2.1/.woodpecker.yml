when:
  - event: push
  - event: pull_request

matrix:
  PYTHON_VERSION:
    - "3.10"
    - "3.11"
    - "3.12"
    - "3.13"

steps:
  lint:
    image: python:3.11
    commands:
      - curl -LsSf https://astral.sh/uv/install.sh | sh
      - "export PATH=/root/.local/bin:$PATH"
      - uv run ruff check .
      - uv run ruff format --check .
    when:
      - matrix:
        PYTHON_VERSION: 3.13


  test:
    image: "python:${PYTHON_VERSION}"
    commands:
      - curl -LsSf https://astral.sh/uv/install.sh | sh
      - "export PATH=/root/.local/bin:$PATH"
      - uv run --python ${PYTHON_VERSION} pytest
    depends_on:
      - lint
