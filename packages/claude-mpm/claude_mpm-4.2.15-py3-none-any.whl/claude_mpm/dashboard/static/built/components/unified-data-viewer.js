class e{constructor(e="module-data-content"){this.container=document.getElementById(e),this.currentData=null,this.currentType=null}display(e,n=null){if(this.container)switch(this.currentData=e,this.currentType=n,n||(n=this.detectType(e)),this.container.innerHTML="",n){case"event":this.displayEvent(e);break;case"agent":this.displayAgent(e);break;case"tool":this.displayTool(e);break;case"todo":this.displayTodo(e);break;case"instruction":this.displayInstruction(e);break;case"session":this.displaySession(e);break;case"file_operation":if(e.name&&(e.params||e.tool_parameters)){const n=this.convertToolToFileOperation(e);this.displayFileOperation(n)}else this.displayFileOperation(e);break;case"hook":this.displayHook(e);break;default:this.displayGeneric(e)}else console.warn("UnifiedDataViewer: Container not found")}detectType(e){return e&&"object"==typeof e?e.hook_event_name||e.event_type||e.type&&e.timestamp?"event":e.agent_name||e.agentName||e.name&&("active"===e.status||"completed"===e.status)?"agent":e.tool_name||"TodoWrite"===e.name||"Read"===e.name||e.tool_parameters||e.params&&e.icon||e.name&&"tool"===e.type?"tool":!e.todos||e.name||e.params?e.content&&e.activeForm&&e.status&&!e.name&&!e.params?"todo":e.text&&e.preview&&"user_instruction"===e.type?"instruction":e.session_id&&(e.startTime||e.lastActivity)?"session":e.file_path&&(e.operations||e.operation)?"file_operation":"Read"!==e.name&&"Write"!==e.name&&"Edit"!==e.name&&"MultiEdit"!==e.name&&"Grep"!==e.name&&"Glob"!==e.name||!e.params?.file_path&&!e.tool_parameters?.file_path?e.event_type&&(e.hook_name||e.subtype)?"hook":"generic":"file_operation":"todo":"generic"}displayEvent(e){let n=`\n            <div class="unified-viewer-header">\n                <h6>${this.formatEventType(e)}</h6>\n                <span class="unified-viewer-timestamp">${this.formatTimestamp(e.timestamp)}</span>\n            </div>\n            <div class="unified-viewer-content">\n        `;if(n+='<div class="primary-data">',n+=this.formatEventDetails(e),e.tool_name||e.data?.tool_name){const t=e.tool_name||e.data.tool_name;n+=`\n                <div class="detail-row highlight">\n                    <span class="detail-label">Tool:</span>\n                    <span class="detail-value">${this.getToolIcon(t)} ${t}</span>\n                </div>\n            `;const s=e.tool_parameters||e.data?.tool_parameters;s&&(s.file_path&&(n+=`\n                        <div class="detail-row">\n                            <span class="detail-label">File:</span>\n                            <span class="detail-value code">${s.file_path}</span>\n                        </div>\n                    `),s.command&&(n+=`\n                        <div class="detail-row">\n                            <span class="detail-label">Command:</span>\n                            <pre class="code-snippet">${this.escapeHtml(s.command)}</pre>\n                        </div>\n                    `))}n+="</div>",n+=this.createCollapsibleJSON(e,"Full Event Data"),n+="</div>",this.container.innerHTML=n}displayAgent(e){const n=this.getAgentIcon(e.name||e.agentName),t=e.name||e.agentName||"Unknown Agent",s=this.formatStatus(e.status);let a=`\n            <div class="unified-viewer-header">\n                <h6>${n} ${t}</h6>\n                <span class="unified-viewer-status">${s}</span>\n            </div>\n            <div class="unified-viewer-content">\n        `;if(a+='<div class="primary-data">',a+=`\n            <div class="detail-row highlight">\n                <span class="detail-label">Status:</span>\n                <span class="detail-value ${this.formatStatusClass(s)}">${s}</span>\n            </div>\n        `,e.tools&&e.tools.length>0){const n=e.tools.filter(e=>"in_progress"===e.status),t=e.tools.filter(e=>"completed"===e.status);n.length>0&&(a+='\n                    <div class="active-tools-section">\n                        <span class="section-label">ğŸ”„ Active Tools:</span>\n                        <div class="tools-grid">\n                ',n.forEach(e=>{a+=`\n                        <div class="tool-chip active">\n                            ${this.getToolIcon(e.name)} ${e.name}\n                        </div>\n                    `}),a+="</div></div>"),a+=`\n                <div class="detail-row">\n                    <span class="detail-label">Tools Summary:</span>\n                    <span class="detail-value">\n                        ${n.length} active, ${t.length} completed, ${e.tools.length} total\n                    </span>\n                </div>\n            `}(e.currentTask||e.description)&&(a+=`\n                <div class="detail-row">\n                    <span class="detail-label">Current Task:</span>\n                    <span class="detail-value">${e.currentTask||e.description}</span>\n                </div>\n            `),a+="</div>",a+=this.createCollapsibleJSON(e,"Full Agent Details"),a+="</div>",this.container.innerHTML=a}displayTool(e){const n=e.name||e.tool_name||"Unknown Tool",t=this.getToolIcon(n),s=this.formatStatus(e.status);if("TodoWrite"===n)return void this.displayTodoWriteTool(e);let a=`\n            <div class="unified-viewer-header">\n                <h6>${t} ${n}</h6>\n                <span class="unified-viewer-status">${s}</span>\n            </div>\n            <div class="unified-viewer-content">\n        `;const i=e.params||e.tool_parameters||{};"Read"===n||"Edit"===n||"Write"===n?i.file_path&&(a+=`\n                    <div class="primary-data">\n                        <div class="detail-row highlight">\n                            <span class="detail-label">ğŸ“ File:</span>\n                            <span class="detail-value code">${i.file_path}</span>\n                        </div>\n                `,i.old_string&&(a+=`\n                        <div class="detail-row">\n                            <span class="detail-label">Old Text:</span>\n                            <pre class="code-snippet">${this.escapeHtml(i.old_string.substring(0,200))}${i.old_string.length>200?"...":""}</pre>\n                        </div>\n                    `),i.new_string&&(a+=`\n                        <div class="detail-row">\n                            <span class="detail-label">New Text:</span>\n                            <pre class="code-snippet">${this.escapeHtml(i.new_string.substring(0,200))}${i.new_string.length>200?"...":""}</pre>\n                        </div>\n                    `),a+="</div>"):"Bash"===n?i.command&&(a+=`\n                    <div class="primary-data">\n                        <div class="detail-row highlight">\n                            <span class="detail-label">ğŸ’» Command:</span>\n                            <pre class="code-snippet">${this.escapeHtml(i.command)}</pre>\n                        </div>\n                    </div>\n                `):"Grep"===n||"Glob"===n?i.pattern&&(a+=`\n                    <div class="primary-data">\n                        <div class="detail-row highlight">\n                            <span class="detail-label">ğŸ” Pattern:</span>\n                            <span class="detail-value code">${this.escapeHtml(i.pattern)}</span>\n                        </div>\n                `,i.path&&(a+=`\n                        <div class="detail-row">\n                            <span class="detail-label">Path:</span>\n                            <span class="detail-value">${i.path}</span>\n                        </div>\n                    `),a+="</div>"):"Task"===n&&i.subagent_type&&(a+=`\n                    <div class="primary-data">\n                        <div class="detail-row highlight">\n                            <span class="detail-label">ğŸ¤– Delegating to:</span>\n                            <span class="detail-value">${i.subagent_type} agent</span>\n                        </div>\n                `,i.description&&(a+=`\n                        <div class="detail-row">\n                            <span class="detail-label">Task:</span>\n                            <span class="detail-value">${i.description}</span>\n                        </div>\n                    `),a+="</div>"),a+=`\n            <div class="detail-row">\n                <span class="detail-label">Status:</span>\n                <span class="detail-value">${s}</span>\n            </div>\n        `,e.callCount&&(a+=`\n                <div class="detail-row">\n                    <span class="detail-label">Call Count:</span>\n                    <span class="detail-value">${e.callCount}</span>\n                </div>\n            `),a+=this.createCollapsibleJSON(e,"Full Tool Details"),a+="</div>",this.container.innerHTML=a}displayTodoWriteTool(e){const n=this.formatStatus(e.status),t=(e.params||e.tool_parameters||{}).todos||[];let s=`\n            <div class="unified-viewer-header">\n                <h6>ğŸ“ TodoWrite</h6>\n                <span class="unified-viewer-status">${n}</span>\n            </div>\n            <div class="unified-viewer-content">\n        `;if(t.length>0){const e=this.getTodoStatusCounts(t);s+=`\n                <div class="todo-status-line">\n                    <span class="status-inline">âœ… ${e.completed} Done</span>\n                    <span class="status-inline">ğŸ”„ ${e.in_progress} Active</span>\n                    <span class="status-inline">â³ ${e.pending} Pending</span>\n                </div>\n            `,s+='\n                <div class="todo-list-primary">\n            ',t.forEach((e,n)=>{const t=this.getCheckboxIcon(e.status),a="in_progress"===e.status&&e.activeForm||e.content,i=this.formatStatusClass(e.status);s+=`\n                    <div class="todo-item ${e.status}">\n                        <span class="todo-icon ${i}">${t}</span>\n                        <span class="todo-text">${this.escapeHtml(a)}</span>\n                        ${"in_progress"===e.status?'<span class="todo-badge active">ACTIVE</span>':""}\n                    </div>\n                `}),s+="\n                </div>\n            "}else s+='\n                <div class="detail-row">\n                    <span class="detail-value">No todos in list</span>\n                </div>\n            ';e.callCount&&e.callCount>1&&(s+=`\n                <div class="detail-row">\n                    <span class="detail-label">Updates:</span>\n                    <span class="detail-value">${e.callCount}</span>\n                </div>\n            `),s+=this.createCollapsibleJSON(e,"Full Details"),s+="</div>",this.container.innerHTML=s}displayTodo(e){let n;n=e.todos&&Array.isArray(e.todos)?e.todos:Array.isArray(e)?e:e.content&&e.activeForm&&e.status?[e]:[];let t='\n            <div class="unified-viewer-header">\n                <h6>ğŸ“‹ Todo List</h6>\n            </div>\n            <div class="unified-viewer-content">\n        ';n.length>0?(t+='\n                <div class="todo-list-primary">\n            ',n.forEach(e=>{const n=this.getCheckboxIcon(e.status),s="in_progress"===e.status&&e.activeForm||e.content,a=this.formatStatusClass(e.status);t+=`\n                    <div class="todo-item ${e.status}">\n                        <span class="todo-icon ${a}">${n}</span>\n                        <span class="todo-text">${this.escapeHtml(s)}</span>\n                        <span class="todo-status-text ${a}">${e.status.replace("_"," ")}</span>\n                    </div>\n                `}),t+="\n                </div>\n            "):t+='\n                <div class="detail-section">\n                    <div class="no-todos">No todo items found</div>\n                </div>\n            ',t+="</div>",this.container.innerHTML=t}displayInstruction(e){let n=`\n            <div class="unified-viewer-header">\n                <h6>ğŸ’¬ User Instruction</h6>\n                <span class="unified-viewer-timestamp">${this.formatTimestamp(e.timestamp)}</span>\n            </div>\n            <div class="unified-viewer-content">\n        `;n+=`\n            <div class="primary-data">\n                <div class="instruction-content">\n                    ${this.escapeHtml(e.text)}\n                </div>\n                <div class="instruction-meta">\n                    <span class="meta-item">ğŸ“ ${e.text.length} characters</span>\n                    <span class="meta-item">ğŸ• ${this.formatTimestamp(e.timestamp)}</span>\n                </div>\n            </div>\n        `,Object.keys(e).length>3&&(n+=this.createCollapsibleJSON(e,"Full Instruction Data")),n+="</div>",this.container.innerHTML=n}displaySession(e){let n=`\n            <div class="unified-viewer-header">\n                <h6>ğŸ¯ Session: ${e.session_id||e.id}</h6>\n                <span class="unified-viewer-status">${this.formatStatus(e.status||"active")}</span>\n            </div>\n            <div class="unified-viewer-content">\n                <div class="detail-row">\n                    <span class="detail-label">Session ID:</span>\n                    <span class="detail-value">${e.session_id||e.id}</span>\n                </div>\n                <div class="detail-row">\n                    <span class="detail-label">Start Time:</span>\n                    <span class="detail-value">${this.formatTimestamp(e.startTime||e.timestamp)}</span>\n                </div>\n        `;e.working_directory&&(n+=`\n                <div class="detail-row">\n                    <span class="detail-label">Working Directory:</span>\n                    <span class="detail-value">${e.working_directory}</span>\n                </div>\n            `),e.git_branch&&(n+=`\n                <div class="detail-row">\n                    <span class="detail-label">Git Branch:</span>\n                    <span class="detail-value">${e.git_branch}</span>\n                </div>\n            `),void 0!==e.eventCount&&(n+=`\n                <div class="detail-row">\n                    <span class="detail-label">Events:</span>\n                    <span class="detail-value">${e.eventCount}</span>\n                </div>\n            `),n+="</div>",this.container.innerHTML=n}displayFileOperation(e){const n=e.file_path?e.file_path.split("/").pop():"Unknown File",t=this.isSingleFileOperation(e),s=this.getFileIcon(e.file_path),a=this.getFileType(e.file_path);let i=`\n            <div class="unified-viewer-header ${t?"single-file-header":""}">\n                <h6>${s} File: ${n}</h6>\n                <span class="unified-viewer-count">${e.operations?e.operations.length:1} operation${e.operations&&1!==e.operations.length?"s":""}</span>\n                ${a?`<span class="file-type-badge">${a}</span>`:""}\n            </div>\n            <div class="unified-viewer-content">\n                <div class="primary-data">\n                    <div class="detail-row highlight">\n                        <span class="detail-label">ğŸ“ File Path:</span>\n                        <span class="detail-value code clickable-file-path" \n                              onclick="window.showFileViewerModal && window.showFileViewerModal('${e.file_path}')"\n                              title="Click to view file contents\\nKeyboard: Hover + V key or Ctrl/Cmd + Click\\nFile: ${e.file_path}"\n                              tabindex="0"\n                              role="button"\n                              aria-label="Open file ${e.file_path} in viewer"\n                              onkeypress="if(event.key==='Enter'||event.key===' '){window.showFileViewerModal && window.showFileViewerModal('${e.file_path}')}">${e.file_path}</span>\n                    </div>\n        `;if(e.file_path){const n=this.shouldShowInlinePreview(e);if(i+=`\n                <div class="file-actions ${t?"single-file-actions":""}">\n                    <button class="file-action-btn view-file-btn ${t?"primary-action":""}" \n                            onclick="window.showFileViewerModal && window.showFileViewerModal('${e.file_path}')"\n                            title="View file contents with syntax highlighting">\n                        ${s} View File Contents\n                    </button>\n                    ${t&&this.isTextFile(e.file_path)?`\n                        <button class="file-action-btn inline-preview-btn" \n                                onclick="window.unifiedDataViewer && window.unifiedDataViewer.toggleInlinePreview('${e.file_path}', this)"\n                                title="Toggle inline preview">\n                            ğŸ“– Quick Preview\n                        </button>\n                    `:""}\n                </div>\n            `,t&&n){i+=`\n                    <div class="inline-preview-container" id="preview-${this.generatePreviewId(e.file_path)}" style="display: none;">\n                        <div class="inline-preview-loading">Loading preview...</div>\n                    </div>\n                `}}i+="</div>",e.operations&&Array.isArray(e.operations)&&(i+=`\n                <div class="detail-section">\n                    <span class="detail-section-title">Operations (${e.operations.length}):</span>\n                    <div class="operations-list">\n                        ${e.operations.map((e,n)=>`\n                            <div class="operation-item">\n                                <div class="operation-header">\n                                    <span class="operation-type">${this.getOperationIcon(e.operation)} ${e.operation}</span>\n                                    <span class="operation-timestamp">${this.formatTimestamp(e.timestamp)}</span>\n                                </div>\n                                <div class="operation-details">\n                                    <span class="operation-agent">by ${e.agent||"Unknown"}</span>\n                                    ${e.workingDirectory?`<span class="operation-dir">in ${e.workingDirectory}</span>`:""}\n                                </div>\n                            </div>\n                        `).join("")}\n                    </div>\n                </div>\n            `),i+=this.createCollapsibleJSON(e,"Full File Data"),i+="</div>",this.container.innerHTML=i}displayHook(e){let n=`\n            <div class="unified-viewer-header">\n                <h6>ğŸ”— Hook: ${e.event_type||e.subtype||"unknown"}</h6>\n                <span class="unified-viewer-timestamp">${this.formatTimestamp(e.timestamp)}</span>\n            </div>\n            <div class="unified-viewer-content">\n        `;n+=this.formatHookDetails(e),n+="</div>",this.container.innerHTML=n}displayGeneric(e){let n=`\n            <div class="unified-viewer-header">\n                <h6>ğŸ“Š Data Details</h6>\n                ${e.timestamp?`<span class="unified-viewer-timestamp">${this.formatTimestamp(e.timestamp)}</span>`:""}\n            </div>\n            <div class="unified-viewer-content">\n        `;if("object"==typeof e&&null!==e){const t=["id","name","type","status","timestamp","text","content","message"];for(let s of t)if(void 0!==e[s]){let t=e[s];"string"==typeof t&&t.length>200&&(t=t.substring(0,200)+"..."),n+=`\n                        <div class="detail-row">\n                            <span class="detail-label">${s}:</span>\n                            <span class="detail-value">${this.escapeHtml(String(t))}</span>\n                        </div>\n                    `}}else n+=`<div class="simple-value">${this.escapeHtml(String(e))}</div>`;n+="</div>",this.container.innerHTML=n}formatEventType(e){return e.type&&e.subtype?e.type===e.subtype||"generic"===e.subtype?e.type:`${e.type}.${e.subtype}`:e.type?e.type:e.hook_event_name?e.hook_event_name:"unknown"}formatEventDetails(e){switch(e.data,e.type){case"hook":return this.formatHookDetails(e);case"agent":return this.formatAgentEventDetails(e);case"todo":return this.formatTodoEventDetails(e);case"session":return this.formatSessionEventDetails(e);default:return this.formatGenericEventDetails(e)}}formatHookDetails(e){const n=e.data||{},t=e.subtype||e.event_type||"unknown";let s=`\n            <div class="detail-row">\n                <span class="detail-label">Hook Type:</span>\n                <span class="detail-value">${t}</span>\n            </div>\n        `;switch(t){case"user_prompt":const e=n.prompt_text||n.prompt_preview||"";s+=`\n                    <div class="detail-row">\n                        <span class="detail-label">Prompt:</span>\n                        <div class="detail-value prompt-text">${this.escapeHtml(e)}</div>\n                    </div>\n                `;break;case"pre_tool":case"post_tool":s+=`\n                    <div class="detail-row">\n                        <span class="detail-label">Tool:</span>\n                        <span class="detail-value">${n.tool_name||"Unknown tool"}</span>\n                    </div>\n                `,n.operation_type&&(s+=`\n                        <div class="detail-row">\n                            <span class="detail-label">Operation:</span>\n                            <span class="detail-value">${n.operation_type}</span>\n                        </div>\n                    `),"post_tool"===t&&n.duration_ms&&(s+=`\n                        <div class="detail-row">\n                            <span class="detail-label">Duration:</span>\n                            <span class="detail-value">${n.duration_ms}ms</span>\n                        </div>\n                    `);break;case"subagent_start":case"subagent_stop":s+=`\n                    <div class="detail-row">\n                        <span class="detail-label">Agent:</span>\n                        <span class="detail-value">${n.agent_type||n.agent||"Unknown"}</span>\n                    </div>\n                `,"subagent_start"===t&&n.prompt&&(s+=`\n                        <div class="detail-row">\n                            <span class="detail-label">Task:</span>\n                            <div class="detail-value">${this.escapeHtml(n.prompt)}</div>\n                        </div>\n                    `),"subagent_stop"===t&&n.reason&&(s+=`\n                        <div class="detail-row">\n                            <span class="detail-label">Reason:</span>\n                            <span class="detail-value">${n.reason}</span>\n                        </div>\n                    `)}return s}formatAgentEventDetails(e){const n=e.data||{};let t="";return(n.agent_type||n.name)&&(t+=`\n                <div class="detail-row">\n                    <span class="detail-label">Agent Type:</span>\n                    <span class="detail-value">${n.agent_type||n.name}</span>\n                </div>\n            `),e.subtype&&(t+=`\n                <div class="detail-row">\n                    <span class="detail-label">Action:</span>\n                    <span class="detail-value">${e.subtype}</span>\n                </div>\n            `),t}formatTodoEventDetails(e){const n=e.data||{};let t="";if(n.todos&&Array.isArray(n.todos)){const e=this.getTodoStatusCounts(n.todos);t+=`\n                <div class="detail-row">\n                    <span class="detail-label">Todo Items:</span>\n                    <span class="detail-value">${n.todos.length} total</span>\n                </div>\n                <div class="detail-row">\n                    <span class="detail-label">Status:</span>\n                    <span class="detail-value">${e.completed} completed, ${e.in_progress} in progress</span>\n                </div>\n            `}return t}formatSessionEventDetails(e){const n=e.data||{};let t="";return n.session_id&&(t+=`\n                <div class="detail-row">\n                    <span class="detail-label">Session ID:</span>\n                    <span class="detail-value">${n.session_id}</span>\n                </div>\n            `),e.subtype&&(t+=`\n                <div class="detail-row">\n                    <span class="detail-label">Action:</span>\n                    <span class="detail-value">${e.subtype}</span>\n                </div>\n            `),t}formatGenericEventDetails(e){const n=e.data||{};let t="";const s=["message","description","value","result"];for(let a of s)if(void 0!==n[a]){let e=n[a];"string"==typeof e&&e.length>200&&(e=e.substring(0,200)+"..."),t+=`\n                    <div class="detail-row">\n                        <span class="detail-label">${a}:</span>\n                        <span class="detail-value">${this.escapeHtml(String(e))}</span>\n                    </div>\n                `}return t}formatEventData(e){const n=e.data;return n&&0!==Object.keys(n).length?`\n            <div class="detail-section">\n                <span class="detail-section-title">Event Data:</span>\n                <pre class="event-data-json">${this.escapeHtml(JSON.stringify(n,null,2))}</pre>\n            </div>\n        `:""}formatParameters(e,n="Parameters"){if(!e||0===Object.keys(e).length)return`\n                <div class="detail-section">\n                    <span class="detail-section-title">${n}:</span>\n                    <div class="no-params">No parameters</div>\n                </div>\n            `;const t=Object.keys(e);return`\n            <div class="detail-section">\n                <span class="detail-section-title">${n} (${t.length}):</span>\n                <div class="params-list">\n                    ${t.map(n=>{const t=e[n];return`\n                            <div class="param-item">\n                                <div class="param-key">${n}:</div>\n                                <div class="param-value">${this.formatParameterValue(t)}</div>\n                            </div>\n                        `}).join("")}\n                </div>\n            </div>\n        `}formatParameterValue(e){if("string"==typeof e)return e.length>500?`<pre class="param-text-long">${this.escapeHtml(e.substring(0,500)+"...\n\n[Content truncated - "+e.length+" total characters]")}</pre>`:e.length>100?`<pre class="param-text">${this.escapeHtml(e)}</pre>`:`<span class="param-text-short">${this.escapeHtml(e)}</span>`;if("object"!=typeof e||null===e)return`<span class="param-primitive">${this.escapeHtml(String(e))}</span>`;if(Array.isArray(e)&&e.length>0&&e[0].hasOwnProperty("content")&&e[0].hasOwnProperty("status"))return this.formatTodosAsParameter(e);try{return`<pre class="param-json">${this.escapeHtml(JSON.stringify(e,null,2))}</pre>`}catch(n){return'<span class="param-error">Error displaying object</span>'}}formatTodosAsParameter(e){const n=this.getTodoStatusCounts(e);let t=`\n            <div class="param-todos">\n                <div class="param-todos-header">\n                    Array of todo objects (${e.length} items)\n                </div>\n                <div class="param-todos-summary">\n                    ${n.completed} completed â€¢ ${n.in_progress} in progress â€¢ ${n.pending} pending\n                </div>\n                <div class="param-todos-list">\n        `;return e.forEach((e,n)=>{const s=this.getCheckboxIcon(e.status),a="in_progress"===e.status&&e.activeForm||e.content,i=this.formatStatusClass(e.status);t+=`\n                <div class="param-todo-item ${e.status}">\n                    <div class="param-todo-checkbox">\n                        <span class="param-checkbox-icon ${i}">${s}</span>\n                    </div>\n                    <div class="param-todo-text">\n                        <span class="param-todo-content">${this.escapeHtml(a)}</span>\n                        <span class="param-todo-status-badge ${i}">${e.status.replace("_"," ")}</span>\n                    </div>\n                </div>\n            `}),t+="\n                </div>\n            </div>\n        ",t}isSingleFileOperation(e){return!e.operations||1===e.operations.length}getFileIcon(e){if(!e)return"ğŸ“„";const n=e.split(".").pop()?.toLowerCase();return{js:"ğŸŸ¨",jsx:"âš›ï¸",ts:"ğŸ”·",tsx:"âš›ï¸",py:"ğŸ",java:"â˜•",cpp:"âš¡",c:"âš¡",cs:"#ï¸âƒ£",php:"ğŸ˜",rb:"ğŸ’",go:"ğŸ¹",rs:"ğŸ¦€",swift:"ğŸ¦‰",kt:"ğŸ…º",scala:"ğŸ¯",html:"ğŸŒ",htm:"ğŸŒ",css:"ğŸ¨",scss:"ğŸ¨",sass:"ğŸ¨",less:"ğŸ¨",vue:"ğŸ’š",json:"ğŸ“‹",xml:"ğŸ“„",yaml:"âš™ï¸",yml:"âš™ï¸",toml:"âš™ï¸",ini:"âš™ï¸",conf:"âš™ï¸",config:"âš™ï¸",md:"ğŸ“",txt:"ğŸ“ƒ",rtf:"ğŸ“ƒ",pdf:"ğŸ“•",doc:"ğŸ“˜",docx:"ğŸ“˜",jpg:"ğŸ–¼ï¸",jpeg:"ğŸ–¼ï¸",png:"ğŸ–¼ï¸",gif:"ğŸ–¼ï¸",svg:"ğŸ¨",webp:"ğŸ–¼ï¸",ico:"ğŸ–¼ï¸",zip:"ğŸ—œï¸",tar:"ğŸ—œï¸",gz:"ğŸ—œï¸",rar:"ğŸ—œï¸","7z":"ğŸ—œï¸",sql:"ğŸ—ƒï¸",db:"ğŸ—ƒï¸",log:"ğŸ“Š",env:"ğŸ”",lock:"ğŸ”’"}[n]||"ğŸ“„"}getFileType(e){if(!e)return null;const n=e.split(".").pop()?.toLowerCase();return{js:"JavaScript",jsx:"React JSX",ts:"TypeScript",tsx:"React TSX",py:"Python",java:"Java",cpp:"C++",c:"C",cs:"C#",php:"PHP",rb:"Ruby",go:"Go",rs:"Rust",html:"HTML",css:"CSS",scss:"SCSS",json:"JSON",xml:"XML",yaml:"YAML",yml:"YAML",md:"Markdown",txt:"Text",sql:"SQL",log:"Log File"}[n]||null}shouldShowInlinePreview(e){return this.isSingleFileOperation(e)&&this.isTextFile(e.file_path)}isTextFile(e){if(!e)return!1;const n=e.split(".").pop()?.toLowerCase();return["txt","md","json","xml","yaml","yml","ini","conf","config","js","jsx","ts","tsx","py","java","cpp","c","cs","php","rb","go","rs","swift","kt","scala","html","htm","css","scss","sass","less","vue","sql","log","env","gitignore","dockerignore"].includes(n)}async toggleInlinePreview(e,n){const t=`preview-${this.generatePreviewId(e)}`,s=document.getElementById(t);s?"none"===s.style.display?(s.style.display="block",n.innerHTML="ğŸ“– Hide Preview",await this.loadInlinePreview(e,s)):(s.style.display="none",n.innerHTML="ğŸ“– Quick Preview"):console.warn("Preview container not found")}async loadInlinePreview(e,n){try{n.innerHTML=`\n                <div class="inline-preview-header">\n                    <span class="preview-label">Quick Preview:</span>\n                    <span class="preview-file">${e}</span>\n                </div>\n                <div class="inline-preview-content">\n                    <div class="preview-note">\n                        ğŸ’¡ Inline preview feature ready - API integration needed\n                        <br>Click "View File Contents" for full syntax-highlighted view\n                    </div>\n                </div>\n            `}catch(t){n.innerHTML=`\n                <div class="inline-preview-error">\n                    âŒ Could not load preview: ${t.message}\n                </div>\n            `}}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2,9)}generatePreviewId(e){return btoa(e).replace(/[^a-zA-Z0-9]/g,"")}formatTimestamp(e){if(!e)return"Unknown time";try{const n=new Date(e);return isNaN(n.getTime())?"Invalid date":n.toLocaleString()}catch(n){return"Invalid date"}}formatStatus(e){if(!e)return"unknown";return{active:"ğŸŸ¢ Active",completed:"âœ… Completed",in_progress:"ğŸ”„ In Progress",pending:"â³ Pending",error:"âŒ Error",failed:"âŒ Failed"}[e]||e}formatStatusClass(e){return`status-${e}`}getAgentIcon(e){return{PM:"ğŸ¯",Engineer:"ğŸ”§","Engineer Agent":"ğŸ”§",Research:"ğŸ”","Research Agent":"ğŸ”",QA:"âœ…","QA Agent":"âœ…",Architect:"ğŸ—ï¸","Architect Agent":"ğŸ—ï¸",Ops:"âš™ï¸","Ops Agent":"âš™ï¸"}[e]||"ğŸ¤–"}getToolIcon(e){return{Read:"ğŸ‘ï¸",Write:"âœï¸",Edit:"âœï¸",MultiEdit:"ğŸ“",Bash:"ğŸ’»",Grep:"ğŸ”",Glob:"ğŸ“‚",LS:"ğŸ“",TodoWrite:"ğŸ“",Task:"ğŸ“‹",WebFetch:"ğŸŒ"}[e]||"ğŸ”§"}getCheckboxIcon(e){return{pending:"â³",in_progress:"ğŸ”„",completed:"âœ…"}[e]||"â“"}getOperationIcon(e){return{read:"ğŸ‘ï¸",write:"âœï¸",edit:"âœï¸",delete:"ğŸ—‘ï¸",create:"ğŸ“",search:"ğŸ”",list:"ğŸ“‚",copy:"ğŸ“‹",move:"ğŸ“¦",bash:"ğŸ’»"}[e.toLowerCase()]||"ğŸ“„"}convertToolToFileOperation(e){const n=e.params||e.tool_parameters||{},t=n.file_path||n.path||n.notebook_path;if(!t)return e;const s={operation:e.name.toLowerCase(),timestamp:e.timestamp||(new Date).toISOString(),agent:"Activity Tool",sessionId:e.sessionId||"unknown",details:{parameters:n,tool_name:e.name,status:e.status||"completed"}};return{file_path:t,operations:[s],lastOperation:s.timestamp,originalTool:e}}getTodoStatusCounts(e){const n={completed:0,in_progress:0,pending:0};return e.forEach(e=>{n.hasOwnProperty(e.status)&&n[e.status]++}),n}escapeHtml(e){if("string"!=typeof e)return"";const n=document.createElement("div");return n.textContent=e,n.innerHTML}createCollapsibleJSON(e,n="Full Details"){const t=`json-details-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,s=this.cleanDataForDisplay(e);return`\n            <div class="collapsible-json-section">\n                <button class="collapsible-json-toggle" onclick="\n                    const content = document.getElementById('${t}');\n                    const button = this;\n                    if (content.style.display === 'none' || content.style.display === '') {\n                        content.style.display = 'block';\n                        button.classList.add('expanded');\n                        button.innerHTML = 'â–¼ ${n}';\n                    } else {\n                        content.style.display = 'none';\n                        button.classList.remove('expanded');\n                        button.innerHTML = 'â–¶ ${n}';\n                    }\n                ">â–¶ ${n}</button>\n                <div id="${t}" class="collapsible-json-content" style="display: none;">\n                    <pre class="json-viewer">${this.escapeHtml(JSON.stringify(s,null,2))}</pre>\n                </div>\n            </div>\n        `}cleanDataForDisplay(e){const n=new WeakSet;return JSON.parse(JSON.stringify(e,(e,t)=>{if("object"==typeof t&&null!==t){if(n.has(t))return"[Circular Reference]";n.add(t)}return"string"==typeof t&&t.length>1e3?t.substring(0,1e3)+"... [truncated]":"function"==typeof t?"[Function]":t}))}clear(){this.container&&(this.container.innerHTML=""),this.currentData=null,this.currentType=null}getCurrentData(){return this.currentData}getCurrentType(){return this.currentType}hasData(){return null!==this.currentData}}window.UnifiedDataViewer=e,"undefined"!=typeof window&&window.addEventListener("DOMContentLoaded",function(){window.unifiedDataViewer||(window.unifiedDataViewer=new e),document.addEventListener("keydown",function(e){if((e.ctrlKey||e.metaKey)&&e.target.classList.contains("clickable-file-path")){e.preventDefault();const n=e.target.textContent.trim();window.showFileViewerModal&&window.showFileViewerModal(n)}if("v"===e.key.toLowerCase()&&document.querySelector(".clickable-file-path:hover")){const n=document.querySelector(".clickable-file-path:hover");if(n&&window.showFileViewerModal){e.preventDefault();const t=n.textContent.trim();window.showFileViewerModal(t)}}})});export{e as U};
//# sourceMappingURL=unified-data-viewer.js.map
