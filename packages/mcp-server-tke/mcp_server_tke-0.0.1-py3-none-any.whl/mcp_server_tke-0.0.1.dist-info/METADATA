Metadata-Version: 2.4
Name: mcp-server-tke
Version: 0.0.1
Summary: MCP Server for Tencent Cloud TKE
Requires-Python: >=3.10
Requires-Dist: mcp>=1.0.0
Requires-Dist: tencentcloud-sdk-python-common==3.0.1356
Requires-Dist: tencentcloud-sdk-python-tke==3.0.1356
Description-Content-Type: text/markdown

# TKE MCP Server

è…¾è®¯äº‘å®¹å™¨æœåŠ¡(TKE) Model Context Protocol (MCP) æœåŠ¡å™¨ï¼Œæä¾›æ ‡å‡†åŒ–çš„TKEé›†ç¾¤ç®¡ç†æ¥å£ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- è…¾è®¯äº‘è´¦å·å’ŒAPIå¯†é’¥

### å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd tke-mcp

# å®‰è£…ä¾èµ–ï¼ˆå¯é€‰ï¼‰
pip install tencentcloud-sdk-python  # ç”Ÿäº§ç¯å¢ƒ
pip install model-context-protocol   # MCPæ”¯æŒ
```

### é…ç½®

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export TENCENTCLOUD_SECRET_ID="your_secret_id"
export TENCENTCLOUD_SECRET_KEY="your_secret_key"
```

### å¯åŠ¨æœåŠ¡

```bash
# ç›´æ¥è¿è¡Œ
python3 -m mcp_server_tke

# æˆ–ä½¿ç”¨å¯åŠ¨è„šæœ¬
python3 src/mcp_server_tke/server.py
```

## ğŸ›  åŠŸèƒ½ç‰¹æ€§

### æ”¯æŒçš„å·¥å…·

| å·¥å…·åç§° | åŠŸèƒ½æè¿° | çŠ¶æ€ |
|---------|----------|------|
| `create_cluster` | åˆ›å»ºTKEé›†ç¾¤ | âœ… |
| `delete_cluster` | åˆ é™¤TKEé›†ç¾¤ | âœ… |

### æ ¸å¿ƒç‰¹æ€§

- ğŸ”Œ **MCPåè®®å…¼å®¹**: ç¬¦åˆModel Context Protocolæ ‡å‡†
- ğŸ›¡ï¸ **å‚æ•°éªŒè¯**: å®Œæ•´çš„è¾“å…¥å‚æ•°éªŒè¯å’Œé”™è¯¯å¤„ç†
- ğŸ”„ **æ¨¡æ‹Ÿæ¨¡å¼**: æ”¯æŒæ— SDKç¯å¢ƒä¸‹çš„å¼€å‘å’Œæµ‹è¯•
- ğŸ“Š **æ—¥å¿—è®°å½•**: è¯¦ç»†çš„æ“ä½œæ—¥å¿—å’Œé”™è¯¯è¿½è¸ª
- ğŸ§ª **æµ‹è¯•è¦†ç›–**: å®Œæ•´çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

## ğŸ“– ä½¿ç”¨è¯´æ˜

### åˆ›å»ºé›†ç¾¤

```python
from mcp_server_tke.tool_tke import create_cluster

params = {
    "Region": "ap-guangzhou",
    "ClusterBasicSettings.ClusterName": "my-cluster",
    "ClusterBasicSettings.ClusterOs": "ubuntu18.04.1x86_64",
    "ClusterBasicSettings.VpcId": "vpc-12345678",
    "ClusterCIDRSettings.EniSubnetIds": ["subnet-12345678"],
    "ClusterCIDRSettings.ServiceCIDR": "10.96.0.0/12"
}

result = create_cluster(params)
print(result)
```

### åˆ é™¤é›†ç¾¤

```python
from mcp_server_tke.tool_tke import delete_cluster

params = {
    "ClusterId": "cls-12345678"
}

result = delete_cluster(params)
print(result)
```

### MCPå·¥å…·è°ƒç”¨

```json
{
  "method": "tools/call",
  "params": {
    "name": "create_cluster",
    "arguments": {
      "Region": "ap-guangzhou",
      "ClusterBasicSettings.ClusterName": "test-cluster",
      "ClusterBasicSettings.ClusterOs": "ubuntu18.04.1x86_64",
      "ClusterBasicSettings.VpcId": "vpc-example",
      "ClusterCIDRSettings.EniSubnetIds": ["subnet-example"],
      "ClusterCIDRSettings.ServiceCIDR": "10.96.0.0/12"
    }
  }
}
```

## ğŸ— é¡¹ç›®ç»“æ„

```
tke-mcp/
â”œâ”€â”€ src/mcp_server_tke/          # æºä»£ç 
â”‚   â”œâ”€â”€ __init__.py              # æ¨¡å—åˆå§‹åŒ–
â”‚   â”œâ”€â”€ server.py                # MCPæœåŠ¡å™¨å®ç°
â”‚   â”œâ”€â”€ client.py                # è…¾è®¯äº‘å®¢æˆ·ç«¯
â”‚   â””â”€â”€ tool_tke.py              # TKEå·¥å…·é€»è¾‘
â”œâ”€â”€ tests/                       # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ test_client.py           # å®¢æˆ·ç«¯æµ‹è¯•
â”‚   â”œâ”€â”€ test_tool_tke.py         # å·¥å…·æµ‹è¯•
â”‚   â”œâ”€â”€ test_mcp_integration.py  # MCPé›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ test_e2e.py              # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â””â”€â”€ test_architecture_consistency.py  # æ¶æ„ä¸€è‡´æ€§æµ‹è¯•
â”œâ”€â”€ examples/                    # ä½¿ç”¨ç¤ºä¾‹
â”‚   â””â”€â”€ usage_examples.py        # å®Œæ•´ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ scripts/                     # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ verify_server.py         # æœåŠ¡å™¨éªŒè¯
â”‚   â””â”€â”€ optimize_code.py         # ä»£ç ä¼˜åŒ–
â”œâ”€â”€ docs/                        # æ–‡æ¡£
â”‚   â””â”€â”€ USAGE.md                 # ä½¿ç”¨æŒ‡å—
â””â”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# å•å…ƒæµ‹è¯•
python3 tests/test_tool_tke.py
python3 tests/test_client.py

# é›†æˆæµ‹è¯•
python3 tests/test_mcp_integration.py

# ç«¯åˆ°ç«¯æµ‹è¯•
python3 tests/test_e2e.py

# æ¶æ„ä¸€è‡´æ€§éªŒè¯
python3 tests/test_architecture_consistency.py
```

### éªŒè¯æœåŠ¡å™¨

```bash
# å®Œæ•´éªŒè¯
python3 scripts/verify_server.py

# è¿è¡Œç¤ºä¾‹
python3 examples/usage_examples.py
```

### æµ‹è¯•è¦†ç›–ç‡

- å•å…ƒæµ‹è¯•: 15/15 é€šè¿‡ âœ…
- é›†æˆæµ‹è¯•: 9/9 (è·³è¿‡ï¼Œéœ€è¦MCPåº“) â¸ï¸
- ç«¯åˆ°ç«¯æµ‹è¯•: 6/6 é€šè¿‡ âœ…
- æ¶æ„éªŒè¯: 3/3 é€šè¿‡ âœ…

## ğŸ“‹ APIå‚è€ƒ

### create_cluster

**æè¿°**: åˆ›å»ºTKEé›†ç¾¤

**å‚æ•°**:
- `Region` (string, å¿…å¡«): åœ°åŸŸæ ‡è¯†
- `ClusterBasicSettings.ClusterName` (string, å¯é€‰): é›†ç¾¤åç§°
- `ClusterBasicSettings.ClusterLevel` (string, å¯é€‰): é›†ç¾¤è§„æ ¼ï¼Œé»˜è®¤L50
- `ClusterBasicSettings.ClusterOs` (string, å¿…å¡«): æ“ä½œç³»ç»Ÿé•œåƒID
- `ClusterBasicSettings.VpcId` (string, å¿…å¡«): VPC ID
- `ClusterCIDRSettings.EniSubnetIds` (array, å¿…å¡«): å­ç½‘IDåˆ—è¡¨
- `ClusterCIDRSettings.ServiceCIDR` (string, å¿…å¡«): Serviceç½‘æ®µ

**è¿”å›**: JSONæ ¼å¼çš„é›†ç¾¤åˆ›å»ºç»“æœ

### delete_cluster

**æè¿°**: åˆ é™¤TKEé›†ç¾¤

**å‚æ•°**:
- `ClusterId` (string, å¿…å¡«): é›†ç¾¤ID

**è¿”å›**: JSONæ ¼å¼çš„åˆ é™¤æ“ä½œç»“æœ

## ğŸš€ éƒ¨ç½²

### Dockeréƒ¨ç½²

```dockerfile
FROM python:3.9-slim
WORKDIR /app
COPY src/ ./src/
RUN pip install tencentcloud-sdk-python
ENV TENCENTCLOUD_SECRET_ID=""
ENV TENCENTCLOUD_SECRET_KEY=""
CMD ["python3", "-m", "mcp_server_tke"]
```

### ç³»ç»ŸæœåŠ¡

```bash
# å®‰è£…ä¸ºç³»ç»ŸæœåŠ¡
sudo cp scripts/tke-mcp-server.service /etc/systemd/system/
sudo systemctl enable tke-mcp-server
sudo systemctl start tke-mcp-server
```

## ğŸ”§ å¼€å‘

### æ¶æ„è®¾è®¡

TKE MCPæœåŠ¡å™¨é‡‡ç”¨ä¸‰å±‚æ¶æ„ï¼š

1. **åè®®å±‚** (`server.py`): MCPåè®®å¤„ç†å’Œå·¥å…·æ³¨å†Œ
2. **ä¸šåŠ¡å±‚** (`tool_tke.py`): TKEä¸šåŠ¡é€»è¾‘å’Œå‚æ•°éªŒè¯
3. **å®¢æˆ·ç«¯å±‚** (`client.py`): è…¾è®¯äº‘SDKå®¢æˆ·ç«¯ç®¡ç†

### ä»£ç è§„èŒƒ

- éµå¾ªPEP 8ç¼–ç è§„èŒƒ
- ä½¿ç”¨ç±»å‹æ³¨è§£
- å®Œæ•´çš„æ–‡æ¡£å­—ç¬¦ä¸²
- 95%+ æµ‹è¯•è¦†ç›–ç‡

### è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. è¿è¡Œæµ‹è¯•
5. åˆ›å»ºPull Request

## ğŸ“Š è´¨é‡æŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ |
|------|--------|--------|
| å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | 100% | >90% |
| æ–‡æ¡£å­—ç¬¦ä¸²è¦†ç›–ç‡ | 92.3% | >80% |
| ä»£ç è¡Œæ•° | 474è¡Œ | <1000è¡Œ |
| åœˆå¤æ‚åº¦ | <10 | <10 |

## ğŸ›  æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: ModuleNotFoundError: No module named 'tencentcloud'**
A: å®‰è£…è…¾è®¯äº‘SDKï¼š`pip install tencentcloud-sdk-python`

**Q: ModuleNotFoundError: No module named 'mcp'**
A: æœåŠ¡å™¨å°†åœ¨æ¨¡æ‹Ÿæ¨¡å¼ä¸‹è¿è¡Œï¼Œç”Ÿäº§ç¯å¢ƒéœ€è¦å®‰è£…MCPåº“

**Q: å‚æ•°éªŒè¯å¤±è´¥**
A: æ£€æŸ¥å¿…å¡«å‚æ•°æ˜¯å¦å®Œæ•´ï¼Œå‚æ•°æ ¼å¼æ˜¯å¦æ­£ç¡®

### æ—¥å¿—è°ƒè¯•

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

## ğŸ“š ç›¸å…³èµ„æº

- [è…¾è®¯äº‘TKE APIæ–‡æ¡£](https://cloud.tencent.com/document/product/457)
- [Model Context Protocolè§„èŒƒ](https://spec.modelcontextprotocol.io/)
- [è…¾è®¯äº‘Python SDK](https://github.com/TencentCloud/tencentcloud-sdk-python)

## ğŸ“„ è®¸å¯è¯

[MIT License](LICENSE)

## ğŸ¤ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š

1. æŸ¥çœ‹[ä½¿ç”¨æ–‡æ¡£](docs/USAGE.md)
2. è¿è¡ŒéªŒè¯è„šæœ¬è¯Šæ–­é—®é¢˜
3. æäº¤Issueæè¿°é—®é¢˜
4. è”ç³»ç»´æŠ¤å›¢é˜Ÿ

---

**ç‰ˆæœ¬**: 0.1.0  
**æœ€åæ›´æ–°**: 2025-09-03  
**ç»´æŠ¤çŠ¶æ€**: ç§¯æç»´æŠ¤ ğŸŸ¢
Implementation of Tencent Cloud CVM (Cloud Virtual Machine) MCP server for managing Tencent Cloud instances and network resources.

## Features
- **Instance Management**: Full lifecycle management including creating, starting, stopping, restarting, and terminating instances
- **Instance Query**: Query instance lists and instance type configurations  
- **Image Management**: Query available image lists
- **Network Management**: Query network resources like VPCs, subnets, and security groups
- **Region Management**: Query available regions and availability zones
- **Monitoring & Diagnostics**: CPU, memory, disk performance metrics monitoring
- **Security Group Management**: Create, configure and manage security group rules
- **Price Inquiry**: Pre-creation instance pricing functionality

## API List

### ğŸ” Basic Query
| Tool Name | Description |
|---|---|
| `DescribeRegions` | Query region list |
| `DescribeZones` | Query availability zone list |
| `DescribeInstances` | Query instance list |
| `DescribeImages` | Query image list |
| `DescribeInstanceTypeConfigs` | Query instance type configurations |
| `DescribeVpcs` | Query VPC list |
| `DescribeSubnets` | Query subnet list |
| `DescribeSecurityGroups` | Query security group list |

### ğŸ–¥ï¸ Instance Lifecycle
| Tool Name | Description |
|---|---|
| `RunInstances` | Create new instances |
| `QuickRunInstance` | Quick create instances (simplified) |
| `StartInstances` | Start instances |
| `StopInstances` | Stop instances |
| `RebootInstances` | Reboot instances |
| `TerminateInstances` | Terminate instances |
| `ResetInstancesPassword` | Reset instance password |
| `ResetInstance` | Reinstall instance OS |

### ğŸ” Security Group Management
| Tool Name | Description |
|---|---|
| `DescribeSecurityGroupPolicies` | Query security group rules |
| `CreateSecurityGroup` | Create new security group |
| `CreateSecurityGroupWithPolicies` | Create security group with rules |
| `CreateSecurityGroupPolicies` | Add rules to existing security group |
| `ReplaceSecurityGroupPolicies` | Replace security group rules |

### ğŸ“Š Monitoring & Diagnostics
| Tool Name | Description |
|---|---|
| `CreateDiagnosticReports` | Create diagnostic reports |
| `DescribeDiagnosticReports` | Query diagnostic reports |
| `GetCpuUsageData` | Get CPU utilization |
| `GetCpuLoadavgData` | Get CPU 1-minute load average |
| `GetCpuloadavg5mData` | Get CPU 5-minute load average |
| `GetCpuloadavg15mData` | Get CPU 15-minute load average |
| `GetMemUsedData` | Get memory usage |
| `GetMemUsageData` | Get memory utilization |
| `GetCvmDiskUsageData` | Get disk utilization |
| `GetDiskTotalData` | Get disk total capacity |
| `GetDiskUsageData` | Get disk usage percentage |

### ğŸ’° Pricing & Recommendations
| Tool Name | Description |
|---|---|
| `InquiryPriceRunInstances` | Inquiry price for creating instances |
| `DescribeRecommendZoneInstanceTypes` | Recommend instance types in zone |

## Configuration
### Set Tencent Cloud Credentials
1. Obtain SecretId and SecretKey from Tencent Cloud Console
2. Set default region (optional)

### Environment Variables
Configure the following environment variables:
- `TENCENTCLOUD_SECRET_ID`: Tencent Cloud SecretId
- `TENCENTCLOUD_SECRET_KEY`: Tencent Cloud SecretKey  

### Usage in Claude Desktop
Add the following configuration to claude_desktop_config.json:

```json
{
  "mcpServers": {
    "tencent-cvm": {
      "command": "uv",
      "args": [
        "run",
        "mcp-server-cvm"
      ],
      "env": {
        "TENCENTCLOUD_SECRET_ID": "YOUR_SECRET_ID_HERE",
        "TENCENTCLOUD_SECRET_KEY": "YOUR_SECRET_KEY_HERE",
      }
    }
  }
}
```

## Installation
```sh
pip install mcp-server-cvm
```

## License
MIT License. See LICENSE file for details.