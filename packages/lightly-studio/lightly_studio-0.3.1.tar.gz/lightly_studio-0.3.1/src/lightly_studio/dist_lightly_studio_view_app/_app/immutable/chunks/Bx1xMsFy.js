var vt=Object.defineProperty;var Ke=e=>{throw TypeError(e)};var gt=(e,t,s)=>t in e?vt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var $e=(e,t,s)=>gt(e,typeof t!="symbol"?t+"":t,s),me=(e,t,s)=>t.has(e)||Ke("Cannot "+s);var n=(e,t,s)=>(me(e,t,"read from private field"),s?s.call(e):t.get(e)),p=(e,t,s)=>t.has(e)?Ke("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),l=(e,t,s,r)=>(me(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s),g=(e,t,s)=>(me(e,t,"access private method"),s);import{az as tt,aA as we,aB as St,z as ve,l as wt}from"./l7KrR96u.js";const Ct={bodySerializer:e=>JSON.stringify(e,(t,s)=>typeof s=="bigint"?s.toString():s)},Ot=async(e,t)=>{const s=typeof t=="function"?await t(e):t;if(s)return e.scheme==="bearer"?`Bearer ${s}`:e.scheme==="basic"?`Basic ${btoa(s)}`:s},Rt=e=>{switch(e){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}},jt=e=>{switch(e){case"form":return",";case"pipeDelimited":return"|";case"spaceDelimited":return"%20";default:return","}},At=e=>{switch(e){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}},st=({allowReserved:e,explode:t,name:s,style:r,value:a})=>{if(!t){const i=(e?a:a.map(h=>encodeURIComponent(h))).join(jt(r));switch(r){case"label":return`.${i}`;case"matrix":return`;${s}=${i}`;case"simple":return i;default:return`${s}=${i}`}}const u=Rt(r),o=a.map(i=>r==="label"||r==="simple"?e?i:encodeURIComponent(i):pe({allowReserved:e,name:s,value:i})).join(u);return r==="label"||r==="matrix"?u+o:o},pe=({allowReserved:e,name:t,value:s})=>{if(s==null)return"";if(typeof s=="object")throw new Error("Deeply-nested arrays/objects arenâ€™t supported. Provide your own `querySerializer()` to handle these.");return`${t}=${e?s:encodeURIComponent(s)}`},rt=({allowReserved:e,explode:t,name:s,style:r,value:a,valueOnly:u})=>{if(a instanceof Date)return u?a.toISOString():`${s}=${a.toISOString()}`;if(r!=="deepObject"&&!t){let h=[];Object.entries(a).forEach(([d,c])=>{h=[...h,d,e?c:encodeURIComponent(c)]});const m=h.join(",");switch(r){case"form":return`${s}=${m}`;case"label":return`.${m}`;case"matrix":return`;${s}=${m}`;default:return m}}const o=At(r),i=Object.entries(a).map(([h,m])=>pe({allowReserved:e,name:r==="deepObject"?`${s}[${h}]`:h,value:m})).join(o);return r==="label"||r==="matrix"?o+i:i},Et=/\{[^{}]+\}/g,Ft=({path:e,url:t})=>{let s=t;const r=t.match(Et);if(r)for(const a of r){let u=!1,o=a.substring(1,a.length-1),i="simple";o.endsWith("*")&&(u=!0,o=o.substring(0,o.length-1)),o.startsWith(".")?(o=o.substring(1),i="label"):o.startsWith(";")&&(o=o.substring(1),i="matrix");const h=e[o];if(h==null)continue;if(Array.isArray(h)){s=s.replace(a,st({explode:u,name:o,style:i,value:h}));continue}if(typeof h=="object"){s=s.replace(a,rt({explode:u,name:o,style:i,value:h,valueOnly:!0}));continue}if(i==="matrix"){s=s.replace(a,`;${pe({name:o,value:h})}`);continue}const m=encodeURIComponent(i==="label"?`.${h}`:h);s=s.replace(a,m)}return s},nt=({allowReserved:e,array:t,object:s}={})=>a=>{const u=[];if(a&&typeof a=="object")for(const o in a){const i=a[o];if(i!=null)if(Array.isArray(i)){const h=st({allowReserved:e,explode:!0,name:o,style:"form",value:i,...t});h&&u.push(h)}else if(typeof i=="object"){const h=rt({allowReserved:e,explode:!0,name:o,style:"deepObject",value:i,...s});h&&u.push(h)}else{const h=pe({allowReserved:e,name:o,value:i});h&&u.push(h)}}return u.join("&")},Tt=e=>{var s;if(!e)return"stream";const t=(s=e.split(";")[0])==null?void 0:s.trim();if(t){if(t.startsWith("application/json")||t.endsWith("+json"))return"json";if(t==="multipart/form-data")return"formData";if(["application/","audio/","image/","video/"].some(r=>t.startsWith(r)))return"blob";if(t.startsWith("text/"))return"text"}},It=async({security:e,...t})=>{for(const s of e){const r=await Ot(s,t.auth);if(!r)continue;const a=s.name??"Authorization";switch(s.in){case"query":t.query||(t.query={}),t.query[a]=r;break;case"cookie":t.headers.append("Cookie",`${a}=${r}`);break;case"header":default:t.headers.set(a,r);break}return}},He=e=>Ut({baseUrl:e.baseUrl,path:e.path,query:e.query,querySerializer:typeof e.querySerializer=="function"?e.querySerializer:nt(e.querySerializer),url:e.url}),Ut=({baseUrl:e,path:t,query:s,querySerializer:r,url:a})=>{const u=a.startsWith("/")?a:`/${a}`;let o=(e??"")+u;t&&(o=Ft({path:t,url:o}));let i=s?r(s):"";return i.startsWith("?")&&(i=i.substring(1)),i&&(o+=`?${i}`),o},Be=(e,t)=>{var r;const s={...e,...t};return(r=s.baseUrl)!=null&&r.endsWith("/")&&(s.baseUrl=s.baseUrl.substring(0,s.baseUrl.length-1)),s.headers=it(e.headers,t.headers),s},it=(...e)=>{const t=new Headers;for(const s of e){if(!s||typeof s!="object")continue;const r=s instanceof Headers?s.entries():Object.entries(s);for(const[a,u]of r)if(u===null)t.delete(a);else if(Array.isArray(u))for(const o of u)t.append(a,o);else u!==void 0&&t.set(a,typeof u=="object"?JSON.stringify(u):u)}return t};class ge{constructor(){$e(this,"_fns");this._fns=[]}clear(){this._fns=[]}getInterceptorIndex(t){return typeof t=="number"?this._fns[t]?t:-1:this._fns.indexOf(t)}exists(t){const s=this.getInterceptorIndex(t);return!!this._fns[s]}eject(t){const s=this.getInterceptorIndex(t);this._fns[s]&&(this._fns[s]=null)}update(t,s){const r=this.getInterceptorIndex(t);return this._fns[r]?(this._fns[r]=s,t):!1}use(t){return this._fns=[...this._fns,t],this._fns.length-1}}const qt=()=>({error:new ge,request:new ge,response:new ge}),xt=nt({allowReserved:!1,array:{explode:!0,style:"form"},object:{explode:!0,style:"deepObject"}}),Dt={"Content-Type":"application/json"},at=(e={})=>({...Ct,headers:Dt,parseAs:"auto",querySerializer:xt,...e}),_t=(e={})=>{let t=Be(at(),e);const s=()=>({...t}),r=o=>(t=Be(t,o),s()),a=qt(),u=async o=>{const i={...t,...o,fetch:o.fetch??t.fetch??globalThis.fetch,headers:it(t.headers,o.headers)};i.security&&await It({...i,security:i.security}),i.requestValidator&&await i.requestValidator(i),i.body&&i.bodySerializer&&(i.body=i.bodySerializer(i.body)),(i.body===void 0||i.body==="")&&i.headers.delete("Content-Type");const h=He(i),m={redirect:"follow",...i};let d=new Request(h,m);for(const C of a.request._fns)C&&(d=await C(d,i));const c=i.fetch;let f=await c(d);for(const C of a.response._fns)C&&(f=await C(f,d,i));const w={request:d,response:f};if(f.ok){if(f.status===204||f.headers.get("Content-Length")==="0")return i.responseStyle==="data"?{}:{data:{},...w};const C=(i.parseAs==="auto"?Tt(f.headers.get("Content-Type")):i.parseAs)??"json";let F;switch(C){case"arrayBuffer":case"blob":case"formData":case"json":case"text":F=await f[C]();break;case"stream":return i.responseStyle==="data"?f.body:{data:f.body,...w}}return C==="json"&&(i.responseValidator&&await i.responseValidator(F),i.responseTransformer&&(F=await i.responseTransformer(F))),i.responseStyle==="data"?F:{data:F,...w}}const j=await f.text();let v;try{v=JSON.parse(j)}catch{}const S=v??j;let O=S;for(const C of a.error._fns)C&&(O=await C(S,f,d,i));if(O=O||{},i.throwOnError)throw O;return i.responseStyle==="data"?void 0:{error:O,...w}};return{buildUrl:He,connect:o=>u({...o,method:"CONNECT"}),delete:o=>u({...o,method:"DELETE"}),get:o=>u({...o,method:"GET"}),getConfig:s,head:o=>u({...o,method:"HEAD"}),interceptors:a,options:o=>u({...o,method:"OPTIONS"}),patch:o=>u({...o,method:"PATCH"}),post:o=>u({...o,method:"POST"}),put:o=>u({...o,method:"PUT"}),request:u,setConfig:r,trace:o=>u({...o,method:"TRACE"})}},Pt=e=>(e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e),ot=e=>(e.tags&&(e.tags=e.tags.map(t=>Pt(t))),e),Qt=e=>(e.data=e.data.map(t=>ot(t)),e),Mt=async e=>(e=Qt(e),e),Lt=async e=>(e=ot(e),e),zt=e=>(e.created_at&&(e.created_at=new Date(e.created_at)),e),kt=async e=>(e=e.map(t=>zt(t)),e),Kt=e=>(e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e),$t=async e=>(e=Kt(e),e),x=_t(at()),Es=e=>(e.client??x).post({responseTransformer:Mt,url:"/api/datasets/{dataset_id}/samples/list",...e,headers:{"Content-Type":"application/json",...e.headers}}),Ht=e=>(e.client??x).get({responseTransformer:Lt,url:"/api/datasets/{dataset_id}/samples/{sample_id}",...e}),Bt=e=>((e==null?void 0:e.client)??x).get({url:"/api/annotation_labels",...e}),Vt=e=>(e.client??x).get({url:"/api/datasets/{dataset_id}/annotations/count",...e,headers:{"Content-Type":"application/json",...e.headers}}),Nt=e=>(e.client??x).get({url:"/api/datasets/{dataset_id}/annotations",...e}),Wt=e=>(e.client??x).put({responseTransformer:kt,url:"/api/datasets/{dataset_id}/annotations",...e,headers:{"Content-Type":"application/json",...e.headers}}),Gt=e=>(e.client??x).get({url:"/api/datasets/{dataset_id}/annotations/{annotation_id}",...e}),Fs=e=>((e==null?void 0:e.client)??x).get({responseTransformer:$t,url:"/api/settings",...e}),Ts=e=>(e.client??x).get({url:"/api/classifiers/{classifier_id}/sample_history",...e}),Jt=e=>(e.client??x).get({url:"/api/datasets/{dataset_id}/metadata/info",...e});var Qe=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ie=typeof window>"u"||"Deno"in globalThis;function Ce(){}function Is(e,t){return typeof e=="function"?e(t):e}function Oe(e){return typeof e=="number"&&e>=0&&e!==1/0}function ut(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ye(e,t){return typeof e=="function"?e(t):e}function q(e,t){return typeof e=="function"?e(t):e}function Us(e,t){const{type:s="all",exact:r,fetchStatus:a,predicate:u,queryKey:o,stale:i}=e;if(o){if(r){if(t.queryHash!==Xt(o,t.options))return!1}else if(!Me(t.queryKey,o))return!1}if(s!=="all"){const h=t.isActive();if(s==="active"&&!h||s==="inactive"&&h)return!1}return!(typeof i=="boolean"&&t.isStale()!==i||a&&a!==t.state.fetchStatus||u&&!u(t))}function qs(e,t){const{exact:s,status:r,predicate:a,mutationKey:u}=e;if(u){if(!t.options.mutationKey)return!1;if(s){if(Re(t.options.mutationKey)!==Re(u))return!1}else if(!Me(t.options.mutationKey,u))return!1}return!(r&&t.state.status!==r||a&&!a(t))}function Xt(e,t){return((t==null?void 0:t.queryKeyHashFn)||Re)(e)}function Re(e){return JSON.stringify(e,(t,s)=>Ae(s)?Object.keys(s).sort().reduce((r,a)=>(r[a]=s[a],r),{}):s)}function Me(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(s=>!Me(e[s],t[s])):!1}function ct(e,t){if(e===t)return e;const s=Ve(e)&&Ve(t);if(s||Ae(e)&&Ae(t)){const r=s?e:Object.keys(e),a=r.length,u=s?t:Object.keys(t),o=u.length,i=s?[]:{};let h=0;for(let m=0;m<o;m++){const d=s?m:u[m];(!s&&r.includes(d)||s)&&e[d]===void 0&&t[d]===void 0?(i[d]=void 0,h++):(i[d]=ct(e[d],t[d]),i[d]===e[d]&&e[d]!==void 0&&h++)}return a===o&&h===a?e:i}return t}function je(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function Ve(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Ae(e){if(!Ne(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!Ne(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Ne(e){return Object.prototype.toString.call(e)==="[object Object]"}function Yt(e){return new Promise(t=>{setTimeout(t,e)})}function Ee(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?ct(e,t):t}function xs(e,t,s=0){const r=[...e,t];return s&&r.length>s?r.slice(1):r}function Ds(e,t,s=0){const r=[t,...e];return s&&r.length>s?r.slice(0,-1):r}var ht=Symbol();function Zt(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ht?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var k,Q,J,Je,es=(Je=class extends Qe{constructor(){super();p(this,k);p(this,Q);p(this,J);l(this,J,t=>{if(!ie&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){n(this,Q)||this.setEventListener(n(this,J))}onUnsubscribe(){var t;this.hasListeners()||((t=n(this,Q))==null||t.call(this),l(this,Q,void 0))}setEventListener(t){var s;l(this,J,t),(s=n(this,Q))==null||s.call(this),l(this,Q,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){n(this,k)!==t&&(l(this,k,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof n(this,k)=="boolean"?n(this,k):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},k=new WeakMap,Q=new WeakMap,J=new WeakMap,Je),lt=new es,X,M,Y,Xe,ts=(Xe=class extends Qe{constructor(){super();p(this,X,!0);p(this,M);p(this,Y);l(this,Y,t=>{if(!ie&&window.addEventListener){const s=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}}})}onSubscribe(){n(this,M)||this.setEventListener(n(this,Y))}onUnsubscribe(){var t;this.hasListeners()||((t=n(this,M))==null||t.call(this),l(this,M,void 0))}setEventListener(t){var s;l(this,Y,t),(s=n(this,M))==null||s.call(this),l(this,M,t(this.setOnline.bind(this)))}setOnline(t){n(this,X)!==t&&(l(this,X,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return n(this,X)}},X=new WeakMap,M=new WeakMap,Y=new WeakMap,Xe),dt=new ts;function Fe(){let e,t;const s=new Promise((a,u)=>{e=a,t=u});s.status="pending",s.catch(()=>{});function r(a){Object.assign(s,a),delete s.resolve,delete s.reject}return s.resolve=a=>{r({status:"fulfilled",value:a}),e(a)},s.reject=a=>{r({status:"rejected",reason:a}),t(a)},s}function ss(e){return Math.min(1e3*2**e,3e4)}function ft(e){return(e??"online")==="online"?dt.isOnline():!0}var yt=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Se(e){return e instanceof yt}function rs(e){let t=!1,s=0,r=!1,a;const u=Fe(),o=v=>{var S;r||(f(new yt(v)),(S=e.abort)==null||S.call(e))},i=()=>{t=!0},h=()=>{t=!1},m=()=>lt.isFocused()&&(e.networkMode==="always"||dt.isOnline())&&e.canRun(),d=()=>ft(e.networkMode)&&e.canRun(),c=v=>{var S;r||(r=!0,(S=e.onSuccess)==null||S.call(e,v),a==null||a(),u.resolve(v))},f=v=>{var S;r||(r=!0,(S=e.onError)==null||S.call(e,v),a==null||a(),u.reject(v))},w=()=>new Promise(v=>{var S;a=O=>{(r||m())&&v(O)},(S=e.onPause)==null||S.call(e)}).then(()=>{var v;a=void 0,r||(v=e.onContinue)==null||v.call(e)}),j=()=>{if(r)return;let v;const S=s===0?e.initialPromise:void 0;try{v=S??e.fn()}catch(O){v=Promise.reject(O)}Promise.resolve(v).then(c).catch(O=>{var be;if(r)return;const C=e.retry??(ie?0:3),F=e.retryDelay??ss,le=typeof F=="function"?F(s,O):F,de=C===!0||typeof C=="number"&&s<C||typeof C=="function"&&C(s,O);if(t||!de){f(O);return}s++,(be=e.onFail)==null||be.call(e,s,O),Yt(le).then(()=>m()?void 0:w()).then(()=>{t?f(O):j()})})};return{promise:u,cancel:o,continue:()=>(a==null||a(),u),cancelRetry:i,continueRetry:h,canStart:d,start:()=>(d()?j():w().then(j),u)}}function ns(){let e=[],t=0,s=i=>{i()},r=i=>{i()},a=i=>setTimeout(i,0);const u=i=>{t?e.push(i):a(()=>{s(i)})},o=()=>{const i=e;e=[],i.length&&a(()=>{r(()=>{i.forEach(h=>{s(h)})})})};return{batch:i=>{let h;t++;try{h=i()}finally{t--,t||o()}return h},batchCalls:i=>(...h)=>{u(()=>{i(...h)})},schedule:u,setNotifyFunction:i=>{s=i},setBatchNotifyFunction:i=>{r=i},setScheduler:i=>{a=i}}}var Le=ns(),K,Ye,is=(Ye=class{constructor(){p(this,K)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Oe(this.gcTime)&&l(this,K,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ie?1/0:5*60*1e3))}clearGcTimeout(){n(this,K)&&(clearTimeout(n(this,K)),l(this,K,void 0))}},K=new WeakMap,Ye),Z,ee,I,$,R,ue,H,U,P,Ze,_s=(Ze=class extends is{constructor(t){super();p(this,U);p(this,Z);p(this,ee);p(this,I);p(this,$);p(this,R);p(this,ue);p(this,H);l(this,H,!1),l(this,ue,t.defaultOptions),this.setOptions(t.options),this.observers=[],l(this,$,t.client),l(this,I,n(this,$).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,l(this,Z,as(this.options)),this.state=t.state??n(this,Z),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=n(this,R))==null?void 0:t.promise}setOptions(t){this.options={...n(this,ue),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&n(this,I).remove(this)}setData(t,s){const r=Ee(this.state.data,t,this.options);return g(this,U,P).call(this,{data:r,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),r}setState(t,s){g(this,U,P).call(this,{type:"setState",state:t,setStateOptions:s})}cancel(t){var r,a;const s=(r=n(this,R))==null?void 0:r.promise;return(a=n(this,R))==null||a.cancel(t),s?s.then(Ce).catch(Ce):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(n(this,Z))}isActive(){return this.observers.some(t=>q(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ht||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!ut(this.state.dataUpdatedAt,t)}onFocus(){var s;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(s=n(this,R))==null||s.continue()}onOnline(){var s;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(s=n(this,R))==null||s.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),n(this,I).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(s=>s!==t),this.observers.length||(n(this,R)&&(n(this,H)?n(this,R).cancel({revert:!0}):n(this,R).cancelRetry()),this.scheduleGc()),n(this,I).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||g(this,U,P).call(this,{type:"invalidate"})}fetch(t,s){var h,m,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(n(this,R))return n(this,R).continueRetry(),n(this,R).promise}if(t&&this.setOptions(t),!this.options.queryFn){const c=this.observers.find(f=>f.options.queryFn);c&&this.setOptions(c.options)}const r=new AbortController,a=c=>{Object.defineProperty(c,"signal",{enumerable:!0,get:()=>(l(this,H,!0),r.signal)})},u=()=>{const c=Zt(this.options,s),f={client:n(this,$),queryKey:this.queryKey,meta:this.meta};return a(f),l(this,H,!1),this.options.persister?this.options.persister(c,f,this):c(f)},o={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:n(this,$),state:this.state,fetchFn:u};a(o),(h=this.options.behavior)==null||h.onFetch(o,this),l(this,ee,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=o.fetchOptions)==null?void 0:m.meta))&&g(this,U,P).call(this,{type:"fetch",meta:(d=o.fetchOptions)==null?void 0:d.meta});const i=c=>{var f,w,j,v;Se(c)&&c.silent||g(this,U,P).call(this,{type:"error",error:c}),Se(c)||((w=(f=n(this,I).config).onError)==null||w.call(f,c,this),(v=(j=n(this,I).config).onSettled)==null||v.call(j,this.state.data,c,this)),this.scheduleGc()};return l(this,R,rs({initialPromise:s==null?void 0:s.initialPromise,fn:o.fetchFn,abort:r.abort.bind(r),onSuccess:c=>{var f,w,j,v;if(c===void 0){i(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(c)}catch(S){i(S);return}(w=(f=n(this,I).config).onSuccess)==null||w.call(f,c,this),(v=(j=n(this,I).config).onSettled)==null||v.call(j,c,this.state.error,this),this.scheduleGc()},onError:i,onFail:(c,f)=>{g(this,U,P).call(this,{type:"failed",failureCount:c,error:f})},onPause:()=>{g(this,U,P).call(this,{type:"pause"})},onContinue:()=>{g(this,U,P).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),n(this,R).start()}},Z=new WeakMap,ee=new WeakMap,I=new WeakMap,$=new WeakMap,R=new WeakMap,ue=new WeakMap,H=new WeakMap,U=new WeakSet,P=function(t){const s=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...pt(r.data,this.options),fetchMeta:t.meta??null};case"success":return{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return Se(a)&&a.revert&&n(this,ee)?{...n(this,ee),fetchStatus:"idle"}:{...r,error:a,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=s(this.state),Le.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),n(this,I).notify({query:this,type:"updated",action:t})})},Ze);function pt(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ft(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function as(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,s=t!==void 0,r=s?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var T,y,ce,E,B,te,L,_,he,se,re,V,N,z,ne,b,oe,Te,Ie,Ue,qe,xe,De,_e,bt,et,os=(et=class extends Qe{constructor(t,s){super();p(this,b);p(this,T);p(this,y);p(this,ce);p(this,E);p(this,B);p(this,te);p(this,L);p(this,_);p(this,he);p(this,se);p(this,re);p(this,V);p(this,N);p(this,z);p(this,ne,new Set);this.options=s,l(this,T,t),l(this,_,null),l(this,L,Fe()),this.options.experimental_prefetchInRender||n(this,L).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(n(this,y).addObserver(this),We(n(this,y),this.options)?g(this,b,oe).call(this):this.updateResult(),g(this,b,qe).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Pe(n(this,y),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Pe(n(this,y),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,g(this,b,xe).call(this),g(this,b,De).call(this),n(this,y).removeObserver(this)}setOptions(t,s){const r=this.options,a=n(this,y);if(this.options=n(this,T).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof q(this.options.enabled,n(this,y))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");g(this,b,_e).call(this),n(this,y).setOptions(this.options),r._defaulted&&!je(this.options,r)&&n(this,T).getQueryCache().notify({type:"observerOptionsUpdated",query:n(this,y),observer:this});const u=this.hasListeners();u&&Ge(n(this,y),a,this.options,r)&&g(this,b,oe).call(this),this.updateResult(s),u&&(n(this,y)!==a||q(this.options.enabled,n(this,y))!==q(r.enabled,n(this,y))||ye(this.options.staleTime,n(this,y))!==ye(r.staleTime,n(this,y)))&&g(this,b,Te).call(this);const o=g(this,b,Ie).call(this);u&&(n(this,y)!==a||q(this.options.enabled,n(this,y))!==q(r.enabled,n(this,y))||o!==n(this,z))&&g(this,b,Ue).call(this,o)}getOptimisticResult(t){const s=n(this,T).getQueryCache().build(n(this,T),t),r=this.createResult(s,t);return cs(this,r)&&(l(this,E,r),l(this,te,this.options),l(this,B,n(this,y).state)),r}getCurrentResult(){return n(this,E)}trackResult(t,s){const r={};return Object.keys(t).forEach(a=>{Object.defineProperty(r,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),s==null||s(a),t[a])})}),r}trackProp(t){n(this,ne).add(t)}getCurrentQuery(){return n(this,y)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=n(this,T).defaultQueryOptions(t),r=n(this,T).getQueryCache().build(n(this,T),s);return r.fetch().then(()=>this.createResult(r,s))}fetch(t){return g(this,b,oe).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),n(this,E)))}createResult(t,s){var ke;const r=n(this,y),a=this.options,u=n(this,E),o=n(this,B),i=n(this,te),m=t!==r?t.state:n(this,ce),{state:d}=t;let c={...d},f=!1,w;if(s._optimisticResults){const A=this.hasListeners(),W=!A&&We(t,s),G=A&&Ge(t,r,s,a);(W||G)&&(c={...c,...pt(d.data,t.options)}),s._optimisticResults==="isRestoring"&&(c.fetchStatus="idle")}let{error:j,errorUpdatedAt:v,status:S}=c;if(s.select&&c.data!==void 0)if(u&&c.data===(o==null?void 0:o.data)&&s.select===n(this,he))w=n(this,se);else try{l(this,he,s.select),w=s.select(c.data),w=Ee(u==null?void 0:u.data,w,s),l(this,se,w),l(this,_,null)}catch(A){l(this,_,A)}else w=c.data;if(s.placeholderData!==void 0&&w===void 0&&S==="pending"){let A;if(u!=null&&u.isPlaceholderData&&s.placeholderData===(i==null?void 0:i.placeholderData))A=u.data;else if(A=typeof s.placeholderData=="function"?s.placeholderData((ke=n(this,re))==null?void 0:ke.state.data,n(this,re)):s.placeholderData,s.select&&A!==void 0)try{A=s.select(A),l(this,_,null)}catch(W){l(this,_,W)}A!==void 0&&(S="success",w=Ee(u==null?void 0:u.data,A,s),f=!0)}n(this,_)&&(j=n(this,_),w=n(this,se),v=Date.now(),S="error");const O=c.fetchStatus==="fetching",C=S==="pending",F=S==="error",le=C&&O,de=w!==void 0,D={status:S,fetchStatus:c.fetchStatus,isPending:C,isSuccess:S==="success",isError:F,isInitialLoading:le,isLoading:le,data:w,dataUpdatedAt:c.dataUpdatedAt,error:j,errorUpdatedAt:v,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>m.dataUpdateCount||c.errorUpdateCount>m.errorUpdateCount,isFetching:O,isRefetching:O&&!C,isLoadingError:F&&!de,isPaused:c.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:F&&de,isStale:ze(t,s),refetch:this.refetch,promise:n(this,L)};if(this.options.experimental_prefetchInRender){const A=fe=>{D.status==="error"?fe.reject(D.error):D.data!==void 0&&fe.resolve(D.data)},W=()=>{const fe=l(this,L,D.promise=Fe());A(fe)},G=n(this,L);switch(G.status){case"pending":t.queryHash===r.queryHash&&A(G);break;case"fulfilled":(D.status==="error"||D.data!==G.value)&&W();break;case"rejected":(D.status!=="error"||D.error!==G.reason)&&W();break}}return D}updateResult(t){const s=n(this,E),r=this.createResult(n(this,y),this.options);if(l(this,B,n(this,y).state),l(this,te,this.options),n(this,B).data!==void 0&&l(this,re,n(this,y)),je(r,s))return;l(this,E,r);const a={},u=()=>{if(!s)return!0;const{notifyOnChangeProps:o}=this.options,i=typeof o=="function"?o():o;if(i==="all"||!i&&!n(this,ne).size)return!0;const h=new Set(i??n(this,ne));return this.options.throwOnError&&h.add("error"),Object.keys(n(this,E)).some(m=>{const d=m;return n(this,E)[d]!==s[d]&&h.has(d)})};(t==null?void 0:t.listeners)!==!1&&u()&&(a.listeners=!0),g(this,b,bt).call(this,{...a,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&g(this,b,qe).call(this)}},T=new WeakMap,y=new WeakMap,ce=new WeakMap,E=new WeakMap,B=new WeakMap,te=new WeakMap,L=new WeakMap,_=new WeakMap,he=new WeakMap,se=new WeakMap,re=new WeakMap,V=new WeakMap,N=new WeakMap,z=new WeakMap,ne=new WeakMap,b=new WeakSet,oe=function(t){g(this,b,_e).call(this);let s=n(this,y).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(Ce)),s},Te=function(){g(this,b,xe).call(this);const t=ye(this.options.staleTime,n(this,y));if(ie||n(this,E).isStale||!Oe(t))return;const r=ut(n(this,E).dataUpdatedAt,t)+1;l(this,V,setTimeout(()=>{n(this,E).isStale||this.updateResult()},r))},Ie=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(n(this,y)):this.options.refetchInterval)??!1},Ue=function(t){g(this,b,De).call(this),l(this,z,t),!(ie||q(this.options.enabled,n(this,y))===!1||!Oe(n(this,z))||n(this,z)===0)&&l(this,N,setInterval(()=>{(this.options.refetchIntervalInBackground||lt.isFocused())&&g(this,b,oe).call(this)},n(this,z)))},qe=function(){g(this,b,Te).call(this),g(this,b,Ue).call(this,g(this,b,Ie).call(this))},xe=function(){n(this,V)&&(clearTimeout(n(this,V)),l(this,V,void 0))},De=function(){n(this,N)&&(clearInterval(n(this,N)),l(this,N,void 0))},_e=function(){const t=n(this,T).getQueryCache().build(n(this,T),this.options);if(t===n(this,y))return;const s=n(this,y);l(this,y,t),l(this,ce,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},bt=function(t){Le.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(n(this,E))}),n(this,T).getQueryCache().notify({query:n(this,y),type:"observerResultsUpdated"})})},et);function us(e,t){return q(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function We(e,t){return us(e,t)||e.state.data!==void 0&&Pe(e,t,t.refetchOnMount)}function Pe(e,t,s){if(q(t.enabled,e)!==!1){const r=typeof s=="function"?s(e):s;return r==="always"||r!==!1&&ze(e,t)}return!1}function Ge(e,t,s,r){return(e!==t||q(r.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&ze(e,s)}function ze(e,t){return q(t.enabled,e)!==!1&&e.isStaleByTime(ye(t.staleTime,e))}function cs(e,t){return!je(e.getCurrentResult(),t)}const mt="$$_queryClient",hs=()=>{const e=tt(mt);if(!e)throw new Error("No QueryClient was found in Svelte context. Did you forget to wrap your component with QueryClientProvider?");return e},Ps=e=>{St(mt,e)},ls="$$_isRestoring",ds=()=>{try{const e=tt(ls);return e||we(!1)}catch{return we(!1)}};function fs(){return ds()}function ys(e){return hs()}function ps(e){return"subscribe"in e&&typeof e.subscribe=="function"}function bs(){}function ms(e,t,s){const r=ys(),a=fs(),u=ps(e)?e:we(e),o=ve([u,a],([d,c])=>{const f=r.defaultQueryOptions(d);return f._optimisticResults=c?"isRestoring":"optimistic",f}),i=new t(r,wt(o));o.subscribe(d=>{i.setOptions(d,{listeners:!1})});const h=ve(a,(d,c)=>{const f=d?bs:i.subscribe(Le.batchCalls(c));return i.updateResult(),f}),{subscribe:m}=ve([h,o],([d,c])=>(d=i.getOptimisticResult(c),c.notifyOnChangeProps?d:i.trackResult(d)));return{subscribe:m}}function Qs(e,t){return ms(e,os)}const ae=(e,t,s)=>{const r={_id:e,baseUrl:(t==null?void 0:t.baseUrl)||((t==null?void 0:t.client)??x).getConfig().baseUrl};return s&&(r._infinite=s),t!=null&&t.body&&(r.body=t.body),t!=null&&t.headers&&(r.headers=t.headers),t!=null&&t.path&&(r.path=t.path),t!=null&&t.query&&(r.query=t.query),[r]},vs=(e,t)=>{const s={...e[0]};return t.body&&(s.body={...e[0].body,...t.body}),t.headers&&(s.headers={...e[0].headers,...t.headers}),t.path&&(s.path={...e[0].path,...t.path}),t.query&&(s.query={...e[0].query,...t.query}),s},gs=e=>ae("readSample",e),Ms=e=>({queryFn:async({queryKey:t,signal:s})=>{const{data:r}=await Ht({...e,...t[0],signal:s,throwOnError:!0});return r},queryKey:gs(e)}),Ss=e=>ae("readAnnotationLabels",e),Ls=e=>({queryFn:async({queryKey:t,signal:s})=>{const{data:r}=await Bt({...e,...t[0],signal:s,throwOnError:!0});return r},queryKey:Ss(e)}),ws=e=>ae("countAnnotationsByDataset",e),zs=e=>({queryFn:async({queryKey:t,signal:s})=>{const{data:r}=await Vt({...e,...t[0],signal:s,throwOnError:!0});return r},queryKey:ws(e)}),Cs=e=>ae("readAnnotations",e,!0),ks=e=>({queryFn:async({pageParam:t,queryKey:s,signal:r})=>{const u=vs(s,typeof t=="object"?t:{query:{cursor:t}}),{data:o}=await Nt({...e,...u,signal:r,throwOnError:!0});return o},queryKey:Cs(e)}),Ks=e=>({mutationFn:async s=>{const{data:r}=await Wt({...e,...s,throwOnError:!0});return r}}),Os=e=>ae("getAnnotation",e),$s=e=>({queryFn:async({queryKey:t,signal:s})=>{const{data:r}=await Gt({...e,...t[0],signal:s,throwOnError:!0});return r},queryKey:Os(e)}),Rs=e=>ae("getMetadataInfo",e),Hs=e=>({queryFn:async({queryKey:t,signal:s})=>{const{data:r}=await Jt({...e,...t[0],signal:s,throwOnError:!0});return r},queryKey:Rs(e)});export{ms as A,ps as B,bs as C,Ks as D,ks as E,Ls as F,Ts as G,$s as H,_s as Q,is as R,Qe as S,zs as a,Ms as b,Qs as c,qs as d,Ce as e,lt as f,Hs as g,Xt as h,ye as i,Is as j,Re as k,Ps as l,Us as m,Le as n,dt as o,Me as p,Fs as q,Es as r,ht as s,rs as t,ys as u,Zt as v,Ds as w,xs as x,os as y,je as z};
